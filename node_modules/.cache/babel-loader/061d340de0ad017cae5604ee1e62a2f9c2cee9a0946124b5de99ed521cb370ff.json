{"ast":null,"code":"import { openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, withModifiers as _withModifiers, normalizeClass as _normalizeClass } from \"vue\";\nconst _hoisted_1 = [\"aria-expanded\"];\nconst _hoisted_2 = {\n  class: \"user-avatar\"\n};\nconst _hoisted_3 = [\"src\", \"alt\"];\nconst _hoisted_4 = {\n  key: 1,\n  class: \"fas fa-user-circle avatar-icon\",\n  \"aria-hidden\": \"true\"\n};\nconst _hoisted_5 = {\n  class: \"user-info\"\n};\nconst _hoisted_6 = {\n  class: \"user-name\"\n};\nconst _hoisted_7 = {\n  key: 0,\n  class: \"user-dropdown-menu\",\n  role: \"menu\",\n  \"aria-label\": \"User account options\"\n};\nconst _hoisted_8 = [\"aria-disabled\", \"title\"];\nconst _hoisted_9 = {\n  key: 0,\n  class: \"fas fa-lock disabled-icon\",\n  \"aria-hidden\": \"true\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", {\n    class: _normalizeClass([\"user-profile\", {\n      active: $props.isOpen\n    }])\n  }, [_createElementVNode(\"button\", {\n    class: \"user-btn\",\n    onClick: _cache[0] || (_cache[0] = (...args) => $options.handleToggle && $options.handleToggle(...args)),\n    \"aria-label\": \"User account menu\",\n    \"aria-expanded\": $props.isOpen\n  }, [_createElementVNode(\"div\", _hoisted_2, [$props.userData.userAvatar ? (_openBlock(), _createElementBlock(\"img\", {\n    key: 0,\n    src: $props.userData.userAvatar,\n    alt: $options.getFullName(),\n    class: \"avatar-image\",\n    loading: \"lazy\"\n  }, null, 8 /* PROPS */, _hoisted_3)) : (_openBlock(), _createElementBlock(\"i\", _hoisted_4))]), _createElementVNode(\"div\", _hoisted_5, [_createElementVNode(\"span\", _hoisted_6, _toDisplayString($options.getFullName()), 1 /* TEXT */), _cache[3] || (_cache[3] = _createElementVNode(\"span\", {\n    class: \"user-role\"\n  }, \"Client Portal\", -1 /* HOISTED */))]), _cache[4] || (_cache[4] = _createElementVNode(\"i\", {\n    class: \"fas fa-chevron-down dropdown-arrow\",\n    \"aria-hidden\": \"true\"\n  }, null, -1 /* HOISTED */))], 8 /* PROPS */, _hoisted_1), $props.isOpen ? (_openBlock(), _createElementBlock(\"div\", _hoisted_7, [_createElementVNode(\"a\", {\n    href: \"#\",\n    class: _normalizeClass([\"dropdown-item\", {\n      'disabled': !$props.canRequestDocuments\n    }]),\n    onClick: _cache[1] || (_cache[1] = _withModifiers($event => $props.canRequestDocuments ? $options.handleMenuAction('requests') : null, [\"prevent\"])),\n    role: \"menuitem\",\n    \"aria-disabled\": !$props.canRequestDocuments,\n    title: $props.canRequestDocuments ? 'View your document requests' : 'Residency verification required to request documents'\n  }, [_cache[5] || (_cache[5] = _createElementVNode(\"i\", {\n    class: \"fas fa-clock\",\n    \"aria-hidden\": \"true\"\n  }, null, -1 /* HOISTED */)), _cache[6] || (_cache[6] = _createElementVNode(\"span\", null, \"My Requests\", -1 /* HOISTED */)), !$props.canRequestDocuments ? (_openBlock(), _createElementBlock(\"i\", _hoisted_9)) : _createCommentVNode(\"v-if\", true)], 10 /* CLASS, PROPS */, _hoisted_8), _cache[8] || (_cache[8] = _createElementVNode(\"div\", {\n    class: \"dropdown-divider\"\n  }, null, -1 /* HOISTED */)), _createElementVNode(\"a\", {\n    href: \"#\",\n    class: \"dropdown-item logout-item\",\n    onClick: _cache[2] || (_cache[2] = _withModifiers((...args) => $options.handleLogout && $options.handleLogout(...args), [\"prevent\"])),\n    role: \"menuitem\"\n  }, _cache[7] || (_cache[7] = [_createElementVNode(\"i\", {\n    class: \"fas fa-sign-out-alt\",\n    \"aria-hidden\": \"true\"\n  }, null, -1 /* HOISTED */), _createElementVNode(\"span\", null, \"Sign Out\", -1 /* HOISTED */)]))])) : _createCommentVNode(\"v-if\", true)], 2 /* CLASS */);\n}","map":{"version":3,"names":["class","role","_createElementBlock","_normalizeClass","active","$props","isOpen","_createElementVNode","onClick","_cache","args","$options","handleToggle","_hoisted_2","userData","userAvatar","src","alt","getFullName","loading","_hoisted_4","_hoisted_5","_hoisted_6","_toDisplayString","_hoisted_7","href","canRequestDocuments","_withModifiers","$event","handleMenuAction","title","_hoisted_9","handleLogout"],"sources":["D:\\brgy_docu_hub\\BOSFDR\\src\\components\\client\\components\\UserProfileDropdown.vue"],"sourcesContent":["<template>\n  <div class=\"user-profile\" :class=\"{ active: isOpen }\">\n    <button\n      class=\"user-btn\"\n      @click=\"handleToggle\"\n      aria-label=\"User account menu\"\n      :aria-expanded=\"isOpen\"\n    >\n      <div class=\"user-avatar\">\n        <img\n          v-if=\"userData.userAvatar\"\n          :src=\"userData.userAvatar\"\n          :alt=\"getFullName()\"\n          class=\"avatar-image\"\n          loading=\"lazy\"\n        />\n        <i v-else class=\"fas fa-user-circle avatar-icon\" aria-hidden=\"true\"></i>\n      </div>\n      <div class=\"user-info\">\n        <span class=\"user-name\">{{ getFullName() }}</span>\n        <span class=\"user-role\">Client Portal</span>\n      </div>\n      <i class=\"fas fa-chevron-down dropdown-arrow\" aria-hidden=\"true\"></i>\n    </button>\n\n    <div \n      v-if=\"isOpen\" \n      class=\"user-dropdown-menu\" \n      role=\"menu\" \n      aria-label=\"User account options\"\n    >\n      <a\n        href=\"#\"\n        class=\"dropdown-item\"\n        :class=\"{ 'disabled': !canRequestDocuments }\"\n        @click.prevent=\"canRequestDocuments ? handleMenuAction('requests') : null\"\n        role=\"menuitem\"\n        :aria-disabled=\"!canRequestDocuments\"\n        :title=\"canRequestDocuments ? 'View your document requests' : 'Residency verification required to request documents'\"\n      >\n        <i class=\"fas fa-clock\" aria-hidden=\"true\"></i>\n        <span>My Requests</span>\n        <i v-if=\"!canRequestDocuments\" class=\"fas fa-lock disabled-icon\" aria-hidden=\"true\"></i>\n      </a>\n\n      <div class=\"dropdown-divider\"></div>\n\n      <a\n        href=\"#\"\n        class=\"dropdown-item logout-item\"\n        @click.prevent=\"handleLogout\"\n        role=\"menuitem\"\n      >\n        <i class=\"fas fa-sign-out-alt\" aria-hidden=\"true\"></i>\n        <span>Sign Out</span>\n      </a>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'UserProfileDropdown',\n  props: {\n    userData: {\n      type: Object,\n      default: () => ({\n        userName: 'User',\n        userEmail: 'user@example.com',\n        userAvatar: null\n      })\n    },\n    isOpen: {\n      type: Boolean,\n      default: false\n    },\n    canRequestDocuments: {\n      type: Boolean,\n      default: true\n    }\n  },\n  emits: ['toggle', 'menu-action', 'logout'],\n\n  mounted() {\n    console.log('=== UserProfileDropdown MOUNTED ===');\n    console.log('userData prop received:', this.userData);\n    console.log('userData keys:', Object.keys(this.userData || {}));\n    console.log('userData.profile:', this.userData?.profile);\n    console.log('Initial full name:', this.getFullName());\n  },\n\n  methods: {\n    handleToggle() {\n      this.$emit('toggle')\n    },\n\n    handleMenuAction(action) {\n      this.$emit('menu-action', action)\n    },\n\n    handleLogout() {\n      // Confirm logout action\n      if (confirm('Are you sure you want to sign out?')) {\n        this.$emit('logout')\n      }\n    },\n\n    getFullName() {\n      // Debug: Log user data structure\n      console.log('UserProfileDropdown - userData:', this.userData)\n      console.log('UserProfileDropdown - userData.profile:', this.userData?.profile)\n      console.log('UserProfileDropdown - userData keys:', Object.keys(this.userData || {}))\n\n      if (!this.userData) {\n        return 'User'\n      }\n\n      const parts = []\n\n      // Try all possible data structure patterns to ensure compatibility\n\n      // Pattern 1: Check if userData has profile object with nested properties (backend structure)\n      if (this.userData.profile && typeof this.userData.profile === 'object') {\n        const profile = this.userData.profile\n        console.log('UserProfileDropdown - using profile object:', profile)\n        if (profile.first_name) parts.push(profile.first_name)\n        if (profile.middle_name) parts.push(profile.middle_name)\n        if (profile.last_name) parts.push(profile.last_name)\n        if (profile.suffix) parts.push(profile.suffix)\n      }\n\n      // Pattern 2: Check if profile fields are directly on userData (from useUserData composable)\n      if (parts.length === 0 && (this.userData.firstName || this.userData.lastName)) {\n        console.log('UserProfileDropdown - using direct userData properties')\n        if (this.userData.firstName) parts.push(this.userData.firstName)\n        if (this.userData.middleName) parts.push(this.userData.middleName)\n        if (this.userData.lastName) parts.push(this.userData.lastName)\n        if (this.userData.suffix) parts.push(this.userData.suffix)\n      }\n\n      // Pattern 3: Check if userData has first_name, last_name directly (raw backend data)\n      if (parts.length === 0 && (this.userData.first_name || this.userData.last_name)) {\n        console.log('UserProfileDropdown - using raw backend properties')\n        if (this.userData.first_name) parts.push(this.userData.first_name)\n        if (this.userData.middle_name) parts.push(this.userData.middle_name)\n        if (this.userData.last_name) parts.push(this.userData.last_name)\n        if (this.userData.suffix) parts.push(this.userData.suffix)\n      }\n\n      // Pattern 4: Try to extract from any nested user object\n      if (parts.length === 0 && this.userData.user && typeof this.userData.user === 'object') {\n        console.log('UserProfileDropdown - checking nested user object')\n        const user = this.userData.user\n        if (user.profile) {\n          if (user.profile.first_name) parts.push(user.profile.first_name)\n          if (user.profile.middle_name) parts.push(user.profile.middle_name)\n          if (user.profile.last_name) parts.push(user.profile.last_name)\n          if (user.profile.suffix) parts.push(user.profile.suffix)\n        } else {\n          if (user.first_name) parts.push(user.first_name)\n          if (user.middle_name) parts.push(user.middle_name)\n          if (user.last_name) parts.push(user.last_name)\n          if (user.suffix) parts.push(user.suffix)\n        }\n      }\n\n      const fullName = parts.join(' ').trim()\n\n      // Final fallback to username if no name parts found\n      const result = fullName || this.userData.username || this.userData.userName || 'User'\n\n      console.log('UserProfileDropdown - parts found:', parts)\n      console.log('UserProfileDropdown - computed fullName:', result)\n      return result\n    }\n  }\n}\n</script>\n\n<style scoped>\n.user-profile {\n  position: relative;\n  display: flex;\n  align-items: center;\n}\n\n.user-btn {\n  display: flex;\n  align-items: center;\n  gap: 0.75rem;\n  padding: 0.5rem;\n  background: transparent;\n  border: 2px solid transparent;\n  border-radius: 0.5rem;\n  cursor: pointer;\n  transition: all 0.2s ease-in-out;\n  color: var(--text-primary, #1b1b1b);\n}\n\n.user-btn:hover {\n  background-color: var(--bg-gray-5, #f9f9f9);\n  border-color: var(--border-light, #dfe1e2);\n}\n\n.user-btn:focus {\n  outline: none;\n  border-color: var(--gov-blue, #005ea2);\n}\n\n.user-btn:focus-visible {\n  outline: 3px solid var(--gov-yellow, #ffbe2e);\n  outline-offset: 2px;\n}\n\n.user-avatar {\n  width: 32px;\n  height: 32px;\n  border-radius: 50%;\n  overflow: hidden;\n  flex-shrink: 0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background-color: var(--bg-gray-10, #f0f0f0);\n}\n\n.avatar-image {\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n}\n\n.avatar-icon {\n  font-size: 1.5rem;\n  color: var(--text-light, #757575);\n}\n\n.user-info {\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n  gap: 0.125rem;\n}\n\n.user-name {\n  font-size: 0.875rem;\n  font-weight: 600;\n  line-height: 1.2;\n}\n\n.user-role {\n  font-size: 0.75rem;\n  color: var(--text-light, #757575);\n  line-height: 1;\n}\n\n.dropdown-arrow {\n  font-size: 0.75rem;\n  color: var(--text-light, #757575);\n  transition: transform 0.2s ease-in-out;\n}\n\n.user-profile.active .dropdown-arrow {\n  transform: rotate(180deg);\n}\n\n.user-dropdown-menu {\n  position: absolute;\n  top: 100%;\n  right: 0;\n  width: 240px;\n  background: var(--bg-white, #ffffff);\n  border: 2px solid var(--border-light, #dfe1e2);\n  border-radius: 0.5rem;\n  box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.1);\n  padding: 0.5rem 0;\n  margin-top: 0.5rem;\n  z-index: 1000;\n}\n\n.dropdown-header {\n  padding: 0.75rem 1rem;\n}\n\n.user-details strong {\n  display: block;\n  font-size: 0.875rem;\n  font-weight: 600;\n  color: var(--text-primary, #1b1b1b);\n  margin-bottom: 0.25rem;\n}\n\n.user-email {\n  font-size: 0.75rem;\n  color: var(--text-light, #757575);\n}\n\n.dropdown-divider {\n  height: 1px;\n  background-color: var(--border-light, #dfe1e2);\n  margin: 0.5rem 0;\n}\n\n.dropdown-item {\n  display: flex;\n  align-items: center;\n  gap: 0.75rem;\n  padding: 0.75rem 1rem;\n  color: var(--text-primary, #1b1b1b);\n  text-decoration: none;\n  font-size: 0.875rem;\n  transition: background-color 0.2s ease-in-out;\n}\n\n.dropdown-item:hover {\n  background-color: var(--bg-gray-5, #f9f9f9);\n}\n\n.dropdown-item:focus {\n  outline: none;\n  background-color: var(--gov-blue-lighter, #e7f6f8);\n}\n\n.dropdown-item i {\n  width: 16px;\n  text-align: center;\n  flex-shrink: 0;\n}\n\n.dropdown-item.disabled {\n  color: var(--text-light, #757575);\n  cursor: not-allowed;\n  opacity: 0.6;\n}\n\n.dropdown-item.disabled:hover {\n  background-color: transparent;\n}\n\n.disabled-icon {\n  margin-left: auto;\n  width: auto !important;\n  font-size: 0.75rem;\n  color: var(--text-light, #757575);\n}\n\n.logout-item {\n  color: var(--gov-red, #d63384);\n}\n\n.logout-item:hover {\n  background-color: rgba(214, 51, 132, 0.1);\n}\n\n/* Mobile responsive */\n@media (max-width: 768px) {\n  .user-info {\n    display: none;\n  }\n  \n  .user-dropdown-menu {\n    width: 200px;\n  }\n}\n\n/* High contrast mode support */\n@media (prefers-contrast: high) {\n  .user-dropdown-menu {\n    border-color: var(--text-primary, #1b1b1b);\n    box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.3);\n  }\n}\n\n/* Reduced motion support */\n@media (prefers-reduced-motion: reduce) {\n  .user-btn,\n  .dropdown-arrow,\n  .dropdown-item {\n    transition: none;\n  }\n  \n  .user-profile.active .dropdown-arrow {\n    transform: none;\n  }\n}\n</style>\n"],"mappings":";;;EAQWA,KAAK,EAAC;AAAa;;;;EAQZA,KAAK,EAAC,gCAAgC;EAAC,aAAW,EAAC;;;EAE1DA,KAAK,EAAC;AAAW;;EACdA,KAAK,EAAC;AAAW;;;EAQzBA,KAAK,EAAC,oBAAoB;EAC1BC,IAAI,EAAC,MAAM;EACX,YAAU,EAAC;;;;;EAasBD,KAAK,EAAC,2BAA2B;EAAC,aAAW,EAAC;;;uBAzCnFE,mBAAA,CAwDM;IAxDDF,KAAK,EAAAG,eAAA,EAAC,cAAc;MAAAC,MAAA,EAAmBC,MAAA,CAAAC;IAAM;MAChDC,mBAAA,CAqBS;IApBPP,KAAK,EAAC,UAAU;IACfQ,OAAK,EAAAC,MAAA,QAAAA,MAAA,UAAAC,IAAA,KAAEC,QAAA,CAAAC,YAAA,IAAAD,QAAA,CAAAC,YAAA,IAAAF,IAAA,CAAY;IACpB,YAAU,EAAC,mBAAmB;IAC7B,eAAa,EAAEL,MAAA,CAAAC;MAEhBC,mBAAA,CASM,OATNM,UASM,GAPIR,MAAA,CAAAS,QAAQ,CAACC,UAAU,I,cAD3Bb,mBAAA,CAME;;IAJCc,GAAG,EAAEX,MAAA,CAAAS,QAAQ,CAACC,UAAU;IACxBE,GAAG,EAAEN,QAAA,CAAAO,WAAW;IACjBlB,KAAK,EAAC,cAAc;IACpBmB,OAAO,EAAC;wDAEVjB,mBAAA,CAAwE,KAAxEkB,UAAwE,G,GAE1Eb,mBAAA,CAGM,OAHNc,UAGM,GAFJd,mBAAA,CAAkD,QAAlDe,UAAkD,EAAAC,gBAAA,CAAvBZ,QAAA,CAAAO,WAAW,oB,0BACtCX,mBAAA,CAA4C;IAAtCP,KAAK,EAAC;EAAW,GAAC,eAAa,qB,6BAEvCO,mBAAA,CAAqE;IAAlEP,KAAK,EAAC,oCAAoC;IAAC,aAAW,EAAC;4DAIpDK,MAAA,CAAAC,MAAM,I,cADdJ,mBAAA,CA+BM,OA/BNsB,UA+BM,GAzBJjB,mBAAA,CAYI;IAXFkB,IAAI,EAAC,GAAG;IACRzB,KAAK,EAAAG,eAAA,EAAC,eAAe;MAAA,aACEE,MAAA,CAAAqB;IAAmB;IACzClB,OAAK,EAAAC,MAAA,QAAAA,MAAA,MAAAkB,cAAA,CAAAC,MAAA,IAAUvB,MAAA,CAAAqB,mBAAmB,GAAGf,QAAA,CAAAkB,gBAAgB;IACtD5B,IAAI,EAAC,UAAU;IACd,eAAa,GAAGI,MAAA,CAAAqB,mBAAmB;IACnCI,KAAK,EAAEzB,MAAA,CAAAqB,mBAAmB;gCAE3BnB,mBAAA,CAA+C;IAA5CP,KAAK,EAAC,cAAc;IAAC,aAAW,EAAC;yDACpCO,mBAAA,CAAwB,cAAlB,aAAW,sB,CACPF,MAAA,CAAAqB,mBAAmB,I,cAA7BxB,mBAAA,CAAwF,KAAxF6B,UAAwF,K,kGAG1FxB,mBAAA,CAAoC;IAA/BP,KAAK,EAAC;EAAkB,6BAE7BO,mBAAA,CAQI;IAPFkB,IAAI,EAAC,GAAG;IACRzB,KAAK,EAAC,2BAA2B;IAChCQ,OAAK,EAAAC,MAAA,QAAAA,MAAA,MAAAkB,cAAA,KAAAjB,IAAA,KAAUC,QAAA,CAAAqB,YAAA,IAAArB,QAAA,CAAAqB,YAAA,IAAAtB,IAAA,CAAY;IAC5BT,IAAI,EAAC;gCAELM,mBAAA,CAAsD;IAAnDP,KAAK,EAAC,qBAAqB;IAAC,aAAW,EAAC;8BAC3CO,mBAAA,CAAqB,cAAf,UAAQ,oB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}