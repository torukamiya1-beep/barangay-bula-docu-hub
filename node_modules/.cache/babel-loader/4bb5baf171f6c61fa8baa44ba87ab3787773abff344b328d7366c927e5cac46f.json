{"ast":null,"code":"import { resolveComponent as _resolveComponent, createVNode as _createVNode, createCommentVNode as _createCommentVNode, normalizeClass as _normalizeClass, createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, vModelSelect as _vModelSelect, withDirectives as _withDirectives, vModelText as _vModelText, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createBlock as _createBlock, renderList as _renderList, Fragment as _Fragment } from \"vue\";\nconst _hoisted_1 = {\n  class: \"admin-reports\"\n};\nconst _hoisted_2 = {\n  class: \"dashboard-container\"\n};\nconst _hoisted_3 = {\n  class: \"container-fluid py-4\"\n};\nconst _hoisted_4 = {\n  class: \"row mb-4\"\n};\nconst _hoisted_5 = {\n  class: \"col-12\"\n};\nconst _hoisted_6 = {\n  class: \"card shadow\"\n};\nconst _hoisted_7 = {\n  class: \"card-header border-top\"\n};\nconst _hoisted_8 = {\n  class: \"row\"\n};\nconst _hoisted_9 = {\n  class: \"col-md-3 mb-3\"\n};\nconst _hoisted_10 = {\n  key: 0,\n  class: \"col-md-3 mb-3\"\n};\nconst _hoisted_11 = [\"max\"];\nconst _hoisted_12 = {\n  key: 1,\n  class: \"col-md-3 mb-3\"\n};\nconst _hoisted_13 = [\"max\"];\nconst _hoisted_14 = {\n  key: 2,\n  class: \"col-md-3 mb-3\"\n};\nconst _hoisted_15 = [\"max\"];\nconst _hoisted_16 = {\n  class: \"col-md-3 mb-3 d-flex align-items-end\"\n};\nconst _hoisted_17 = [\"disabled\"];\nconst _hoisted_18 = {\n  class: \"card-body\"\n};\nconst _hoisted_19 = {\n  key: 0,\n  class: \"text-center py-4\"\n};\nconst _hoisted_20 = {\n  key: 1,\n  class: \"row\"\n};\nconst _hoisted_21 = {\n  class: \"col-lg-8 mb-4\"\n};\nconst _hoisted_22 = {\n  class: \"card h-100\"\n};\nconst _hoisted_23 = {\n  class: \"card-body\"\n};\nconst _hoisted_24 = {\n  style: {\n    \"height\": \"300px\"\n  }\n};\nconst _hoisted_25 = {\n  class: \"col-12 mb-4\"\n};\nconst _hoisted_26 = {\n  class: \"card\"\n};\nconst _hoisted_27 = {\n  class: \"card-body\"\n};\nconst _hoisted_28 = {\n  class: \"table-responsive\"\n};\nconst _hoisted_29 = {\n  class: \"table table-hover\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_AdminHeader = _resolveComponent(\"AdminHeader\");\n  const _component_AdminSidebar = _resolveComponent(\"AdminSidebar\");\n  const _component_Bar = _resolveComponent(\"Bar\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createVNode(_component_AdminHeader, {\n    userName: $data.adminData?.first_name || 'Admin',\n    notificationCount: _ctx.unreadNotifications,\n    showNotifications: _ctx.showNotifications,\n    showUserDropdown: $data.showUserDropdown,\n    sidebarCollapsed: $data.sidebarCollapsed,\n    activeMenu: $options.activeMenu,\n    onSidebarToggle: $options.handleSidebarToggle,\n    onNotificationToggle: _ctx.handleNotificationToggle,\n    onUserDropdownToggle: $options.handleUserDropdownToggle,\n    onMenuAction: $options.handleMenuAction,\n    onLogout: $options.handleLogout,\n    onViewAllNotifications: _ctx.handleViewAllNotifications\n  }, null, 8 /* PROPS */, [\"userName\", \"notificationCount\", \"showNotifications\", \"showUserDropdown\", \"sidebarCollapsed\", \"activeMenu\", \"onSidebarToggle\", \"onNotificationToggle\", \"onUserDropdownToggle\", \"onMenuAction\", \"onLogout\", \"onViewAllNotifications\"]), _createCommentVNode(\" Mobile Overlay \"), _createElementVNode(\"div\", {\n    class: _normalizeClass([\"mobile-overlay\", {\n      active: !$data.sidebarCollapsed && $data.isMobile\n    }]),\n    onClick: _cache[0] || (_cache[0] = (...args) => $options.closeMobileSidebar && $options.closeMobileSidebar(...args))\n  }, null, 2 /* CLASS */), _createElementVNode(\"div\", _hoisted_2, [_createVNode(_component_AdminSidebar, {\n    collapsed: $data.sidebarCollapsed,\n    activeMenu: $options.activeMenu,\n    onMenuChange: $options.handleMenuChange,\n    onLogout: $options.handleLogout,\n    onToggleSidebar: $options.handleSidebarToggle\n  }, null, 8 /* PROPS */, [\"collapsed\", \"activeMenu\", \"onMenuChange\", \"onLogout\", \"onToggleSidebar\"]), _createElementVNode(\"main\", {\n    class: _normalizeClass([\"main-content\", {\n      'sidebar-collapsed': $data.sidebarCollapsed\n    }])\n  }, [_createElementVNode(\"div\", _hoisted_3, [_createCommentVNode(\" Report Controls \"), _createElementVNode(\"div\", _hoisted_4, [_createElementVNode(\"div\", _hoisted_5, [_createElementVNode(\"div\", _hoisted_6, [_createCommentVNode(\" PDF Export Configuration \"), _createElementVNode(\"div\", _hoisted_7, [_cache[11] || (_cache[11] = _createElementVNode(\"h6\", {\n    class: \"mb-3\"\n  }, [_createElementVNode(\"i\", {\n    class: \"fas fa-file-pdf text-danger me-2\"\n  }), _createTextVNode(\" PDF Export Configuration \")], -1 /* HOISTED */)), _createElementVNode(\"div\", _hoisted_8, [_createElementVNode(\"div\", _hoisted_9, [_cache[7] || (_cache[7] = _createElementVNode(\"label\", {\n    class: \"form-label\"\n  }, \"Report Type\", -1 /* HOISTED */)), _withDirectives(_createElementVNode(\"select\", {\n    class: \"form-select\",\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $data.pdfExportForm.reportType = $event)\n  }, _cache[6] || (_cache[6] = [_createElementVNode(\"option\", {\n    value: \"daily\"\n  }, \"Daily Report\", -1 /* HOISTED */), _createElementVNode(\"option\", {\n    value: \"weekly\"\n  }, \"Weekly Report\", -1 /* HOISTED */), _createElementVNode(\"option\", {\n    value: \"monthly\"\n  }, \"Monthly Report\", -1 /* HOISTED */)]), 512 /* NEED_PATCH */), [[_vModelSelect, $data.pdfExportForm.reportType]])]), $data.pdfExportForm.reportType === 'daily' ? (_openBlock(), _createElementBlock(\"div\", _hoisted_10, [_cache[8] || (_cache[8] = _createElementVNode(\"label\", {\n    class: \"form-label\"\n  }, \"Select Date\", -1 /* HOISTED */)), _withDirectives(_createElementVNode(\"input\", {\n    type: \"date\",\n    class: \"form-control\",\n    \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => $data.pdfExportForm.selectedDate = $event),\n    max: $options.getCurrentDate()\n  }, null, 8 /* PROPS */, _hoisted_11), [[_vModelText, $data.pdfExportForm.selectedDate]])])) : _createCommentVNode(\"v-if\", true), $data.pdfExportForm.reportType === 'weekly' ? (_openBlock(), _createElementBlock(\"div\", _hoisted_12, [_cache[9] || (_cache[9] = _createElementVNode(\"label\", {\n    class: \"form-label\"\n  }, \"Select Week\", -1 /* HOISTED */)), _withDirectives(_createElementVNode(\"input\", {\n    type: \"week\",\n    class: \"form-control\",\n    \"onUpdate:modelValue\": _cache[3] || (_cache[3] = $event => $data.pdfExportForm.selectedWeek = $event),\n    max: $options.getCurrentWeek()\n  }, null, 8 /* PROPS */, _hoisted_13), [[_vModelText, $data.pdfExportForm.selectedWeek]])])) : _createCommentVNode(\"v-if\", true), $data.pdfExportForm.reportType === 'monthly' ? (_openBlock(), _createElementBlock(\"div\", _hoisted_14, [_cache[10] || (_cache[10] = _createElementVNode(\"label\", {\n    class: \"form-label\"\n  }, \"Select Month\", -1 /* HOISTED */)), _withDirectives(_createElementVNode(\"input\", {\n    type: \"month\",\n    class: \"form-control\",\n    \"onUpdate:modelValue\": _cache[4] || (_cache[4] = $event => $data.pdfExportForm.selectedMonth = $event),\n    max: $options.getCurrentMonth()\n  }, null, 8 /* PROPS */, _hoisted_15), [[_vModelText, $data.pdfExportForm.selectedMonth]])])) : _createCommentVNode(\"v-if\", true), _createElementVNode(\"div\", _hoisted_16, [_createElementVNode(\"button\", {\n    class: \"btn btn-danger\",\n    onClick: _cache[5] || (_cache[5] = (...args) => $options.exportToPDF && $options.exportToPDF(...args)),\n    disabled: !$options.isPDFExportValid() || $data.pdfExportForm.loading\n  }, [_createElementVNode(\"i\", {\n    class: _normalizeClass([\"fas fa-file-pdf me-1\", {\n      'fa-spin': $data.pdfExportForm.loading\n    }])\n  }, null, 2 /* CLASS */), _createTextVNode(\" \" + _toDisplayString($data.pdfExportForm.loading ? 'Generating...' : 'Export PDF'), 1 /* TEXT */)], 8 /* PROPS */, _hoisted_17)])])]), _createElementVNode(\"div\", _hoisted_18, [$data.loading ? (_openBlock(), _createElementBlock(\"div\", _hoisted_19, _cache[12] || (_cache[12] = [_createElementVNode(\"div\", {\n    class: \"spinner-border text-primary\",\n    role: \"status\"\n  }, [_createElementVNode(\"span\", {\n    class: \"visually-hidden\"\n  }, \"Loading...\")], -1 /* HOISTED */)]))) : $data.analyticsData ? (_openBlock(), _createElementBlock(\"div\", _hoisted_20, [_createCommentVNode(\" Request Trends Chart \"), _createElementVNode(\"div\", _hoisted_21, [_createElementVNode(\"div\", _hoisted_22, [_createElementVNode(\"div\", _hoisted_23, [_createElementVNode(\"div\", _hoisted_24, [$options.trendsChartData ? (_openBlock(), _createBlock(_component_Bar, {\n    key: 0,\n    data: $options.trendsChartData,\n    options: $data.chartOptions\n  }, null, 8 /* PROPS */, [\"data\", \"options\"])) : _createCommentVNode(\"v-if\", true)])])])]), _createCommentVNode(\" Status Distribution \"), _createCommentVNode(\" <div class=\\\"col-lg-6 mb-4\\\">\\n                      <div class=\\\"card h-100\\\">\\n                        <div class=\\\"card-header\\\">\\n                          <h6 class=\\\"card-title mb-0\\\">Status Distribution</h6>\\n                        </div>\\n                        <div class=\\\"card-body\\\">\\n                          <div style=\\\"height: 300px;\\\">\\n                            <Doughnut\\n                              v-if=\\\"statusDistributionChartData\\\"\\n                              :data=\\\"statusDistributionChartData\\\"\\n                              :options=\\\"chartOptions\\\"\\n                            />\\n                          </div>\\n                        </div>\\n                      </div>\\n                    </div> \"), _createCommentVNode(\" Top Clients \"), _createElementVNode(\"div\", _hoisted_25, [_createElementVNode(\"div\", _hoisted_26, [_cache[14] || (_cache[14] = _createElementVNode(\"div\", {\n    class: \"card-header\"\n  }, [_createElementVNode(\"h6\", {\n    class: \"card-title mb-0\"\n  }, \"Clients\")], -1 /* HOISTED */)), _createElementVNode(\"div\", _hoisted_27, [_createElementVNode(\"div\", _hoisted_28, [_createElementVNode(\"table\", _hoisted_29, [_cache[13] || (_cache[13] = _createElementVNode(\"thead\", null, [_createElementVNode(\"tr\", null, [_createElementVNode(\"th\", null, \"Client Name\"), _createElementVNode(\"th\", null, \"Total Requests\")])], -1 /* HOISTED */)), _createElementVNode(\"tbody\", null, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.analyticsData.topClients, client => {\n    return _openBlock(), _createElementBlock(\"tr\", {\n      key: client.client_name\n    }, [_createElementVNode(\"td\", null, _toDisplayString(client.client_name), 1 /* TEXT */), _createElementVNode(\"td\", null, _toDisplayString(client.request_count), 1 /* TEXT */)]);\n  }), 128 /* KEYED_FRAGMENT */))])])])])])])])) : _createCommentVNode(\"v-if\", true)])])])])])], 2 /* CLASS */)])]);\n}","map":{"version":3,"names":["class","style","_createElementBlock","_hoisted_1","_createVNode","_component_AdminHeader","userName","$data","adminData","first_name","notificationCount","_ctx","unreadNotifications","showNotifications","showUserDropdown","sidebarCollapsed","activeMenu","$options","onSidebarToggle","handleSidebarToggle","onNotificationToggle","handleNotificationToggle","onUserDropdownToggle","handleUserDropdownToggle","onMenuAction","handleMenuAction","onLogout","handleLogout","onViewAllNotifications","handleViewAllNotifications","_createCommentVNode","_createElementVNode","_normalizeClass","active","isMobile","onClick","_cache","args","closeMobileSidebar","_hoisted_2","_component_AdminSidebar","collapsed","onMenuChange","handleMenuChange","onToggleSidebar","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","pdfExportForm","reportType","$event","value","_hoisted_10","type","selectedDate","max","getCurrentDate","_hoisted_12","selectedWeek","getCurrentWeek","_hoisted_14","selectedMonth","getCurrentMonth","_hoisted_16","exportToPDF","disabled","isPDFExportValid","loading","_toDisplayString","_hoisted_18","_hoisted_19","role","analyticsData","_hoisted_20","_hoisted_21","_hoisted_22","_hoisted_23","_hoisted_24","trendsChartData","_createBlock","_component_Bar","data","options","chartOptions","_hoisted_25","_hoisted_26","_hoisted_27","_hoisted_28","_hoisted_29","_Fragment","_renderList","topClients","client","key","client_name","request_count"],"sources":["D:\\brgy_docu_hub\\BOSFDR\\src\\components\\admin\\AdminReports.vue"],"sourcesContent":["<template>\n  <div class=\"admin-reports\">\n    <AdminHeader\n      :userName=\"adminData?.first_name || 'Admin'\"\n      :notificationCount=\"unreadNotifications\"\n      :showNotifications=\"showNotifications\"\n      :showUserDropdown=\"showUserDropdown\"\n      :sidebarCollapsed=\"sidebarCollapsed\"\n      :activeMenu=\"activeMenu\"\n      @sidebar-toggle=\"handleSidebarToggle\"\n      @notification-toggle=\"handleNotificationToggle\"\n      @user-dropdown-toggle=\"handleUserDropdownToggle\"\n      @menu-action=\"handleMenuAction\"\n      @logout=\"handleLogout\"\n      @view-all-notifications=\"handleViewAllNotifications\"\n    />\n\n    <!-- Mobile Overlay -->\n    <div\n      class=\"mobile-overlay\"\n      :class=\"{ active: !sidebarCollapsed && isMobile }\"\n      @click=\"closeMobileSidebar\"\n    ></div>\n\n    <div class=\"dashboard-container\">\n      <AdminSidebar\n        :collapsed=\"sidebarCollapsed\"\n        :activeMenu=\"activeMenu\"\n        @menu-change=\"handleMenuChange\"\n        @logout=\"handleLogout\"\n        @toggle-sidebar=\"handleSidebarToggle\"\n      />\n\n      <main class=\"main-content\" :class=\"{ 'sidebar-collapsed': sidebarCollapsed }\">\n        <div class=\"container-fluid py-4\">\n          <!-- Report Controls -->\n          <div class=\"row mb-4\">\n            <div class=\"col-12\">\n              <div class=\"card shadow\">\n                <!-- PDF Export Configuration -->\n                <div class=\"card-header border-top\">\n                  <h6 class=\"mb-3\">\n                    <i class=\"fas fa-file-pdf text-danger me-2\"></i>\n                    PDF Export Configuration\n                  </h6>\n\n                  <div class=\"row\">\n                    <div class=\"col-md-3 mb-3\">\n                      <label class=\"form-label\">Report Type</label>\n                      <select class=\"form-select\" v-model=\"pdfExportForm.reportType\">\n                        <option value=\"daily\">Daily Report</option>\n                        <option value=\"weekly\">Weekly Report</option>\n                        <option value=\"monthly\">Monthly Report</option>\n                      </select>\n                    </div>\n                    <div class=\"col-md-3 mb-3\" v-if=\"pdfExportForm.reportType === 'daily'\">\n                      <label class=\"form-label\">Select Date</label>\n                      <input\n                        type=\"date\"\n                        class=\"form-control\"\n                        v-model=\"pdfExportForm.selectedDate\"\n                        :max=\"getCurrentDate()\"\n                      >\n                    </div>\n                    <div class=\"col-md-3 mb-3\" v-if=\"pdfExportForm.reportType === 'weekly'\">\n                      <label class=\"form-label\">Select Week</label>\n                      <input\n                        type=\"week\"\n                        class=\"form-control\"\n                        v-model=\"pdfExportForm.selectedWeek\"\n                        :max=\"getCurrentWeek()\"\n                      >\n                    </div>\n                    <div class=\"col-md-3 mb-3\" v-if=\"pdfExportForm.reportType === 'monthly'\">\n                      <label class=\"form-label\">Select Month</label>\n                      <input\n                        type=\"month\"\n                        class=\"form-control\"\n                        v-model=\"pdfExportForm.selectedMonth\"\n                        :max=\"getCurrentMonth()\"\n                      >\n                    </div>\n                    <div class=\"col-md-3 mb-3 d-flex align-items-end\">\n                      <button\n                        class=\"btn btn-danger\"\n                        @click=\"exportToPDF\"\n                        :disabled=\"!isPDFExportValid() || pdfExportForm.loading\"\n                      >\n                        <i class=\"fas fa-file-pdf me-1\" :class=\"{ 'fa-spin': pdfExportForm.loading }\"></i>\n                        {{ pdfExportForm.loading ? 'Generating...' : 'Export PDF' }}\n                      </button>\n                    </div>\n                  </div>\n                </div>\n\n                <div class=\"card-body\">\n                  <div v-if=\"loading\" class=\"text-center py-4\">\n                    <div class=\"spinner-border text-primary\" role=\"status\">\n                      <span class=\"visually-hidden\">Loading...</span>\n                    </div>\n                  </div>\n\n                  <div v-else-if=\"analyticsData\" class=\"row\">\n                    <!-- Request Trends Chart -->\n                    <div class=\"col-lg-8 mb-4\">\n                      <div class=\"card h-100\">\n                        <div class=\"card-body\">\n                          <div style=\"height: 300px;\">\n                            <Bar\n                              v-if=\"trendsChartData\"\n                              :data=\"trendsChartData\"\n                              :options=\"chartOptions\"\n                            />\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n\n                    <!-- Status Distribution -->\n                    <!-- <div class=\"col-lg-6 mb-4\">\n                      <div class=\"card h-100\">\n                        <div class=\"card-header\">\n                          <h6 class=\"card-title mb-0\">Status Distribution</h6>\n                        </div>\n                        <div class=\"card-body\">\n                          <div style=\"height: 300px;\">\n                            <Doughnut\n                              v-if=\"statusDistributionChartData\"\n                              :data=\"statusDistributionChartData\"\n                              :options=\"chartOptions\"\n                            />\n                          </div>\n                        </div>\n                      </div>\n                    </div> -->\n\n                    <!-- Top Clients -->\n                    <div class=\"col-12 mb-4\">\n                      <div class=\"card\">\n                        <div class=\"card-header\">\n                          <h6 class=\"card-title mb-0\">Clients</h6>\n                        </div>\n                        <div class=\"card-body\">\n                          <div class=\"table-responsive\">\n                            <table class=\"table table-hover\">\n                              <thead>\n                                <tr>\n                                  <th>Client Name</th>\n                                  <th>Total Requests</th>\n                                </tr>\n                              </thead>\n                              <tbody>\n                                <tr v-for=\"client in analyticsData.topClients\" :key=\"client.client_name\">\n                                  <td>{{ client.client_name }}</td>\n                                  <td>{{ client.request_count }}</td>\n                                </tr>\n                              </tbody>\n                            </table>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n\n        </div>\n      </main>\n    </div>\n  </div>\n</template>\n\n<script>\nimport AdminHeader from './AdminHeader.vue';\nimport AdminSidebar from './AdminSidebar.vue';\nimport adminDocumentService from '../../services/adminDocumentService';\nimport { Chart as ChartJS, CategoryScale, LinearScale, BarElement, Title, Tooltip, Legend, ArcElement, LineElement, PointElement } from 'chart.js';\nimport { Bar } from 'vue-chartjs';\n\nChartJS.register(CategoryScale, LinearScale, BarElement, Title, Tooltip, Legend, ArcElement, LineElement, PointElement);\nimport unifiedAuthService from '@/services/unifiedAuthService';\nimport { jsPDF } from 'jspdf';\n// Import jspdf-autotable plugin - v5.x uses named export\nimport autoTable from 'jspdf-autotable';\n\n// Verify autoTable plugin is loaded at module level\nconsole.log('ðŸ“¦ Module loading - jsPDF autoTable check (v5.x):', {\n  jsPDFAvailable: typeof jsPDF !== 'undefined',\n  jsPDFVersion: jsPDF.version || 'unknown',\n  autoTableAvailable: typeof autoTable === 'function',\n  autoTableOnPrototype: jsPDF.prototype && typeof jsPDF.prototype.autoTable === 'function'\n});\n\nexport default {\n  name: 'AdminReports',\n  components: {\n    AdminHeader,\n    AdminSidebar,\n    Bar\n    //Doughnut\n  },\n\n  data() {\n    return {\n      // UI State\n      sidebarCollapsed: false,\n      showUserDropdown: false,\n      isMobile: false,\n      adminData: null,\n      // Component Data\n      loading: false,\n      analyticsData: null,\n      selectedPeriod: 'month',\n      reportFilters: {\n        reportType: 'daily',\n        date_from: '',\n        date_to: '',\n        format: 'json'\n      },\n      chartOptions: {\n        responsive: true,\n        maintainAspectRatio: false,\n        plugins: {\n          legend: {\n            position: 'top',\n          },\n          title: {\n            display: true,\n            text: 'Document Request Analytics'\n          }\n        }\n      },\n\n      // PDF Export Form (copied from RequestHistory.vue)\n      pdfExportForm: {\n        reportType: 'daily',\n        selectedDate: '',\n        selectedWeek: '',\n        selectedMonth: '',\n        loading: false\n      }\n    };\n  },\n\n  computed: {\n    activeMenu() {\n      const path = this.$route.path;\n      if (path.includes('/admin/users')) return 'users';\n      if (path.includes('/admin/requests')) return 'requests';\n      if (path.includes('/admin/reports')) return 'reports';\n      if (path.includes('/admin/settings')) return 'settings';\n      if (path.includes('/admin/activity-logs')) return 'activity';\n      if (path.includes('/admin/profile')) return 'profile';\n      return 'dashboard';\n    },\n    trendsChartData() {\n      if (!this.analyticsData?.trends) return null;\n\n      return {\n        labels: this.analyticsData.trends.map(item => item.period),\n        datasets: [\n          {\n            label: 'Completed Requests',\n            backgroundColor: '#28a745',\n            data: this.analyticsData.trends.map(item => item.completed_requests)\n          },\n          {\n            label: 'Rejected Requests',\n            backgroundColor: '#dc3545',\n            data: this.analyticsData.trends.map(item => item.rejected_requests)\n          },\n          {\n            label: 'Cancelled Requests',\n            backgroundColor: '#6c757d',\n            data: this.analyticsData.trends.map(item => item.cancelled_requests || 0)\n          }\n        ]\n      };\n    },\n    documentTypesChartData() {\n      if (!this.analyticsData?.documentTypes) return null;\n\n      return {\n        labels: this.analyticsData.documentTypes.map(item => item.type_name),\n        datasets: [{\n          data: this.analyticsData.documentTypes.map(item => item.request_count),\n          backgroundColor: [\n            '#007bff',\n            '#28a745',\n            '#ffc107',\n            '#dc3545',\n            '#6f42c1',\n            '#fd7e14'\n          ]\n        }]\n      };\n    },\n    statusDistributionChartData() {\n      if (!this.analyticsData?.statusDistribution) return null;\n\n      return {\n        labels: this.analyticsData.statusDistribution.map(item => item.status_name),\n        datasets: [{\n          data: this.analyticsData.statusDistribution.map(item => item.percentage),\n          backgroundColor: [\n            '#ffc107', // Pending\n            '#17a2b8', // Under Review\n            '#007bff', // Processing\n            '#28a745', // Completed\n            '#dc3545', // Rejected\n            '#6c757d', // Cancelled\n            '#fd7e14', // Ready for Pickup\n            '#20c997', // Additional Info Required\n            '#e83e8c'  // Other\n          ]\n        }]\n      };\n    },\n    revenueChartData() {\n      if (!this.analyticsData?.trends) return null;\n\n      return {\n        labels: this.analyticsData.trends.map(item => item.period),\n        datasets: [{\n          label: 'Revenue (â‚±)',\n          borderColor: '#28a745',\n          backgroundColor: 'rgba(40, 167, 69, 0.1)',\n          data: this.analyticsData.trends.map(item => parseFloat(item.total_revenue || 0))\n        }]\n      };\n    }\n  },\n\n  async mounted() {\n    // Check authentication\n    if (!unifiedAuthService.isLoggedIn() || unifiedAuthService.getUserType() !== 'admin') {\n      this.$router.push('/login');\n      return;\n    }\n\n    // Ensure jsPDF autoTable plugin is available\n    this.ensureAutoTablePlugin();\n\n    // Initialize UI state\n    this.initializeUI();\n\n    // Load component data\n    await this.loadAdminProfile();\n    await this.loadAnalyticsData();\n    this.setDefaultDateRange();\n\n    // Initialize PDF export form with default values\n    this.initializePDFExportForm();\n  },\n\n  beforeUnmount() {\n    if (this.handleResize) {\n      window.removeEventListener('resize', this.handleResize);\n    }\n  },\n\n\n\n  methods: {\n    // Initialize UI state\n    initializeUI() {\n      this.isMobile = window.innerWidth <= 768;\n\n      if (!this.isMobile) {\n        const saved = localStorage.getItem('adminSidebarCollapsed');\n        this.sidebarCollapsed = saved ? JSON.parse(saved) : false;\n      } else {\n        this.sidebarCollapsed = true;\n      }\n\n      this.handleResize = () => {\n        const wasMobile = this.isMobile;\n        this.isMobile = window.innerWidth <= 768;\n\n        if (this.isMobile && !wasMobile) {\n          this.sidebarCollapsed = true;\n        } else if (!this.isMobile && wasMobile) {\n          const saved = localStorage.getItem('adminSidebarCollapsed');\n          this.sidebarCollapsed = saved ? JSON.parse(saved) : false;\n        }\n      };\n      window.addEventListener('resize', this.handleResize);\n    },\n\n    handleSidebarToggle() {\n      this.sidebarCollapsed = !this.sidebarCollapsed;\n      localStorage.setItem('adminSidebarCollapsed', JSON.stringify(this.sidebarCollapsed));\n    },\n\n    handleMenuChange(menu) {\n      const routes = {\n        'dashboard': '/admin/dashboard',\n        'users': '/admin/users',\n        'requests': '/admin/requests',\n        'reports': '/admin/reports',\n        'settings': '/admin/settings',\n        'activity': '/admin/activity-logs',\n        'profile': '/admin/profile'\n      };\n\n      if (this.isMobile) {\n        this.sidebarCollapsed = true;\n      }\n\n      if (routes[menu]) {\n        this.$router.push(routes[menu]);\n      }\n    },\n\n    handleUserDropdownToggle() {\n      this.showUserDropdown = !this.showUserDropdown;\n    },\n\n    handleMenuAction(action) {\n      if (action === 'profile') {\n        this.$router.push('/admin/profile');\n      } else if (action === 'settings') {\n        this.$router.push('/admin/settings');\n      }\n      this.showUserDropdown = false;\n    },\n\n    closeMobileSidebar() {\n      if (this.isMobile) {\n        this.sidebarCollapsed = true;\n      }\n    },\n\n    handleLogout() {\n      unifiedAuthService.logout();\n      this.$router.push('/login');\n    },\n\n    async loadAdminProfile() {\n      try {\n        const user = unifiedAuthService.getCurrentUser();\n        if (user && user.profile) {\n          this.adminData = user.profile;\n        } else {\n          this.adminData = {\n            first_name: user?.username || 'Admin',\n            role: user?.role || 'admin'\n          };\n        }\n      } catch (error) {\n        console.error('Failed to load admin profile:', error);\n        const user = unifiedAuthService.getCurrentUser();\n        this.adminData = {\n          first_name: user?.username || 'Admin',\n          role: user?.role || 'admin'\n        };\n      }\n    },\n\n    setDefaultDateRange() {\n      const today = new Date();\n      const lastMonth = new Date(today.getFullYear(), today.getMonth() - 1, today.getDate());\n\n      this.reportFilters.date_to = today.toISOString().split('T')[0];\n      this.reportFilters.date_from = lastMonth.toISOString().split('T')[0];\n    },\n\n    async loadAnalyticsData() {\n      try {\n        this.loading = true;\n        const response = await adminDocumentService.getAnalyticsData(this.selectedPeriod);\n        this.analyticsData = response.data;\n      } catch (error) {\n        console.error('Failed to load analytics data:', error);\n        this.$toast.error('Failed to load analytics data');\n      } finally {\n        this.loading = false;\n      }\n    },\n\n    async onPeriodChange() {\n      await this.loadAnalyticsData();\n    },\n\n    async generateReport() {\n      try {\n        this.loading = true;\n        const response = await adminDocumentService.generateReport(\n          this.reportFilters.reportType,\n          this.reportFilters\n        );\n\n        if (this.reportFilters.format === 'csv') {\n          // CSV download is handled by the service\n          this.$toast.success('Report downloaded successfully');\n        } else {\n          // Display JSON data (could open in modal or new tab)\n          console.log('Report data:', response.data);\n          this.$toast.success('Report generated successfully');\n        }\n      } catch (error) {\n        console.error('Failed to generate report:', error);\n        this.$toast.error('Failed to generate report');\n      } finally {\n        this.loading = false;\n      }\n    },\n\n    async downloadReport() {\n      try {\n        this.loading = true;\n        await adminDocumentService.downloadReport(\n          this.reportFilters.reportType,\n          this.reportFilters\n        );\n        this.$toast.success('Report downloaded successfully');\n      } catch (error) {\n        console.error('Failed to download report:', error);\n        this.$toast.error('Failed to download report');\n      } finally {\n        this.loading = false;\n      }\n    },\n\n    // PDF Export functionality (copied from RequestHistory.vue)\n    async exportToPDF() {\n      if (!this.isPDFExportValid()) {\n        this.$toast.error('Please select a valid date range for the report');\n        return;\n      }\n\n      try {\n        this.pdfExportForm.loading = true;\n\n        // Get filtered data based on report type\n        const reportData = await this.getReportData();\n\n        if (!reportData || !Array.isArray(reportData) || reportData.length === 0) {\n          this.$toast.warning('No data found for the selected date range');\n          return;\n        }\n\n        // Generate PDF\n        const pdf = new jsPDF();\n\n        // Debug: Check autoTable availability\n        console.log('ðŸ”§ PDF Debug Info:', {\n          autoTableAvailable: typeof autoTable === 'function',\n          reportDataLength: reportData.length,\n          sampleData: reportData.length > 0 ? reportData[0] : null\n        });\n\n        // Verify autoTable is available\n        if (typeof autoTable !== 'function') {\n          console.error('âŒ autoTable function not available!');\n\n          // Safe toast notification with fallback\n          if (this.$toast && this.$toast.error) {\n            this.$toast.error('PDF table plugin failed to load. Please refresh the page.');\n          } else {\n            alert('PDF table plugin failed to load. Please refresh the page.');\n          }\n          return;\n        }\n\n        console.log('âœ… autoTable function is available');\n\n        this.generatePDFReport(pdf, reportData);\n\n        // Download PDF\n        const filename = this.getPDFFilename();\n        pdf.save(filename);\n\n        // Check if toast is available before using it\n        if (this.$toast && this.$toast.success) {\n          this.$toast.success('PDF report generated successfully');\n        } else {\n          console.log('âœ… PDF report generated successfully');\n        }\n      } catch (error) {\n        console.error('Failed to generate PDF report:', error);\n\n        // Safe toast notification with fallback\n        if (this.$toast && this.$toast.error) {\n          this.$toast.error('Failed to generate PDF report');\n        } else {\n          alert('Failed to generate PDF report. Check console for details.');\n        }\n      } finally {\n        this.pdfExportForm.loading = false;\n      }\n    },\n\n    // Get client requests data for the selected period\n    async getClientRequestsData() {\n      try {\n        // Calculate date range based on selected period\n        const dateRange = this.getDateRangeForPeriod();\n\n        const response = await adminDocumentService.getAllRequests({\n          date_from: dateRange.from,\n          date_to: dateRange.to,\n          page: 1,\n          limit: 1000 // Get all data for the report\n        });\n\n        if (response.success && response.data.requests) {\n          return response.data.requests;\n        }\n\n        return [];\n      } catch (error) {\n        console.error('Failed to fetch client requests data:', error);\n        return [];\n      }\n    },\n\n    // Get date range based on selected period\n    getDateRangeForPeriod() {\n      const today = new Date();\n      let fromDate;\n\n      switch (this.selectedPeriod) {\n        case 'day':\n          fromDate = new Date(today.getTime() - (30 * 24 * 60 * 60 * 1000)); // Last 30 days\n          break;\n        case 'week':\n          fromDate = new Date(today.getTime() - (12 * 7 * 24 * 60 * 60 * 1000)); // Last 12 weeks\n          break;\n        case 'month':\n        default:\n          fromDate = new Date(today.getTime() - (12 * 30 * 24 * 60 * 60 * 1000)); // Last 12 months\n          break;\n      }\n\n      return {\n        from: fromDate.toISOString().split('T')[0],\n        to: today.toISOString().split('T')[0]\n      };\n    },\n\n    // Generate PDF content for analytics report\n    generateAnalyticsPDF(pdf, clientRequestsData = []) {\n      // Document Header\n      pdf.setFontSize(20);\n      pdf.setFont('helvetica', 'bold');\n      pdf.setTextColor(44, 62, 80);\n      pdf.text('BARANGAY ANALYTICS REPORT', 105, 25, { align: 'center' });\n\n      // Decorative line\n      pdf.setDrawColor(52, 152, 219);\n      pdf.setLineWidth(1);\n      pdf.line(20, 30, 190, 30);\n\n      // Report metadata\n      pdf.setFontSize(12);\n      pdf.setFont('helvetica', 'normal');\n      pdf.setTextColor(0, 0, 0);\n\n      const periodText = this.selectedPeriod.charAt(0).toUpperCase() + this.selectedPeriod.slice(1);\n      const generatedDate = new Date().toLocaleDateString('en-US', {\n        year: 'numeric',\n        month: 'long',\n        day: 'numeric'\n      });\n\n      pdf.text(`Report Period: ${periodText}`, 20, 45);\n      pdf.text(`Generated: ${generatedDate}`, 20, 55);\n\n      let yPosition = 75;\n\n      // Request Trends Section\n      if (this.analyticsData.trends && this.analyticsData.trends.length > 0) {\n        pdf.setFontSize(16);\n        pdf.setFont('helvetica', 'bold');\n        pdf.setTextColor(52, 152, 219);\n        pdf.text('REQUEST TRENDS', 20, yPosition);\n        yPosition += 15;\n\n        // Prepare trends data for table\n        const trendsHeaders = ['Period', 'Total Requests', 'Completed', 'Pending', 'Revenue (â‚±)'];\n        const trendsData = this.analyticsData.trends.map(trend => [\n          trend.period || 'N/A',\n          trend.total_requests || '0',\n          trend.completed_requests || '0',\n          trend.pending_requests || '0',\n          this.formatCurrency(trend.total_revenue || 0)\n        ]);\n\n        // Add trends table\n        pdf.autoTable({\n          head: [trendsHeaders],\n          body: trendsData,\n          startY: yPosition,\n          theme: 'grid',\n          headStyles: {\n            fillColor: [52, 152, 219],\n            textColor: 255,\n            fontStyle: 'bold'\n          },\n          styles: {\n            fontSize: 10,\n            cellPadding: 4\n          },\n          columnStyles: {\n            0: { cellWidth: 40 },\n            1: { cellWidth: 30, halign: 'center' },\n            2: { cellWidth: 30, halign: 'center' },\n            3: { cellWidth: 30, halign: 'center' },\n            4: { cellWidth: 40, halign: 'right' }\n          }\n        });\n\n        yPosition = pdf.lastAutoTable.finalY + 20;\n      }\n\n      // Status Distribution Section\n      if (this.analyticsData.statusDistribution && this.analyticsData.statusDistribution.length > 0) {\n        // Check if we need a new page\n        if (yPosition > 200) {\n          pdf.addPage();\n          yPosition = 20;\n        }\n\n        pdf.setFontSize(16);\n        pdf.setFont('helvetica', 'bold');\n        pdf.setTextColor(52, 152, 219);\n        pdf.text('STATUS DISTRIBUTION', 20, yPosition);\n        yPosition += 15;\n\n        // Prepare status distribution data for table\n        const statusHeaders = ['Status', 'Count', 'Percentage'];\n        const totalRequests = this.analyticsData.statusDistribution.reduce((sum, status) => sum + (parseInt(status.count) || 0), 0);\n\n        const statusData = this.analyticsData.statusDistribution.map(status => {\n          const count = parseInt(status.count) || 0;\n          const percentage = totalRequests > 0 ? ((count / totalRequests) * 100).toFixed(1) + '%' : '0%';\n          return [\n            status.status_name || 'Unknown',\n            count.toString(),\n            percentage\n          ];\n        });\n\n        // Add status distribution table\n        pdf.autoTable({\n          head: [statusHeaders],\n          body: statusData,\n          startY: yPosition,\n          theme: 'grid',\n          headStyles: {\n            fillColor: [52, 152, 219],\n            textColor: 255,\n            fontStyle: 'bold'\n          },\n          styles: {\n            fontSize: 10,\n            cellPadding: 4\n          },\n          columnStyles: {\n            0: { cellWidth: 80 },\n            1: { cellWidth: 40, halign: 'center' },\n            2: { cellWidth: 40, halign: 'center' }\n          }\n        });\n\n        yPosition = pdf.lastAutoTable.finalY + 20;\n      }\n\n      // Top Clients Section\n      if (this.analyticsData.topClients && this.analyticsData.topClients.length > 0) {\n        // Check if we need a new page\n        if (yPosition > 200) {\n          pdf.addPage();\n          yPosition = 20;\n        }\n\n        pdf.setFontSize(16);\n        pdf.setFont('helvetica', 'bold');\n        pdf.setTextColor(52, 152, 219);\n        pdf.text('TOP CLIENTS', 20, yPosition);\n        yPosition += 15;\n\n        // Prepare top clients data for table\n        const clientsHeaders = ['Client Name', 'Email', 'Total Requests', 'Total Spent (â‚±)'];\n        const clientsData = this.analyticsData.topClients.map(client => [\n          client.client_name || 'N/A',\n          client.email || 'N/A',\n          client.request_count || '0',\n          this.formatCurrency(client.total_spent || 0)\n        ]);\n\n        // Add top clients table\n        pdf.autoTable({\n          head: [clientsHeaders],\n          body: clientsData,\n          startY: yPosition,\n          theme: 'grid',\n          headStyles: {\n            fillColor: [52, 152, 219],\n            textColor: 255,\n            fontStyle: 'bold'\n          },\n          styles: {\n            fontSize: 10,\n            cellPadding: 4\n          },\n          columnStyles: {\n            0: { cellWidth: 60 },\n            1: { cellWidth: 60 },\n            2: { cellWidth: 30, halign: 'center' },\n            3: { cellWidth: 40, halign: 'right' }\n          }\n        });\n      }\n\n      // Client Requests Section\n      if (clientRequestsData && clientRequestsData.length > 0) {\n        // Check if we need a new page\n        if (yPosition > 150) {\n          pdf.addPage();\n          yPosition = 20;\n        }\n\n        pdf.setFontSize(16);\n        pdf.setFont('helvetica', 'bold');\n        pdf.setTextColor(52, 152, 219);\n        pdf.text('CLIENT REQUESTS', 20, yPosition);\n        yPosition += 15;\n\n        // Prepare client requests data for table\n        const requestsHeaders = ['Request #', 'Client Name', 'Document Type', 'Status', 'Amount (â‚±)', 'Date'];\n        const requestsData = clientRequestsData.slice(0, 50).map(request => [ // Limit to 50 requests to avoid huge PDFs\n          request.request_number || 'N/A',\n          this.getClientFullName(request) || 'N/A',\n          request.document_type || 'N/A',\n          this.formatStatus(request.status_name) || 'N/A',\n          this.formatCurrency(request.total_document_fee || request.total_fee || 0),\n          this.formatDate(request.requested_at) || 'N/A'\n        ]);\n\n        // Add client requests table\n        pdf.autoTable({\n          head: [requestsHeaders],\n          body: requestsData,\n          startY: yPosition,\n          theme: 'grid',\n          headStyles: {\n            fillColor: [52, 152, 219],\n            textColor: 255,\n            fontStyle: 'bold'\n          },\n          styles: {\n            fontSize: 9,\n            cellPadding: 3\n          },\n          columnStyles: {\n            0: { cellWidth: 25 },\n            1: { cellWidth: 40 },\n            2: { cellWidth: 35 },\n            3: { cellWidth: 25 },\n            4: { cellWidth: 25, halign: 'right' },\n            5: { cellWidth: 25, halign: 'center' }\n          }\n        });\n\n        // Add note if there are more requests\n        if (clientRequestsData.length > 50) {\n          const finalY = pdf.lastAutoTable.finalY + 10;\n          pdf.setFontSize(10);\n          pdf.setFont('helvetica', 'italic');\n          pdf.setTextColor(100, 100, 100);\n          pdf.text(`Note: Showing first 50 of ${clientRequestsData.length} total requests for this period.`, 20, finalY);\n        }\n      }\n\n      // Add footer\n      this.addAnalyticsPDFFooter(pdf);\n    },\n\n    // Add professional footer to analytics PDF\n    addAnalyticsPDFFooter(pdf) {\n      const pageCount = pdf.internal.getNumberOfPages();\n\n      for (let i = 1; i <= pageCount; i++) {\n        pdf.setPage(i);\n\n        // Footer line\n        pdf.setDrawColor(200, 200, 200);\n        pdf.setLineWidth(0.5);\n        pdf.line(20, 280, 190, 280);\n\n        // Footer text\n        pdf.setFontSize(9);\n        pdf.setFont('helvetica', 'normal');\n        pdf.setTextColor(100, 100, 100);\n\n        // Left side - Generated info\n        const generatedDate = new Date().toLocaleDateString('en-US', {\n          year: 'numeric',\n          month: 'long',\n          day: 'numeric',\n          hour: '2-digit',\n          minute: '2-digit'\n        });\n        pdf.text(`Generated on: ${generatedDate}`, 20, 285);\n\n        // Right side - Page number\n        pdf.text(`Page ${i} of ${pageCount}`, 190, 285, { align: 'right' });\n      }\n    },\n\n    // Format currency for display\n    formatCurrency(amount) {\n      const numAmount = parseFloat(amount) || 0;\n      return `â‚±${numAmount.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;\n    },\n\n    // Helper methods for formatting data in PDF\n    getClientFullName(request) {\n      if (request.client_name) return request.client_name;\n\n      const firstName = request.client_first_name || request.first_name || '';\n      const lastName = request.client_last_name || request.last_name || '';\n\n      return `${firstName} ${lastName}`.trim() || 'N/A';\n    },\n\n    formatStatus(status) {\n      if (!status) return 'N/A';\n\n      // Capitalize first letter of each word\n      return status.toLowerCase().replace(/\\b\\w/g, l => l.toUpperCase());\n    },\n\n    formatDate(dateString) {\n      if (!dateString) return 'N/A';\n\n      try {\n        const date = new Date(dateString);\n        return date.toLocaleDateString('en-US', {\n          year: 'numeric',\n          month: 'short',\n          day: 'numeric'\n        });\n      } catch (error) {\n        return 'N/A';\n      }\n    },\n\n    // Generate PDF report content (copied from RequestHistory.vue)\n    generatePDFReport(pdf, data) {\n      const dateRange = this.getDateRangeForReport();\n\n      // Document Header with improved styling\n      pdf.setFontSize(24);\n      pdf.setFont('helvetica', 'bold');\n      pdf.setTextColor(44, 62, 80);\n      pdf.text('BARANGAY BULA', 105, 25, { align: 'center' });\n\n      pdf.setFontSize(18);\n      pdf.setTextColor(52, 152, 219);\n      pdf.text('DOCUMENT MANAGEMENT SYSTEM', 105, 35, { align: 'center' });\n\n      // Decorative line\n      pdf.setDrawColor(52, 152, 219);\n      pdf.setLineWidth(1);\n      pdf.line(20, 40, 190, 40);\n\n      // Report title\n      pdf.setFontSize(16);\n      pdf.setFont('helvetica', 'bold');\n      pdf.setTextColor(44, 62, 80);\n      const reportTitle = this.getReportTitle();\n      pdf.text(reportTitle, 20, 55);\n\n      // Date range with improved formatting\n      pdf.setFontSize(11);\n      pdf.setFont('helvetica', 'normal');\n      const dateRangeText = this.getDateRangeText(dateRange);\n      pdf.text(`Report Period: ${dateRangeText}`, 20, 65);\n\n      // Generated date\n      const generatedDate = new Date().toLocaleDateString('en-US', {\n        year: 'numeric',\n        month: 'long',\n        day: 'numeric',\n        hour: '2-digit',\n        minute: '2-digit'\n      });\n      pdf.text(`Generated on: ${generatedDate}`, 20, 75);\n\n      // Summary statistics\n      const stats = this.calculateReportStats(data);\n      pdf.setFontSize(12);\n      pdf.setFont('helvetica', 'bold');\n      pdf.text('REPORT SUMMARY', 20, 90);\n\n      pdf.setFontSize(10);\n      pdf.setFont('helvetica', 'normal');\n      pdf.text(`Total Requests: ${stats.total}`, 20, 100);\n      pdf.text(`Completed: ${stats.completed}`, 20, 110);\n      pdf.text(`Pending: ${stats.pending}`, 20, 120);\n      pdf.text(`Rejected: ${stats.rejected}`, 20, 130);\n      pdf.text(`Total Revenue: ${this.formatCurrencyForPDF(stats.totalRevenue)}`, 20, 140);\n\n      // Requests table\n      if (data && data.length > 0) {\n        const tableData = data.slice(0, 100).map(request => [\n          request.request_number || 'N/A',\n          this.getClientFullName(request) || 'N/A',\n          this.getBeneficiaryName(request) || 'N/A',\n          this.getPickupPersonName(request) || 'N/A',\n          request.document_type || 'N/A',\n          this.formatStatus(request.status_name) || 'N/A',\n          this.formatCurrencyForPDF(request.total_document_fee || request.total_fee || 0),\n          this.formatDate(request.requested_at) || 'N/A'\n        ]);\n\n        // Use autoTable function (v5.x syntax)\n        try {\n          console.log('ðŸ”§ Calling autoTable function');\n          autoTable(pdf, {\n            head: [['Request #', 'Client Name', 'Beneficiary', 'Pickup Person', 'Document Type', 'Status', 'Amount', 'Date']],\n            body: tableData,\n            startY: 155,\n            theme: 'grid',\n            headStyles: {\n              fillColor: [52, 152, 219],\n              textColor: 255,\n              fontStyle: 'bold',\n              fontSize: 8\n            },\n            styles: {\n              fontSize: 7,\n              cellPadding: 3,\n              overflow: 'linebreak',\n              cellWidth: 'wrap'\n            },\n            columnStyles: {\n              0: { cellWidth: 20 },                    // Request #\n              1: { cellWidth: 25, overflow: 'linebreak' },  // Client Name (wrappable)\n              2: { cellWidth: 25, overflow: 'linebreak' },  // Beneficiary (wrappable)\n              3: { cellWidth: 22, overflow: 'linebreak' },  // Pickup Person (wrappable)\n              4: { cellWidth: 22 },                    // Document Type\n              5: { cellWidth: 18 },                    // Status\n              6: { cellWidth: 20, halign: 'right' },   // Amount\n              7: { cellWidth: 18, halign: 'center' }   // Date\n            }\n          });\n          console.log('âœ… AutoTable completed successfully');\n        } catch (autoTableError) {\n          console.error('âŒ AutoTable call failed:', autoTableError);\n          throw new Error(`AutoTable failed: ${autoTableError.message}`);\n        }\n      }\n\n      // Add footer\n      this.addAnalyticsPDFFooter(pdf);\n    },\n\n    // Calculate report statistics (copied from RequestHistory.vue)\n    calculateReportStats(data) {\n      if (!data || !Array.isArray(data) || data.length === 0) {\n        return {\n          total: 0,\n          completed: 0,\n          pending: 0,\n          rejected: 0,\n          totalRevenue: 0\n        };\n      }\n\n      const stats = {\n        total: data.length,\n        completed: 0,\n        pending: 0,\n        rejected: 0,\n        totalRevenue: 0\n      };\n\n      data.forEach(request => {\n        const status = (request.status_name || '').toLowerCase();\n\n        // Calculate total revenue for ALL requests in the report (not just completed)\n        const fee = parseFloat(request.total_document_fee || request.total_fee || 0);\n        stats.totalRevenue += fee;\n\n        // Count status categories\n        if (status === 'completed') {\n          stats.completed++;\n        } else if (status === 'rejected' || status === 'cancelled') {\n          stats.rejected++;\n        } else {\n          stats.pending++;\n        }\n      });\n\n      return stats;\n    },\n\n    formatCurrencyForPDF(amount) {\n      const numAmount = parseFloat(amount) || 0;\n      return `PHP ${numAmount.toLocaleString('en-US', {\n        minimumFractionDigits: 2,\n        maximumFractionDigits: 2\n      })}`;\n    },\n\n    // Get beneficiary name for third-party requests\n    getBeneficiaryName(request) {\n      console.log('ðŸ” getBeneficiaryName called with:', {\n        is_third_party_request: request.is_third_party_request,\n        beneficiary_name: request.beneficiary_name,\n        beneficiary: request.beneficiary\n      });\n\n      if (!request.is_third_party_request) {\n        return 'Self';\n      }\n\n      // Try different possible field names for beneficiary\n      if (request.beneficiary_name) {\n        return request.beneficiary_name;\n      }\n\n      if (request.beneficiary && request.beneficiary.full_name) {\n        return request.beneficiary.full_name;\n      }\n\n      if (request.beneficiary) {\n        const firstName = request.beneficiary.first_name || '';\n        const lastName = request.beneficiary.last_name || '';\n        const fullName = `${firstName} ${lastName}`.trim();\n        if (fullName) return fullName;\n      }\n\n      return 'N/A';\n    },\n\n    // Get pickup person name\n    getPickupPersonName(request) {\n      console.log('ðŸ” getPickupPersonName called with:', {\n        pickup_person_name: request.pickup_person_name,\n        authorized_pickup: request.authorized_pickup\n      });\n\n      // Check for pickup person name field\n      if (request.pickup_person_name) {\n        return request.pickup_person_name;\n      }\n\n      // Check for authorized pickup object\n      if (request.authorized_pickup && request.authorized_pickup.full_name) {\n        return request.authorized_pickup.full_name;\n      }\n\n      // Default to client pickup\n      return 'Client';\n    },\n\n    // Ensure jsPDF autoTable plugin is available (v5.x uses function export)\n    ensureAutoTablePlugin() {\n      try {\n        if (typeof autoTable === 'function') {\n          console.log('âœ… jsPDF autoTable function is available (v5.x)');\n          return true;\n        } else {\n          console.error('âŒ autoTable function not available');\n          return false;\n        }\n      } catch (error) {\n        console.error('âŒ Error checking autoTable plugin:', error);\n        return false;\n      }\n    },\n\n    // Initialize PDF export form with default values (copied from RequestHistory.vue)\n    initializePDFExportForm() {\n      // Set default date to today\n      this.pdfExportForm.selectedDate = this.getCurrentDate();\n\n      // Set default week to current week\n      this.pdfExportForm.selectedWeek = this.getCurrentWeek();\n\n      // Set default month to current month\n      this.pdfExportForm.selectedMonth = this.getCurrentMonth();\n    },\n\n    // Get report data based on selected filters (copied from RequestHistory.vue)\n    async getReportData() {\n      const reportFilters = {\n        status: '', // Get all statuses\n        document_type: '',\n        priority: '',\n        search: ''\n      };\n\n      // Set date range based on report type\n      const dateRange = this.getDateRangeForReport();\n      reportFilters.date_from = dateRange.from;\n      reportFilters.date_to = dateRange.to;\n\n      try {\n        console.log('ðŸ“Š Fetching report data with filters:', reportFilters);\n        console.log('ðŸ“Š Date range details:', {\n          reportType: this.pdfExportForm.reportType,\n          selectedDate: this.pdfExportForm.selectedDate,\n          selectedWeek: this.pdfExportForm.selectedWeek,\n          selectedMonth: this.pdfExportForm.selectedMonth,\n          calculatedRange: dateRange\n        });\n        const response = await adminDocumentService.getAllRequests({\n          ...reportFilters,\n          page: 1,\n          limit: 1000 // Get all data for the report\n        });\n\n        if (response.success && response.data && response.data.requests) {\n          console.log(`ðŸ“Š Retrieved ${response.data.requests.length} requests for report`);\n\n          // Debug: Log sample request data to check fields\n          if (response.data.requests.length > 0) {\n            console.log('ðŸ“Š Sample request data:', response.data.requests[0]);\n            console.log('ðŸ“Š Available fields:', Object.keys(response.data.requests[0]));\n            console.log('ðŸ“Š Beneficiary fields check:', {\n              is_third_party_request: response.data.requests[0].is_third_party_request,\n              beneficiary_name: response.data.requests[0].beneficiary_name,\n              pickup_person_name: response.data.requests[0].pickup_person_name\n            });\n          }\n\n          return response.data.requests;\n        } else {\n          console.warn('ðŸ“Š No data returned from API');\n          return [];\n        }\n      } catch (error) {\n        console.error('ðŸ“Š Failed to fetch report data:', error);\n        throw error;\n      }\n    },\n\n    // Get date range based on report type and selected values (copied from RequestHistory.vue)\n    getDateRangeForReport() {\n      const { reportType, selectedDate, selectedWeek, selectedMonth } = this.pdfExportForm;\n\n      switch (reportType) {\n        case 'daily':\n          return {\n            from: selectedDate,\n            to: selectedDate\n          };\n\n        case 'weekly':\n          if (selectedWeek) {\n            const [year, week] = selectedWeek.split('-W');\n            const startDate = this.getDateFromWeek(parseInt(year), parseInt(week));\n            const endDate = new Date(startDate);\n            endDate.setDate(startDate.getDate() + 6);\n\n            return {\n              from: startDate.toISOString().split('T')[0],\n              to: endDate.toISOString().split('T')[0]\n            };\n          }\n          break;\n\n        case 'monthly':\n          if (selectedMonth) {\n            const [year, month] = selectedMonth.split('-');\n            const startDate = new Date(parseInt(year), parseInt(month) - 1, 1);\n            const endDate = new Date(parseInt(year), parseInt(month), 0);\n\n            return {\n              from: startDate.toISOString().split('T')[0],\n              to: endDate.toISOString().split('T')[0]\n            };\n          }\n          break;\n      }\n\n      // Fallback to today\n      const today = new Date().toISOString().split('T')[0];\n      return { from: today, to: today };\n    },\n\n    // Helper methods for PDF export (copied from RequestHistory.vue)\n    isPDFExportValid() {\n      const { reportType, selectedDate, selectedWeek, selectedMonth } = this.pdfExportForm;\n\n      switch (reportType) {\n        case 'daily':\n          return selectedDate !== '';\n        case 'weekly':\n          return selectedWeek !== '';\n        case 'monthly':\n          return selectedMonth !== '';\n        default:\n          return false;\n      }\n    },\n\n    getPDFFilename() {\n      const { reportType, selectedDate, selectedWeek, selectedMonth } = this.pdfExportForm;\n      const timestamp = new Date().toISOString().split('T')[0];\n\n      switch (reportType) {\n        case 'daily':\n          return `daily_report_${selectedDate}_${timestamp}.pdf`;\n        case 'weekly':\n          return `weekly_report_${selectedWeek}_${timestamp}.pdf`;\n        case 'monthly':\n          return `monthly_report_${selectedMonth}_${timestamp}.pdf`;\n        default:\n          return `report_${timestamp}.pdf`;\n      }\n    },\n\n    getReportTitle() {\n      const { reportType } = this.pdfExportForm;\n\n      switch (reportType) {\n        case 'daily':\n          return 'Daily Document Request Report';\n        case 'weekly':\n          return 'Weekly Document Request Report';\n        case 'monthly':\n          return 'Monthly Document Request Report';\n        default:\n          return 'Document Request Report';\n      }\n    },\n\n    getDateRangeText(dateRange) {\n      if (dateRange.from === dateRange.to) {\n        return this.formatDate(dateRange.from);\n      }\n      return `${this.formatDate(dateRange.from)} to ${this.formatDate(dateRange.to)}`;\n    },\n\n    // Helper methods for date handling (copied from RequestHistory.vue)\n    getCurrentDate() {\n      return new Date().toISOString().split('T')[0];\n    },\n\n    getCurrentWeek() {\n      const now = new Date();\n      const year = now.getFullYear();\n      const week = this.getWeekNumber(now);\n      return `${year}-W${week.toString().padStart(2, '0')}`;\n    },\n\n    getCurrentMonth() {\n      const now = new Date();\n      const year = now.getFullYear();\n      const month = (now.getMonth() + 1).toString().padStart(2, '0');\n      return `${year}-${month}`;\n    },\n\n    getWeekNumber(date) {\n      const d = new Date(Date.UTC(date.getFullYear(), date.getMonth(), date.getDate()));\n      const dayNum = d.getUTCDay() || 7;\n      d.setUTCDate(d.getUTCDate() + 4 - dayNum);\n      const yearStart = new Date(Date.UTC(d.getUTCFullYear(), 0, 1));\n      return Math.ceil((((d - yearStart) / 86400000) + 1) / 7);\n    },\n\n    getDateFromWeek(year, week) {\n      const simple = new Date(year, 0, 1 + (week - 1) * 7);\n      const dow = simple.getDay();\n      const ISOweekStart = simple;\n      if (dow <= 4) {\n        ISOweekStart.setDate(simple.getDate() - simple.getDay() + 1);\n      } else {\n        ISOweekStart.setDate(simple.getDate() + 8 - simple.getDay());\n      }\n      return ISOweekStart;\n    }\n  }\n};\n</script>\n\n<style scoped>\n@import './css/adminDashboard.css';\n\n/* Report card styles */\n.report-card {\n  cursor: pointer;\n  transition: all 0.3s ease;\n}\n\n.report-card:hover {\n  transform: translateY(-3px);\n  box-shadow: 0 0.5rem 2rem 0 rgba(58, 59, 69, 0.3);\n}\n\n.report-card:active {\n  transform: translateY(-1px);\n}\n\n/* Icon circle for reports */\n.icon-circle {\n  width: 3rem;\n  height: 3rem;\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 1.2rem;\n}\n\n/* Table improvements */\n.table-sm th,\n.table-sm td {\n  padding: 0.5rem;\n  font-size: 0.875rem;\n}\n\n/* Form improvements */\n.form-control-sm,\n.form-select-sm {\n  font-size: 0.875rem;\n}\n\n/* Badge improvements */\n.badge {\n  font-size: 0.75rem;\n  padding: 0.375rem 0.75rem;\n}\n\n/* Responsive improvements */\n@media (max-width: 768px) {\n  .report-card .card-body {\n    padding: 1rem;\n  }\n\n  .icon-circle {\n    width: 2.5rem;\n    height: 2.5rem;\n    font-size: 1rem;\n  }\n\n  .btn-group {\n    flex-direction: column;\n  }\n\n  .btn-group .btn {\n    border-radius: 0.375rem !important;\n    margin-bottom: 0.25rem;\n  }\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}