{"ast":null,"code":"import { createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, openBlock as _openBlock, createElementBlock as _createElementBlock, Fragment as _Fragment, renderList as _renderList, resolveComponent as _resolveComponent, createBlock as _createBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"modal fade\",\n  id: \"residencyDocumentsModal\",\n  tabindex: \"-1\",\n  \"aria-labelledby\": \"residencyDocumentsModalLabel\",\n  \"aria-hidden\": \"true\"\n};\nconst _hoisted_2 = {\n  class: \"modal-dialog modal-xl modal-dialog-scrollable\"\n};\nconst _hoisted_3 = {\n  class: \"modal-content\"\n};\nconst _hoisted_4 = {\n  class: \"modal-body\"\n};\nconst _hoisted_5 = {\n  key: 0\n};\nconst _hoisted_6 = {\n  class: \"row mb-4\"\n};\nconst _hoisted_7 = {\n  class: \"col-12\"\n};\nconst _hoisted_8 = {\n  class: \"card bg-light\"\n};\nconst _hoisted_9 = {\n  class: \"card-body\"\n};\nconst _hoisted_10 = {\n  class: \"row\"\n};\nconst _hoisted_11 = {\n  class: \"col-md-6\"\n};\nconst _hoisted_12 = {\n  class: \"col-md-6\"\n};\nconst _hoisted_13 = {\n  class: \"row\"\n};\nconst _hoisted_14 = {\n  class: \"col-12\"\n};\nconst _hoisted_15 = {\n  key: 0,\n  class: \"text-center py-4\"\n};\nconst _hoisted_16 = {\n  class: \"alert alert-danger\"\n};\nconst _hoisted_17 = {\n  class: \"row\"\n};\nconst _hoisted_18 = {\n  class: \"card h-100 document-card\"\n};\nconst _hoisted_19 = [\"onClick\"];\nconst _hoisted_20 = [\"src\", \"alt\"];\nconst _hoisted_21 = {\n  key: 1,\n  class: \"loading-preview\"\n};\nconst _hoisted_22 = {\n  key: 2,\n  class: \"file-icon-preview\"\n};\nconst _hoisted_23 = {\n  class: \"card-header d-flex justify-content-between align-items-center\"\n};\nconst _hoisted_24 = {\n  class: \"mb-0\"\n};\nconst _hoisted_25 = {\n  class: \"card-body\"\n};\nconst _hoisted_26 = {\n  class: \"card-text\"\n};\nconst _hoisted_27 = {\n  class: \"d-grid\"\n};\nconst _hoisted_28 = [\"onClick\"];\nconst _hoisted_29 = {\n  class: \"modal-footer\"\n};\nconst _hoisted_30 = {\n  key: 0,\n  class: \"ms-auto\"\n};\nconst _hoisted_31 = [\"disabled\"];\nconst _hoisted_32 = [\"disabled\"];\nconst _hoisted_33 = {\n  key: 0,\n  class: \"spinner-border spinner-border-sm me-1\",\n  role: \"status\"\n};\nconst _hoisted_34 = {\n  key: 1,\n  class: \"fas fa-check me-1\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_DocumentViewer = _resolveComponent(\"DocumentViewer\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"div\", _hoisted_3, [_cache[25] || (_cache[25] = _createElementVNode(\"div\", {\n    class: \"modal-header\"\n  }, [_createElementVNode(\"h5\", {\n    class: \"modal-title\",\n    id: \"residencyDocumentsModalLabel\"\n  }, [_createElementVNode(\"i\", {\n    class: \"fas fa-file-image me-2\"\n  }), _createTextVNode(\" Residency Documents Review \")]), _createElementVNode(\"button\", {\n    type: \"button\",\n    class: \"btn-close\",\n    \"data-bs-dismiss\": \"modal\",\n    \"aria-label\": \"Close\"\n  })], -1 /* HOISTED */)), _createElementVNode(\"div\", _hoisted_4, [$props.user ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [_createCommentVNode(\" User Information \"), _createElementVNode(\"div\", _hoisted_6, [_createElementVNode(\"div\", _hoisted_7, [_createElementVNode(\"div\", _hoisted_8, [_createElementVNode(\"div\", _hoisted_9, [_cache[8] || (_cache[8] = _createElementVNode(\"h6\", {\n    class: \"card-title mb-3\"\n  }, [_createElementVNode(\"i\", {\n    class: \"fas fa-user me-2\"\n  }), _createTextVNode(\" User Information \")], -1 /* HOISTED */)), _createElementVNode(\"div\", _hoisted_10, [_createElementVNode(\"div\", _hoisted_11, [_createElementVNode(\"p\", null, [_cache[3] || (_cache[3] = _createElementVNode(\"strong\", null, \"Name:\", -1 /* HOISTED */)), _createTextVNode(\" \" + _toDisplayString($props.user.full_name), 1 /* TEXT */)]), _createElementVNode(\"p\", null, [_cache[4] || (_cache[4] = _createElementVNode(\"strong\", null, \"Username:\", -1 /* HOISTED */)), _createTextVNode(\" \" + _toDisplayString($props.user.username), 1 /* TEXT */)]), _createElementVNode(\"p\", null, [_cache[5] || (_cache[5] = _createElementVNode(\"strong\", null, \"Email:\", -1 /* HOISTED */)), _createTextVNode(\" \" + _toDisplayString($props.user.email), 1 /* TEXT */)])]), _createElementVNode(\"div\", _hoisted_12, [_createElementVNode(\"p\", null, [_cache[6] || (_cache[6] = _createElementVNode(\"strong\", null, \"Status:\", -1 /* HOISTED */)), _createElementVNode(\"span\", {\n    class: _normalizeClass([\"badge\", $options.getStatusBadgeClass($props.user.status)])\n  }, _toDisplayString($options.formatStatus($props.user.status)), 3 /* TEXT, CLASS */)]), _createElementVNode(\"p\", null, [_cache[7] || (_cache[7] = _createElementVNode(\"strong\", null, \"Registration Date:\", -1 /* HOISTED */)), _createTextVNode(\" \" + _toDisplayString($options.formatDate($props.user.created_at)), 1 /* TEXT */)])])])])])])]), _createCommentVNode(\" Documents Section \"), _createElementVNode(\"div\", _hoisted_13, [_createElementVNode(\"div\", _hoisted_14, [_cache[20] || (_cache[20] = _createElementVNode(\"h6\", {\n    class: \"mb-3\"\n  }, [_createElementVNode(\"i\", {\n    class: \"fas fa-folder-open me-2\"\n  }), _createTextVNode(\" Uploaded Documents \")], -1 /* HOISTED */)), _createCommentVNode(\" Loading State \"), $data.loading ? (_openBlock(), _createElementBlock(\"div\", _hoisted_15, _cache[9] || (_cache[9] = [_createElementVNode(\"div\", {\n    class: \"spinner-border text-primary\",\n    role: \"status\"\n  }, [_createElementVNode(\"span\", {\n    class: \"visually-hidden\"\n  }, \"Loading documents...\")], -1 /* HOISTED */), _createElementVNode(\"p\", {\n    class: \"mt-2\"\n  }, \"Loading documents...\", -1 /* HOISTED */)]))) : $data.error ? (_openBlock(), _createElementBlock(_Fragment, {\n    key: 1\n  }, [_createCommentVNode(\" Error State \"), _createElementVNode(\"div\", _hoisted_16, [_cache[10] || (_cache[10] = _createElementVNode(\"i\", {\n    class: \"fas fa-exclamation-triangle me-2\"\n  }, null, -1 /* HOISTED */)), _createTextVNode(\" \" + _toDisplayString($data.error), 1 /* TEXT */)])], 2112 /* STABLE_FRAGMENT, DEV_ROOT_FRAGMENT */)) : !$data.documents || $data.documents.length === 0 ? (_openBlock(), _createElementBlock(_Fragment, {\n    key: 2\n  }, [_createCommentVNode(\" No Documents \"), _cache[11] || (_cache[11] = _createElementVNode(\"div\", {\n    class: \"text-center py-4\"\n  }, [_createElementVNode(\"i\", {\n    class: \"fas fa-file-slash fa-3x text-muted mb-3\"\n  }), _createElementVNode(\"p\", {\n    class: \"text-muted\"\n  }, \"No residency documents found for this user.\")], -1 /* HOISTED */))], 2112 /* STABLE_FRAGMENT, DEV_ROOT_FRAGMENT */)) : (_openBlock(), _createElementBlock(_Fragment, {\n    key: 3\n  }, [_createCommentVNode(\" Documents Grid \"), _createElementVNode(\"div\", _hoisted_17, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.documents, document => {\n    return _openBlock(), _createElementBlock(\"div\", {\n      key: document.id,\n      class: \"col-md-6 col-lg-4 mb-3\"\n    }, [_createElementVNode(\"div\", _hoisted_18, [_createCommentVNode(\" Document Preview \"), _createElementVNode(\"div\", {\n      class: \"card-img-top document-preview\",\n      onClick: $event => $options.viewDocument(document)\n    }, [$options.isImageDocument(document) && $data.documentBlobUrls[document.id] ? (_openBlock(), _createElementBlock(\"img\", {\n      key: 0,\n      src: $data.documentBlobUrls[document.id],\n      alt: document.document_name,\n      class: \"preview-image\",\n      onError: _cache[0] || (_cache[0] = (...args) => $options.handleImageError && $options.handleImageError(...args))\n    }, null, 40 /* PROPS, NEED_HYDRATION */, _hoisted_20)) : $options.isImageDocument(document) ? (_openBlock(), _createElementBlock(\"div\", _hoisted_21, [...(_cache[12] || (_cache[12] = [_createElementVNode(\"div\", {\n      class: \"spinner-border spinner-border-sm\",\n      role: \"status\"\n    }, [_createElementVNode(\"span\", {\n      class: \"sr-only\"\n    }, \"Loading...\")], -1 /* HOISTED */)]))])) : (_openBlock(), _createElementBlock(\"div\", _hoisted_22, [_createElementVNode(\"i\", {\n      class: _normalizeClass([$options.getDocumentIcon(document.document_type), \"fa-3x\"])\n    }, null, 2 /* CLASS */)])), _cache[13] || (_cache[13] = _createElementVNode(\"div\", {\n      class: \"preview-overlay\"\n    }, [_createElementVNode(\"i\", {\n      class: \"fas fa-eye fa-2x\"\n    })], -1 /* HOISTED */))], 8 /* PROPS */, _hoisted_19), _createElementVNode(\"div\", _hoisted_23, [_createElementVNode(\"h6\", _hoisted_24, _toDisplayString($options.formatDocumentType(document.document_type)), 1 /* TEXT */), _createElementVNode(\"span\", {\n      class: _normalizeClass([\"badge\", $options.getDocumentStatusBadgeClass(document.verification_status)])\n    }, _toDisplayString($options.formatDocumentStatus(document.verification_status)), 3 /* TEXT, CLASS */)]), _createElementVNode(\"div\", _hoisted_25, [_createElementVNode(\"p\", _hoisted_26, [_cache[14] || (_cache[14] = _createElementVNode(\"strong\", null, \"File:\", -1 /* HOISTED */)), _createTextVNode(\" \" + _toDisplayString(document.document_name), 1 /* TEXT */), _cache[15] || (_cache[15] = _createElementVNode(\"br\", null, null, -1 /* HOISTED */)), _cache[16] || (_cache[16] = _createElementVNode(\"strong\", null, \"Size:\", -1 /* HOISTED */)), _createTextVNode(\" \" + _toDisplayString($options.formatFileSize(document.file_size)), 1 /* TEXT */), _cache[17] || (_cache[17] = _createElementVNode(\"br\", null, null, -1 /* HOISTED */)), _cache[18] || (_cache[18] = _createElementVNode(\"strong\", null, \"Uploaded:\", -1 /* HOISTED */)), _createTextVNode(\" \" + _toDisplayString($options.formatDate(document.created_at)), 1 /* TEXT */)]), _createElementVNode(\"div\", _hoisted_27, [_createElementVNode(\"button\", {\n      class: \"btn btn-outline-primary btn-sm\",\n      onClick: $event => $options.viewDocument(document)\n    }, [...(_cache[19] || (_cache[19] = [_createElementVNode(\"i\", {\n      class: \"fas fa-eye me-1\"\n    }, null, -1 /* HOISTED */), _createTextVNode(\" View Document \")]))], 8 /* PROPS */, _hoisted_28)])])])]);\n  }), 128 /* KEYED_FRAGMENT */))])], 2112 /* STABLE_FRAGMENT, DEV_ROOT_FRAGMENT */))])])])) : _createCommentVNode(\"v-if\", true)]), _createElementVNode(\"div\", _hoisted_29, [_cache[24] || (_cache[24] = _createElementVNode(\"button\", {\n    type: \"button\",\n    class: \"btn btn-secondary\",\n    \"data-bs-dismiss\": \"modal\"\n  }, \"Close\", -1 /* HOISTED */)), _createCommentVNode(\" Show approve/reject buttons only if documents exist and are not all approved \"), $data.documents && $data.documents.length > 0 && !$options.allDocumentsApproved ? (_openBlock(), _createElementBlock(\"div\", _hoisted_30, [_createElementVNode(\"button\", {\n    type: \"button\",\n    class: \"btn btn-danger me-2\",\n    onClick: _cache[1] || (_cache[1] = $event => _ctx.$emit('reject')),\n    disabled: $props.processing\n  }, _cache[21] || (_cache[21] = [_createElementVNode(\"i\", {\n    class: \"fas fa-times me-1\"\n  }, null, -1 /* HOISTED */), _createTextVNode(\" Reject \")]), 8 /* PROPS */, _hoisted_31), _createElementVNode(\"button\", {\n    type: \"button\",\n    class: \"btn btn-success\",\n    onClick: _cache[2] || (_cache[2] = $event => _ctx.$emit('approve')),\n    disabled: $props.processing\n  }, [$props.processing ? (_openBlock(), _createElementBlock(\"span\", _hoisted_33)) : (_openBlock(), _createElementBlock(\"i\", _hoisted_34)), _cache[22] || (_cache[22] = _createTextVNode(\" Approve \"))], 8 /* PROPS */, _hoisted_32)])) : $options.allDocumentsApproved ? (_openBlock(), _createElementBlock(_Fragment, {\n    key: 1\n  }, [_createCommentVNode(\" Show status message when all documents are approved \"), _cache[23] || (_cache[23] = _createElementVNode(\"div\", {\n    class: \"ms-auto\"\n  }, [_createElementVNode(\"span\", {\n    class: \"badge bg-success fs-6\"\n  }, [_createElementVNode(\"i\", {\n    class: \"fas fa-check me-1\"\n  }), _createTextVNode(\" All Documents Approved \")])], -1 /* HOISTED */))], 2112 /* STABLE_FRAGMENT, DEV_ROOT_FRAGMENT */)) : _createCommentVNode(\"v-if\", true)])])]), _createCommentVNode(\" Document Viewer Component \"), $data.selectedDocument ? (_openBlock(), _createBlock(_component_DocumentViewer, {\n    key: 0,\n    document: $data.selectedDocument,\n    onClose: $options.closeDocumentViewer\n  }, null, 8 /* PROPS */, [\"document\", \"onClose\"])) : _createCommentVNode(\"v-if\", true)]);\n}","map":{"version":3,"names":["class","id","tabindex","role","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","type","_hoisted_4","$props","user","_hoisted_5","_createCommentVNode","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_toDisplayString","full_name","username","email","_hoisted_12","_normalizeClass","$options","getStatusBadgeClass","status","formatStatus","formatDate","created_at","_hoisted_13","_hoisted_14","$data","loading","_hoisted_15","_cache","error","_Fragment","key","_hoisted_16","documents","length","_hoisted_17","_renderList","document","_hoisted_18","onClick","$event","viewDocument","isImageDocument","documentBlobUrls","src","alt","document_name","onError","args","handleImageError","_hoisted_21","_hoisted_22","getDocumentIcon","document_type","_hoisted_23","_hoisted_24","formatDocumentType","getDocumentStatusBadgeClass","verification_status","formatDocumentStatus","_hoisted_25","_hoisted_26","formatFileSize","file_size","_hoisted_27","_hoisted_29","allDocumentsApproved","_hoisted_30","_ctx","$emit","disabled","processing","_hoisted_33","_hoisted_34","selectedDocument","_createBlock","_component_DocumentViewer","onClose","closeDocumentViewer"],"sources":["D:\\brgy_docu_hub\\BOSFDR\\src\\components\\admin\\ResidencyDocumentsModal.vue"],"sourcesContent":["<template>\n  <div class=\"modal fade\" id=\"residencyDocumentsModal\" tabindex=\"-1\" aria-labelledby=\"residencyDocumentsModalLabel\" aria-hidden=\"true\">\n    <div class=\"modal-dialog modal-xl modal-dialog-scrollable\">\n      <div class=\"modal-content\">\n        <div class=\"modal-header\">\n          <h5 class=\"modal-title\" id=\"residencyDocumentsModalLabel\">\n            <i class=\"fas fa-file-image me-2\"></i>\n            Residency Documents Review\n          </h5>\n          <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\n        </div>\n        <div class=\"modal-body\">\n          <div v-if=\"user\">\n            <!-- User Information -->\n            <div class=\"row mb-4\">\n              <div class=\"col-12\">\n                <div class=\"card bg-light\">\n                  <div class=\"card-body\">\n                    <h6 class=\"card-title mb-3\">\n                      <i class=\"fas fa-user me-2\"></i>\n                      User Information\n                    </h6>\n                    <div class=\"row\">\n                      <div class=\"col-md-6\">\n                        <p><strong>Name:</strong> {{ user.full_name }}</p>\n                        <p><strong>Username:</strong> {{ user.username }}</p>\n                        <p><strong>Email:</strong> {{ user.email }}</p>\n                      </div>\n                      <div class=\"col-md-6\">\n                        <p><strong>Status:</strong>\n                          <span class=\"badge\" :class=\"getStatusBadgeClass(user.status)\">\n                            {{ formatStatus(user.status) }}\n                          </span>\n                        </p>\n                        <p><strong>Registration Date:</strong> {{ formatDate(user.created_at) }}</p>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            <!-- Documents Section -->\n            <div class=\"row\">\n              <div class=\"col-12\">\n                <h6 class=\"mb-3\">\n                  <i class=\"fas fa-folder-open me-2\"></i>\n                  Uploaded Documents\n                </h6>\n\n                <!-- Loading State -->\n                <div v-if=\"loading\" class=\"text-center py-4\">\n                  <div class=\"spinner-border text-primary\" role=\"status\">\n                    <span class=\"visually-hidden\">Loading documents...</span>\n                  </div>\n                  <p class=\"mt-2\">Loading documents...</p>\n                </div>\n\n                <!-- Error State -->\n                <div v-else-if=\"error\" class=\"alert alert-danger\">\n                  <i class=\"fas fa-exclamation-triangle me-2\"></i>\n                  {{ error }}\n                </div>\n\n                <!-- No Documents -->\n                <div v-else-if=\"!documents || documents.length === 0\" class=\"text-center py-4\">\n                  <i class=\"fas fa-file-slash fa-3x text-muted mb-3\"></i>\n                  <p class=\"text-muted\">No residency documents found for this user.</p>\n                </div>\n\n                <!-- Documents Grid -->\n                <div v-else class=\"row\">\n                  <div v-for=\"document in documents\" :key=\"document.id\" class=\"col-md-6 col-lg-4 mb-3\">\n                    <div class=\"card h-100 document-card\">\n                      <!-- Document Preview -->\n                      <div class=\"card-img-top document-preview\" @click=\"viewDocument(document)\">\n                        <img\n                          v-if=\"isImageDocument(document) && documentBlobUrls[document.id]\"\n                          :src=\"documentBlobUrls[document.id]\"\n                          :alt=\"document.document_name\"\n                          class=\"preview-image\"\n                          @error=\"handleImageError\"\n                        />\n                        <div v-else-if=\"isImageDocument(document)\" class=\"loading-preview\">\n                          <div class=\"spinner-border spinner-border-sm\" role=\"status\">\n                            <span class=\"sr-only\">Loading...</span>\n                          </div>\n                        </div>\n                        <div v-else class=\"file-icon-preview\">\n                          <i :class=\"getDocumentIcon(document.document_type)\" class=\"fa-3x\"></i>\n                        </div>\n                        <div class=\"preview-overlay\">\n                          <i class=\"fas fa-eye fa-2x\"></i>\n                        </div>\n                      </div>\n                      \n                      <div class=\"card-header d-flex justify-content-between align-items-center\">\n                        <h6 class=\"mb-0\">{{ formatDocumentType(document.document_type) }}</h6>\n                        <span class=\"badge\" :class=\"getDocumentStatusBadgeClass(document.verification_status)\">\n                          {{ formatDocumentStatus(document.verification_status) }}\n                        </span>\n                      </div>\n                      <div class=\"card-body\">\n                        <p class=\"card-text\">\n                          <strong>File:</strong> {{ document.document_name }}<br>\n                          <strong>Size:</strong> {{ formatFileSize(document.file_size) }}<br>\n                          <strong>Uploaded:</strong> {{ formatDate(document.created_at) }}\n                        </p>\n                        <div class=\"d-grid\">\n                          <button class=\"btn btn-outline-primary btn-sm\" @click=\"viewDocument(document)\">\n                            <i class=\"fas fa-eye me-1\"></i>\n                            View Document\n                          </button>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n        <div class=\"modal-footer\">\n          <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Close</button>\n          <!-- Show approve/reject buttons only if documents exist and are not all approved -->\n          <div v-if=\"documents && documents.length > 0 && !allDocumentsApproved\" class=\"ms-auto\">\n            <button\n              type=\"button\"\n              class=\"btn btn-danger me-2\"\n              @click=\"$emit('reject')\"\n              :disabled=\"processing\"\n            >\n              <i class=\"fas fa-times me-1\"></i>\n              Reject\n            </button>\n            <button\n              type=\"button\"\n              class=\"btn btn-success\"\n              @click=\"$emit('approve')\"\n              :disabled=\"processing\"\n            >\n              <span v-if=\"processing\" class=\"spinner-border spinner-border-sm me-1\" role=\"status\"></span>\n              <i v-else class=\"fas fa-check me-1\"></i>\n              Approve\n            </button>\n          </div>\n          <!-- Show status message when all documents are approved -->\n          <div v-else-if=\"allDocumentsApproved\" class=\"ms-auto\">\n            <span class=\"badge bg-success fs-6\">\n              <i class=\"fas fa-check me-1\"></i>\n              All Documents Approved\n            </span>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- Document Viewer Component -->\n    <DocumentViewer \n      v-if=\"selectedDocument\" \n      :document=\"selectedDocument\" \n      @close=\"closeDocumentViewer\"\n    />\n  </div>\n</template>\n\n<script>\nimport DocumentViewer from './DocumentViewer.vue';\nimport residencyService from '@/services/residencyService';\nimport api from '@/services/api';\n\nexport default {\n  name: 'ResidencyDocumentsModal',\n  components: {\n    DocumentViewer\n  },\n  props: {\n    user: {\n      type: Object,\n      default: null\n    },\n    processing: {\n      type: Boolean,\n      default: false\n    }\n  },\n  data() {\n    return {\n      documents: [],\n      loading: false,\n      error: null,\n      selectedDocument: null,\n      documentBlobUrls: {}, // Store blob URLs for thumbnails\n      isDestroyed: false // Track component lifecycle\n    };\n  },\n  watch: {\n    user: {\n      handler(newUser) {\n        if (newUser) {\n          this.loadDocuments();\n        }\n      },\n      immediate: true\n    }\n  },\n  computed: {\n    // Check if all documents are already approved\n    allDocumentsApproved() {\n      if (!this.documents || this.documents.length === 0) return false;\n      // Check if all documents are approved OR if user's residency verification status is approved\n      return this.documents.every(doc => doc.verification_status === 'approved') ||\n             this.user?.residency_verification_status === 'approved';\n    }\n  },\n  beforeUnmount() {\n    // Mark component as destroyed\n    this.isDestroyed = true;\n\n    // Clean up blob URLs to prevent memory leaks\n    Object.values(this.documentBlobUrls).forEach(url => {\n      URL.revokeObjectURL(url);\n    });\n  },\n  methods: {\n    async loadDocuments() {\n      if (!this.user || this.isDestroyed) return;\n\n      this.loading = true;\n      this.error = null;\n      this.documents = [];\n\n      try {\n        // Use the actual account ID, not the composite ID\n        const accountId = this.user.original_id || this.user.id;\n\n        // Extract numeric ID if it's in format like 'client_32'\n        const numericId = typeof accountId === 'string' && accountId.includes('_')\n          ? accountId.split('_')[1]\n          : accountId;\n\n        const response = await residencyService.getAccountDocuments(numericId);\n\n        // Check if component is still mounted before updating state\n        if (this.isDestroyed) return;\n\n        if (response.success) {\n          this.documents = response.data || [];\n          // Load blob URLs for image documents\n          await this.loadDocumentThumbnails();\n        } else {\n          throw new Error(response.message || 'Failed to load documents');\n        }\n      } catch (error) {\n        console.error('Failed to load residency documents:', error);\n\n        // Check if component is still mounted before updating state\n        if (!this.isDestroyed) {\n          this.error = error.message || 'Failed to load documents';\n        }\n      } finally {\n        // Check if component is still mounted before updating state\n        if (!this.isDestroyed) {\n          this.loading = false;\n        }\n      }\n    },\n\n    viewDocument(document) {\n      this.selectedDocument = document;\n    },\n\n    closeDocumentViewer() {\n      this.selectedDocument = null;\n    },\n\n    async loadDocumentThumbnails() {\n      // Load blob URLs for image documents\n      for (const document of this.documents) {\n        // Check if component is still mounted\n        if (this.isDestroyed) return;\n\n        if (this.isImageDocument(document)) {\n          try {\n            const response = await api.get(`/residency/documents/${document.id}/file`, {\n              responseType: 'blob'\n            });\n\n            // Check if component is still mounted before updating state\n            if (!this.isDestroyed) {\n              const blob = new Blob([response.data], { type: document.mime_type });\n              this.documentBlobUrls[document.id] = URL.createObjectURL(blob);\n            }\n          } catch (error) {\n            console.error(`Failed to load thumbnail for document ${document.id}:`, error);\n            // Don't set a blob URL, the template will show loading spinner\n          }\n        }\n      }\n    },\n\n    isImageDocument(document) {\n      const imageTypes = ['image/jpeg', 'image/jpg', 'image/png', 'image/gif', 'image/webp'];\n      return imageTypes.includes(document.mime_type?.toLowerCase());\n    },\n\n    getDocumentPreviewUrl(documentId) {\n      return residencyService.getDocumentFileUrl(documentId);\n    },\n\n    handleImageError(event) {\n      console.error('Image failed to load:', event.target.src);\n      // You could set a placeholder image here\n      event.target.style.display = 'none';\n    },\n\n    getDocumentIcon(type) {\n      const iconMap = {\n        'utility_bill': 'fas fa-file-invoice text-warning',\n        'barangay_certificate': 'fas fa-certificate text-success',\n        'valid_id': 'fas fa-id-card text-info',\n        'lease_contract': 'fas fa-file-contract text-primary',\n        'other': 'fas fa-file text-secondary'\n      };\n      return iconMap[type] || 'fas fa-file text-secondary';\n    },\n\n    formatDocumentType(type) {\n      return residencyService.formatDocumentType(type);\n    },\n\n    formatDocumentStatus(status) {\n      return residencyService.formatVerificationStatus(status);\n    },\n\n    getDocumentStatusBadgeClass(status) {\n      return residencyService.getStatusBadgeClass(status);\n    },\n\n    getStatusBadgeClass(status) {\n      const classes = {\n        'active': 'bg-success',\n        'inactive': 'bg-secondary',\n        'pending': 'bg-warning',\n        'suspended': 'bg-danger',\n        'pending_verification': 'bg-warning',\n        'pending_residency_verification': 'bg-info',\n        'residency_rejected': 'bg-danger',\n        'residency_approved': 'bg-success',\n        'no_residency_documents': 'bg-warning'\n      };\n      return classes[status] || 'bg-secondary';\n    },\n\n    formatStatus(status) {\n      return status?.replace(/_/g, ' ').replace(/\\b\\w/g, l => l.toUpperCase()) || 'Unknown';\n    },\n\n    formatDate(dateString) {\n      return new Date(dateString).toLocaleDateString('en-US', {\n        year: 'numeric',\n        month: 'short',\n        day: 'numeric',\n        hour: '2-digit',\n        minute: '2-digit'\n      });\n    },\n\n    formatFileSize(bytes) {\n      if (!bytes) return 'Unknown size';\n      const sizes = ['Bytes', 'KB', 'MB', 'GB'];\n      const i = Math.floor(Math.log(bytes) / Math.log(1024));\n      return Math.round(bytes / Math.pow(1024, i) * 100) / 100 + ' ' + sizes[i];\n    }\n  }\n};\n</script>\n\n<style scoped>\n.document-card {\n  transition: transform 0.2s ease, box-shadow 0.2s ease;\n  cursor: pointer;\n}\n\n.document-card:hover {\n  transform: translateY(-2px);\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n}\n\n.document-preview {\n  position: relative;\n  height: 200px;\n  overflow: hidden;\n  background: #f8f9fa;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.preview-image {\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n  transition: transform 0.2s ease;\n}\n\n.file-icon-preview {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  height: 100%;\n  color: #6c757d;\n}\n\n.preview-overlay {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0.7);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: white;\n  opacity: 0;\n  transition: opacity 0.2s ease;\n}\n\n.document-preview:hover .preview-overlay {\n  opacity: 1;\n}\n\n.document-preview:hover .preview-image {\n  transform: scale(1.05);\n}\n\n.loading-preview {\n  height: 200px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background-color: #f8f9fa;\n  border-radius: 8px;\n}\n</style>\n"],"mappings":";;EACOA,KAAK,EAAC,YAAY;EAACC,EAAE,EAAC,yBAAyB;EAACC,QAAQ,EAAC,IAAI;EAAC,iBAAe,EAAC,8BAA8B;EAAC,aAAW,EAAC;;;EACvHF,KAAK,EAAC;AAA+C;;EACnDA,KAAK,EAAC;AAAe;;EAQnBA,KAAK,EAAC;AAAY;;;;;EAGdA,KAAK,EAAC;AAAU;;EACdA,KAAK,EAAC;AAAQ;;EACZA,KAAK,EAAC;AAAe;;EACnBA,KAAK,EAAC;AAAW;;EAKfA,KAAK,EAAC;AAAK;;EACTA,KAAK,EAAC;AAAU;;EAKhBA,KAAK,EAAC;AAAU;;EAe1BA,KAAK,EAAC;AAAK;;EACTA,KAAK,EAAC;AAAQ;;;EAOGA,KAAK,EAAC;;;EAQHA,KAAK,EAAC;AAAoB;;EAYrCA,KAAK,EAAC;AAAK;;EAEdA,KAAK,EAAC;AAA0B;;;;;EAUUA,KAAK,EAAC;;;;EAKrCA,KAAK,EAAC;;;EAQfA,KAAK,EAAC;AAA+D;;EACpEA,KAAK,EAAC;AAAM;;EAKbA,KAAK,EAAC;AAAW;;EACjBA,KAAK,EAAC;AAAW;;EAKfA,KAAK,EAAC;AAAQ;;;EAc9BA,KAAK,EAAC;AAAc;;;EAGgDA,KAAK,EAAC;;;;;;EAgBjDA,KAAK,EAAC,uCAAuC;EAACG,IAAI,EAAC;;;;EACjEH,KAAK,EAAC;;;;uBA7I5BI,mBAAA,CAkKM,OAlKNC,UAkKM,GAjKJC,mBAAA,CAyJM,OAzJNC,UAyJM,GAxJJD,mBAAA,CAuJM,OAvJNE,UAuJM,G,4BAtJJF,mBAAA,CAMM;IANDN,KAAK,EAAC;EAAc,IACvBM,mBAAA,CAGK;IAHDN,KAAK,EAAC,aAAa;IAACC,EAAE,EAAC;MACzBK,mBAAA,CAAsC;IAAnCN,KAAK,EAAC;EAAwB,I,iBAAK,8BAExC,E,GACAM,mBAAA,CAA4F;IAApFG,IAAI,EAAC,QAAQ;IAACT,KAAK,EAAC,WAAW;IAAC,iBAAe,EAAC,OAAO;IAAC,YAAU,EAAC;2BAE7EM,mBAAA,CA8GM,OA9GNI,UA8GM,GA7GOC,MAAA,CAAAC,IAAI,I,cAAfR,mBAAA,CA4GM,OAAAS,UAAA,GA3GJC,mBAAA,sBAAyB,EACzBR,mBAAA,CA0BM,OA1BNS,UA0BM,GAzBJT,mBAAA,CAwBM,OAxBNU,UAwBM,GAvBJV,mBAAA,CAsBM,OAtBNW,UAsBM,GArBJX,mBAAA,CAoBM,OApBNY,UAoBM,G,0BAnBJZ,mBAAA,CAGK;IAHDN,KAAK,EAAC;EAAiB,IACzBM,mBAAA,CAAgC;IAA7BN,KAAK,EAAC;EAAkB,I,iBAAK,oBAElC,E,sBACAM,mBAAA,CAcM,OAdNa,WAcM,GAbJb,mBAAA,CAIM,OAJNc,WAIM,GAHJd,mBAAA,CAAkD,Y,0BAA/CA,mBAAA,CAAsB,gBAAd,OAAK,sB,iBAAS,GAAC,GAAAe,gBAAA,CAAGV,MAAA,CAAAC,IAAI,CAACU,SAAS,iB,GAC3ChB,mBAAA,CAAqD,Y,0BAAlDA,mBAAA,CAA0B,gBAAlB,WAAS,sB,iBAAS,GAAC,GAAAe,gBAAA,CAAGV,MAAA,CAAAC,IAAI,CAACW,QAAQ,iB,GAC9CjB,mBAAA,CAA+C,Y,0BAA5CA,mBAAA,CAAuB,gBAAf,QAAM,sB,iBAAS,GAAC,GAAAe,gBAAA,CAAGV,MAAA,CAAAC,IAAI,CAACY,KAAK,iB,KAE1ClB,mBAAA,CAOM,OAPNmB,WAOM,GANJnB,mBAAA,CAII,Y,0BAJDA,mBAAA,CAAwB,gBAAhB,SAAO,sBAChBA,mBAAA,CAEO;IAFDN,KAAK,EAAA0B,eAAA,EAAC,OAAO,EAASC,QAAA,CAAAC,mBAAmB,CAACjB,MAAA,CAAAC,IAAI,CAACiB,MAAM;sBACtDF,QAAA,CAAAG,YAAY,CAACnB,MAAA,CAAAC,IAAI,CAACiB,MAAM,yB,GAG/BvB,mBAAA,CAA4E,Y,0BAAzEA,mBAAA,CAAmC,gBAA3B,oBAAkB,sB,iBAAS,GAAC,GAAAe,gBAAA,CAAGM,QAAA,CAAAI,UAAU,CAACpB,MAAA,CAAAC,IAAI,CAACoB,UAAU,kB,eAQhFlB,mBAAA,uBAA0B,EAC1BR,mBAAA,CA4EM,OA5EN2B,WA4EM,GA3EJ3B,mBAAA,CA0EM,OA1EN4B,WA0EM,G,4BAzEJ5B,mBAAA,CAGK;IAHDN,KAAK,EAAC;EAAM,IACdM,mBAAA,CAAuC;IAApCN,KAAK,EAAC;EAAyB,I,iBAAK,sBAEzC,E,sBAEAc,mBAAA,mBAAsB,EACXqB,KAAA,CAAAC,OAAO,I,cAAlBhC,mBAAA,CAKM,OALNiC,WAKM,EAAAC,MAAA,QAAAA,MAAA,OAJJhC,mBAAA,CAEM;IAFDN,KAAK,EAAC,6BAA6B;IAACG,IAAI,EAAC;MAC5CG,mBAAA,CAAyD;IAAnDN,KAAK,EAAC;EAAiB,GAAC,sBAAoB,E,qBAEpDM,mBAAA,CAAwC;IAArCN,KAAK,EAAC;EAAM,GAAC,sBAAoB,oB,MAItBmC,KAAA,CAAAI,KAAK,I,cAArBnC,mBAAA,CAGMoC,SAAA;IAAAC,GAAA;EAAA,IAJN3B,mBAAA,iBAAoB,EACpBR,mBAAA,CAGM,OAHNoC,WAGM,G,4BAFJpC,mBAAA,CAAgD;IAA7CN,KAAK,EAAC;EAAkC,6B,iBAAK,GAChD,GAAAqB,gBAAA,CAAGc,KAAA,CAAAI,KAAK,iB,uDAIOJ,KAAA,CAAAQ,SAAS,IAAIR,KAAA,CAAAQ,SAAS,CAACC,MAAM,U,cAA9CxC,mBAAA,CAGMoC,SAAA;IAAAC,GAAA;EAAA,IAJN3B,mBAAA,kBAAqB,E,4BACrBR,mBAAA,CAGM;IAHgDN,KAAK,EAAC;EAAkB,IAC5EM,mBAAA,CAAuD;IAApDN,KAAK,EAAC;EAAyC,IAClDM,mBAAA,CAAqE;IAAlEN,KAAK,EAAC;EAAY,GAAC,6CAA2C,E,wFAInEI,mBAAA,CA8CMoC,SAAA;IAAAC,GAAA;EAAA,IA/CN3B,mBAAA,oBAAuB,EACvBR,mBAAA,CA8CM,OA9CNuC,WA8CM,I,kBA7CJzC,mBAAA,CA4CMoC,SAAA,QAAAM,WAAA,CA5CkBX,KAAA,CAAAQ,SAAS,EAArBI,QAAQ;yBAApB3C,mBAAA,CA4CM;MA5C8BqC,GAAG,EAAEM,QAAQ,CAAC9C,EAAE;MAAED,KAAK,EAAC;QAC1DM,mBAAA,CA0CM,OA1CN0C,WA0CM,GAzCJlC,mBAAA,sBAAyB,EACzBR,mBAAA,CAmBM;MAnBDN,KAAK,EAAC,+BAA+B;MAAEiD,OAAK,EAAAC,MAAA,IAAEvB,QAAA,CAAAwB,YAAY,CAACJ,QAAQ;QAE9DpB,QAAA,CAAAyB,eAAe,CAACL,QAAQ,KAAKZ,KAAA,CAAAkB,gBAAgB,CAACN,QAAQ,CAAC9C,EAAE,K,cADjEG,mBAAA,CAME;;MAJCkD,GAAG,EAAEnB,KAAA,CAAAkB,gBAAgB,CAACN,QAAQ,CAAC9C,EAAE;MACjCsD,GAAG,EAAER,QAAQ,CAACS,aAAa;MAC5BxD,KAAK,EAAC,eAAe;MACpByD,OAAK,EAAAnB,MAAA,QAAAA,MAAA,UAAAoB,IAAA,KAAE/B,QAAA,CAAAgC,gBAAA,IAAAhC,QAAA,CAAAgC,gBAAA,IAAAD,IAAA,CAAgB;6DAEV/B,QAAA,CAAAyB,eAAe,CAACL,QAAQ,K,cAAxC3C,mBAAA,CAIM,OAJNwD,WAIM,OAAAtB,MAAA,SAAAA,MAAA,QAHJhC,mBAAA,CAEM;MAFDN,KAAK,EAAC,kCAAkC;MAACG,IAAI,EAAC;QACjDG,mBAAA,CAAuC;MAAjCN,KAAK,EAAC;IAAS,GAAC,YAAU,E,2CAGpCI,mBAAA,CAEM,OAFNyD,WAEM,GADJvD,mBAAA,CAAsE;MAAlEN,KAAK,EAAA0B,eAAA,EAAEC,QAAA,CAAAmC,eAAe,CAACf,QAAQ,CAACgB,aAAa,GAAS,OAAO;4DAEnEzD,mBAAA,CAEM;MAFDN,KAAK,EAAC;IAAiB,IAC1BM,mBAAA,CAAgC;MAA7BN,KAAK,EAAC;IAAkB,G,oDAI/BM,mBAAA,CAKM,OALN0D,WAKM,GAJJ1D,mBAAA,CAAsE,MAAtE2D,WAAsE,EAAA5C,gBAAA,CAAlDM,QAAA,CAAAuC,kBAAkB,CAACnB,QAAQ,CAACgB,aAAa,mBAC7DzD,mBAAA,CAEO;MAFDN,KAAK,EAAA0B,eAAA,EAAC,OAAO,EAASC,QAAA,CAAAwC,2BAA2B,CAACpB,QAAQ,CAACqB,mBAAmB;wBAC/EzC,QAAA,CAAA0C,oBAAoB,CAACtB,QAAQ,CAACqB,mBAAmB,yB,GAGxD9D,mBAAA,CAYM,OAZNgE,WAYM,GAXJhE,mBAAA,CAII,KAJJiE,WAII,G,4BAHFjE,mBAAA,CAAsB,gBAAd,OAAK,sB,iBAAS,GAAC,GAAAe,gBAAA,CAAG0B,QAAQ,CAACS,aAAa,kB,4BAAGlD,mBAAA,CAAI,sC,4BACvDA,mBAAA,CAAsB,gBAAd,OAAK,sB,iBAAS,GAAC,GAAAe,gBAAA,CAAGM,QAAA,CAAA6C,cAAc,CAACzB,QAAQ,CAAC0B,SAAS,mB,4BAAInE,mBAAA,CAAI,sC,4BACnEA,mBAAA,CAA0B,gBAAlB,WAAS,sB,iBAAS,GAAC,GAAAe,gBAAA,CAAGM,QAAA,CAAAI,UAAU,CAACgB,QAAQ,CAACf,UAAU,kB,GAE9D1B,mBAAA,CAKM,OALNoE,WAKM,GAJJpE,mBAAA,CAGS;MAHDN,KAAK,EAAC,gCAAgC;MAAEiD,OAAK,EAAAC,MAAA,IAAEvB,QAAA,CAAAwB,YAAY,CAACJ,QAAQ;yCAC1EzC,mBAAA,CAA+B;MAA5BN,KAAK,EAAC;IAAiB,4B,iBAAK,iBAEjC,E;mIAUlBM,mBAAA,CA+BM,OA/BNqE,WA+BM,G,4BA9BJrE,mBAAA,CAAsF;IAA9EG,IAAI,EAAC,QAAQ;IAACT,KAAK,EAAC,mBAAmB;IAAC,iBAAe,EAAC;KAAQ,OAAK,sBAC7Ec,mBAAA,kFAAqF,EAC1EqB,KAAA,CAAAQ,SAAS,IAAIR,KAAA,CAAAQ,SAAS,CAACC,MAAM,SAASjB,QAAA,CAAAiD,oBAAoB,I,cAArExE,mBAAA,CAoBM,OApBNyE,WAoBM,GAnBJvE,mBAAA,CAQS;IAPPG,IAAI,EAAC,QAAQ;IACbT,KAAK,EAAC,qBAAqB;IAC1BiD,OAAK,EAAAX,MAAA,QAAAA,MAAA,MAAAY,MAAA,IAAE4B,IAAA,CAAAC,KAAK;IACZC,QAAQ,EAAErE,MAAA,CAAAsE;kCAEX3E,mBAAA,CAAiC;IAA9BN,KAAK,EAAC;EAAmB,4B,iBAAK,UAEnC,E,gCACAM,mBAAA,CASS;IARPG,IAAI,EAAC,QAAQ;IACbT,KAAK,EAAC,iBAAiB;IACtBiD,OAAK,EAAAX,MAAA,QAAAA,MAAA,MAAAY,MAAA,IAAE4B,IAAA,CAAAC,KAAK;IACZC,QAAQ,EAAErE,MAAA,CAAAsE;MAECtE,MAAA,CAAAsE,UAAU,I,cAAtB7E,mBAAA,CAA2F,QAA3F8E,WAA2F,M,cAC3F9E,mBAAA,CAAwC,KAAxC+E,WAAwC,I,6CAAA,WAE1C,G,mCAGcxD,QAAA,CAAAiD,oBAAoB,I,cAApCxE,mBAAA,CAKMoC,SAAA;IAAAC,GAAA;EAAA,IANN3B,mBAAA,yDAA4D,E,4BAC5DR,mBAAA,CAKM;IALgCN,KAAK,EAAC;EAAS,IACnDM,mBAAA,CAGO;IAHDN,KAAK,EAAC;EAAuB,IACjCM,mBAAA,CAAiC;IAA9BN,KAAK,EAAC;EAAmB,I,iBAAK,0BAEnC,E,oHAMRc,mBAAA,+BAAkC,EAE1BqB,KAAA,CAAAiD,gBAAgB,I,cADxBC,YAAA,CAIEC,yBAAA;;IAFCvC,QAAQ,EAAEZ,KAAA,CAAAiD,gBAAgB;IAC1BG,OAAK,EAAE5D,QAAA,CAAA6D","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}