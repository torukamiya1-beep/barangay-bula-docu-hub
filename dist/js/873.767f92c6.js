"use strict";(self["webpackChunkbosfdr"]=self["webpackChunkbosfdr"]||[]).push([[873],{873:function(e,t,a){a.r(t),a.d(t,{default:function(){return Dt}});var i=a(6768),s=a(4232);const r={class:"request-details-page"},n={class:"page-header"},o={class:"header-content"},l={class:"header-actions"},c={class:"page-content"},u={key:0,class:"loading-container"},d={key:1,class:"error-container"},m={class:"error-content"},g={key:2,class:"request-container"},h={class:"request-overview"},p={class:"overview-header"},f={class:"request-type"},k={class:"request-id"},y={class:"request-status"},v={class:"overview-grid"},L={class:"overview-item"},_={class:"overview-item"},b={class:"overview-item"},q={class:"overview-item"},w={class:"amount"},I={class:"progress-timeline"},C={class:"timeline"},U={class:"timeline-icon"},E={class:"timeline-content"},P={key:0,class:"timeline-date"},D={key:0,class:"rejection-branch"},z={class:"timeline-item rejected active"},R={class:"timeline-content"},S={class:"timeline-date"},$={key:0,class:"rejection-reason"},N={class:"request-info-section"},x={class:"info-card"},A={class:"info-grid"},T={class:"info-item"},W={class:"info-item"},V={key:0,class:"info-item"},j={class:"info-item"},X={class:"info-item"},F={class:"info-item"},M={class:"info-item"},B={class:"info-item"},Q={key:0},O={class:"info-item"},Z={key:0},H={class:"info-item"},Y={key:1,class:"info-item"},G={key:0,class:"info-card"},K={class:"info-grid"},J={class:"info-item"},ee={class:"info-item"},te={class:"info-item"},ae={class:"info-item"},ie={class:"info-item"},se={class:"info-item"},re={class:"info-item"},ne={class:"info-item"},oe={class:"info-item"},le={key:0,class:"info-item"},ce={class:"verification-image-container"},ue=["src","alt"],de={key:1,class:"image-loading"},me={class:"info-card"},ge={class:"info-grid"},he={class:"info-item"},pe={key:0,class:"info-item"},fe={key:1,class:"info-item"},ke={class:"info-item"},ye={class:"info-item"},ve={key:0,class:"info-item"},Le={key:1,class:"info-card"},_e={class:"info-grid"},be={class:"info-item"},qe={key:0,class:"info-item"},we={class:"info-item"},Ie={key:2,class:"info-card"},Ce={class:"info-grid"},Ue={key:0,class:"info-item"},Ee={key:1,class:"info-item"},Pe={class:"info-item"},De={key:2,class:"info-item"},ze={key:0,class:"info-card"},Re={class:"info-grid"},Se={class:"info-item"},$e={class:"info-item"},Ne={class:"info-item"},xe={key:0,class:"info-item"},Ae={class:"verification-image-container"},Te=["src","alt"],We={key:1,class:"image-loading"},Ve={key:1,class:"info-item"},je={class:"verification-image-container"},Xe=["src"],Fe={key:1,class:"image-loading"},Me={class:"info-card"},Be={class:"info-grid"},Qe={class:"info-item"},Oe={class:"info-item"},Ze={class:"amount"},He={key:0,class:"info-item"},Ye={class:"request-actions"},Ge={key:3,class:"admin-notes"},Ke={class:"notes-content"},Je={class:"notes-date"};function et(e,t,a,et,tt,at){const it=(0,i.g2)("ImageViewer");return(0,i.uX)(),(0,i.CE)("div",r,[(0,i.Lk)("div",n,[(0,i.Lk)("div",o,[t[14]||(t[14]=(0,i.Lk)("div",{class:"header-main"},[(0,i.Lk)("h1",{class:"page-title"},[(0,i.Lk)("i",{class:"fas fa-file-alt"}),(0,i.eW)(" Request Details ")]),(0,i.Lk)("p",{class:"page-description"}," View detailed information about your document request ")],-1)),(0,i.Lk)("div",l,[(0,i.Lk)("button",{class:"back-btn",onClick:t[0]||(t[0]=(...e)=>at.goBack&&at.goBack(...e))},t[13]||(t[13]=[(0,i.Lk)("i",{class:"fas fa-arrow-left"},null,-1),(0,i.eW)(" Back to Requests ")]))])])]),(0,i.Lk)("div",c,[tt.loading?((0,i.uX)(),(0,i.CE)("div",u,t[15]||(t[15]=[(0,i.Lk)("div",{class:"loading-spinner"},[(0,i.Lk)("i",{class:"fas fa-spinner fa-spin"})],-1),(0,i.Lk)("p",null,"Loading request details...",-1)]))):tt.error?((0,i.uX)(),(0,i.CE)("div",d,[(0,i.Lk)("div",m,[t[17]||(t[17]=(0,i.Lk)("i",{class:"fas fa-exclamation-triangle"},null,-1)),t[18]||(t[18]=(0,i.Lk)("h3",null,"Unable to Load Request",-1)),(0,i.Lk)("p",null,(0,s.v_)(tt.error),1),(0,i.Lk)("button",{class:"retry-btn",onClick:t[1]||(t[1]=(...e)=>at.loadRequestDetails&&at.loadRequestDetails(...e))},t[16]||(t[16]=[(0,i.Lk)("i",{class:"fas fa-redo"},null,-1),(0,i.eW)(" Try Again ")]))])])):tt.request?((0,i.uX)(),(0,i.CE)("div",g,[(0,i.Lk)("div",h,[(0,i.Lk)("div",p,[(0,i.Lk)("div",f,[(0,i.Lk)("i",{class:(0,s.C4)(at.getDocumentIcon(tt.request.document_type))},null,2),(0,i.Lk)("div",null,[(0,i.Lk)("h2",null,(0,s.v_)(tt.request.document_type),1),(0,i.Lk)("p",k,"Request #"+(0,s.v_)(tt.request.id.toString().padStart(6,"0")),1)])]),(0,i.Lk)("div",y,[(0,i.Lk)("span",{class:(0,s.C4)(["status-badge",at.getStatusClass(tt.request.status)])},(0,s.v_)(at.formatStatus(tt.request.status)),3)])]),(0,i.Lk)("div",v,[(0,i.Lk)("div",L,[t[19]||(t[19]=(0,i.Lk)("label",null,"Submitted Date:",-1)),(0,i.Lk)("span",null,(0,s.v_)(at.formatDate(tt.request.created_at)),1)]),(0,i.Lk)("div",_,[t[20]||(t[20]=(0,i.Lk)("label",null,"Last Updated:",-1)),(0,i.Lk)("span",null,(0,s.v_)(at.formatDate(tt.request.updated_at)),1)]),(0,i.Lk)("div",b,[t[21]||(t[21]=(0,i.Lk)("label",null,"Purpose:",-1)),(0,i.Lk)("span",null,(0,s.v_)(tt.request.purpose_category||"Not specified"),1)]),(0,i.Lk)("div",q,[t[22]||(t[22]=(0,i.Lk)("label",null,"Total Fee:",-1)),(0,i.Lk)("span",w,"‚Ç±"+(0,s.v_)(at.formatCurrency(tt.request.total_fee)),1)])]),(0,i.Lk)("div",I,[t[29]||(t[29]=(0,i.Lk)("h3",null,"Request Progress",-1)),(0,i.Lk)("div",C,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(at.getMainTimelineSteps(),((e,t)=>((0,i.uX)(),(0,i.CE)("div",{key:t,class:(0,s.C4)(["timeline-item",{active:e.status===tt.request.status,completed:at.isStepCompleted(e.status,tt.request.status)}])},[(0,i.Lk)("div",U,[(0,i.Lk)("i",{class:(0,s.C4)(e.icon)},null,2)]),(0,i.Lk)("div",E,[(0,i.Lk)("h4",null,(0,s.v_)(e.title),1),(0,i.Lk)("p",null,(0,s.v_)(e.description),1),e.status===tt.request.status?((0,i.uX)(),(0,i.CE)("span",P,(0,s.v_)(at.formatDate(tt.request.updated_at)),1)):(0,i.Q3)("",!0)])],2)))),128))]),"rejected"===tt.request.status?((0,i.uX)(),(0,i.CE)("div",D,[t[28]||(t[28]=(0,i.Lk)("div",{class:"branch-connector"},null,-1)),(0,i.Lk)("div",z,[t[27]||(t[27]=(0,i.Lk)("div",{class:"timeline-icon"},[(0,i.Lk)("i",{class:"fas fa-times-circle"})],-1)),(0,i.Lk)("div",R,[t[25]||(t[25]=(0,i.Lk)("h4",null,"Request Rejected",-1)),t[26]||(t[26]=(0,i.Lk)("p",null,"Your request has been rejected by our staff",-1)),(0,i.Lk)("span",S,(0,s.v_)(at.formatDate(tt.request.updated_at)),1),tt.request.rejection_reason?((0,i.uX)(),(0,i.CE)("div",$,[t[23]||(t[23]=(0,i.Lk)("i",{class:"fas fa-info-circle"},null,-1)),t[24]||(t[24]=(0,i.Lk)("strong",null,"Reason:",-1)),(0,i.eW)(" "+(0,s.v_)(tt.request.rejection_reason),1)])):(0,i.Q3)("",!0)])])])):(0,i.Q3)("",!0)])]),(0,i.Lk)("div",N,[t[69]||(t[69]=(0,i.Lk)("h3",null,"Request Information",-1)),(0,i.Lk)("div",x,[t[41]||(t[41]=(0,i.Lk)("h4",null,[(0,i.Lk)("i",{class:"fas fa-user me-2"}),(0,i.eW)(" Requestor Information ")],-1)),(0,i.Lk)("div",A,[(0,i.Lk)("div",T,[t[30]||(t[30]=(0,i.Lk)("label",null,"Full Name:",-1)),(0,i.Lk)("span",null,(0,s.v_)(at.getFullName()),1)]),(0,i.Lk)("div",W,[t[31]||(t[31]=(0,i.Lk)("label",null,"Username:",-1)),(0,i.Lk)("span",null,(0,s.v_)(at.getClientUsername()||"Not provided"),1)]),at.getClientEmail()?((0,i.uX)(),(0,i.CE)("div",V,[t[32]||(t[32]=(0,i.Lk)("label",null,"Email:",-1)),(0,i.Lk)("span",null,(0,s.v_)(at.getClientEmail()),1)])):(0,i.Q3)("",!0),(0,i.Lk)("div",j,[t[33]||(t[33]=(0,i.Lk)("label",null,"Phone:",-1)),(0,i.Lk)("span",null,(0,s.v_)(at.getClientPhone()),1)]),(0,i.Lk)("div",X,[t[34]||(t[34]=(0,i.Lk)("label",null,"Date of Birth:",-1)),(0,i.Lk)("span",null,(0,s.v_)(at.formatDate(at.getClientBirthDate())||"Not provided"),1)]),(0,i.Lk)("div",F,[t[35]||(t[35]=(0,i.Lk)("label",null,"Gender:",-1)),(0,i.Lk)("span",null,(0,s.v_)(at.formatGender(at.getClientGender())||"Not provided"),1)]),(0,i.Lk)("div",M,[t[36]||(t[36]=(0,i.Lk)("label",null,"Civil Status:",-1)),(0,i.Lk)("span",null,(0,s.v_)(at.getCivilStatusName(at.getClientCivilStatus())||"Not provided"),1)]),(0,i.Lk)("div",B,[t[37]||(t[37]=(0,i.Lk)("label",null,"Nationality:",-1)),tt.request&&tt.request.requestor?((0,i.uX)(),(0,i.CE)("span",Q,(0,s.v_)(tt.request.requestor.nationality||"Not provided"),1)):(0,i.Q3)("",!0)]),(0,i.Lk)("div",O,[t[38]||(t[38]=(0,i.Lk)("label",null,"Address:",-1)),tt.request&&tt.request.requestor?((0,i.uX)(),(0,i.CE)("span",Z,(0,s.v_)(tt.request.requestor.address||"Not provided"),1)):(0,i.Q3)("",!0)]),(0,i.Lk)("div",H,[t[39]||(t[39]=(0,i.Lk)("label",null,"Years of Residency:",-1)),(0,i.Lk)("span",null,(0,s.v_)(at.getResidencyDisplay()||"Not provided"),1)]),at.getClientLastLogin()?((0,i.uX)(),(0,i.CE)("div",Y,[t[40]||(t[40]=(0,i.Lk)("label",null,"Last Login:",-1)),(0,i.Lk)("span",null,(0,s.v_)(at.formatDate(at.getClientLastLogin())),1)])):(0,i.Q3)("",!0)])]),tt.request.is_third_party_request&&tt.request.beneficiary?((0,i.uX)(),(0,i.CE)("div",G,[t[53]||(t[53]=(0,i.Lk)("h4",null,[(0,i.Lk)("i",{class:"fas fa-user-friends me-2"}),(0,i.eW)(" Beneficiary Information (For Someone Else) ")],-1)),(0,i.Lk)("div",K,[(0,i.Lk)("div",J,[t[42]||(t[42]=(0,i.Lk)("label",null,"Full Name:",-1)),(0,i.Lk)("span",null,(0,s.v_)(at.getBeneficiaryFullName()),1)]),(0,i.Lk)("div",ee,[t[43]||(t[43]=(0,i.Lk)("label",null,"Relationship to Requestor:",-1)),(0,i.Lk)("span",null,(0,s.v_)(tt.request.beneficiary.relationship_to_requestor||"Not specified"),1)]),(0,i.Lk)("div",te,[t[44]||(t[44]=(0,i.Lk)("label",null,"Email:",-1)),(0,i.Lk)("span",null,(0,s.v_)(tt.request.beneficiary.email||"Not provided"),1)]),(0,i.Lk)("div",ae,[t[45]||(t[45]=(0,i.Lk)("label",null,"Phone:",-1)),(0,i.Lk)("span",null,(0,s.v_)(tt.request.beneficiary.phone_number||"Not provided"),1)]),(0,i.Lk)("div",ie,[t[46]||(t[46]=(0,i.Lk)("label",null,"Date of Birth:",-1)),(0,i.Lk)("span",null,(0,s.v_)(at.formatDate(tt.request.beneficiary.birth_date)||"Not provided"),1)]),(0,i.Lk)("div",se,[t[47]||(t[47]=(0,i.Lk)("label",null,"Gender:",-1)),(0,i.Lk)("span",null,(0,s.v_)(at.formatGender(tt.request.beneficiary.gender)||"Not provided"),1)]),(0,i.Lk)("div",re,[t[48]||(t[48]=(0,i.Lk)("label",null,"Civil Status:",-1)),(0,i.Lk)("span",null,(0,s.v_)(at.getCivilStatusName(tt.request.beneficiary.civil_status_id)||"Not provided"),1)]),(0,i.Lk)("div",ne,[t[49]||(t[49]=(0,i.Lk)("label",null,"Nationality:",-1)),(0,i.Lk)("span",null,(0,s.v_)(tt.request.beneficiary.nationality||"Not provided"),1)]),(0,i.Lk)("div",oe,[t[50]||(t[50]=(0,i.Lk)("label",null,"Address:",-1)),(0,i.Lk)("span",null,(0,s.v_)(at.getBeneficiaryAddress()),1)]),tt.request.beneficiary.verification_image_path?((0,i.uX)(),(0,i.CE)("div",le,[t[52]||(t[52]=(0,i.Lk)("label",null,"Verification Document:",-1)),(0,i.Lk)("div",ce,[tt.imageUrls.beneficiaryVerification?((0,i.uX)(),(0,i.CE)("img",{key:0,src:tt.imageUrls.beneficiaryVerification,alt:tt.request.beneficiary.verification_image_name||"Verification Document",class:"verification-image",onClick:t[2]||(t[2]=e=>at.openImageModal(tt.request.beneficiary.verification_image_path,tt.request.beneficiary.verification_image_name,"beneficiaries")),onError:t[3]||(t[3]=e=>at.handleImageError(e,"beneficiary verification")),onLoad:t[4]||(t[4]=e=>at.handleImageLoad(e,"beneficiary verification"))},null,40,ue)):((0,i.uX)(),(0,i.CE)("div",de,t[51]||(t[51]=[(0,i.Lk)("i",{class:"fas fa-spinner fa-spin"},null,-1),(0,i.Lk)("span",null,"Loading image...",-1)])))])])):(0,i.Q3)("",!0)])])):(0,i.Q3)("",!0),(0,i.Lk)("div",me,[(0,i.Lk)("h4",null,(0,s.v_)(tt.request.document_type)+" Details",1),(0,i.Lk)("div",ge,[(0,i.Lk)("div",he,[t[54]||(t[54]=(0,i.Lk)("label",null,"Purpose Category:",-1)),(0,i.Lk)("span",null,(0,s.v_)(tt.request.purpose_category||"Not specified"),1)]),"Barangay Clearance"===tt.request.document_type?((0,i.uX)(),(0,i.CE)(i.FK,{key:0},[at.getEmergencyContact()?((0,i.uX)(),(0,i.CE)("div",pe,[t[55]||(t[55]=(0,i.Lk)("label",null,"Emergency Contact:",-1)),(0,i.Lk)("span",null,(0,s.v_)(at.getEmergencyContact()),1)])):(0,i.Q3)("",!0),at.getEmergencyPhone()?((0,i.uX)(),(0,i.CE)("div",fe,[t[56]||(t[56]=(0,i.Lk)("label",null,"Emergency Phone:",-1)),(0,i.Lk)("span",null,(0,s.v_)(at.getEmergencyPhone()),1)])):(0,i.Q3)("",!0),(0,i.Lk)("div",ke,[t[57]||(t[57]=(0,i.Lk)("label",null,"Pending Cases:",-1)),(0,i.Lk)("span",null,(0,s.v_)(tt.request.has_pending_cases?"Yes":"No"),1)])],64)):(0,i.Q3)("",!0),"Cedula"===tt.request.document_type&&tt.request.specific_details?((0,i.uX)(),(0,i.CE)(i.FK,{key:1},[(0,i.Lk)("div",ye,[t[58]||(t[58]=(0,i.Lk)("label",null,"Annual Income:",-1)),(0,i.Lk)("span",null,"‚Ç±"+(0,s.v_)(at.formatCurrency(tt.request.specific_details.annual_income)),1)]),tt.request.specific_details.business_name?((0,i.uX)(),(0,i.CE)("div",ve,[t[59]||(t[59]=(0,i.Lk)("label",null,"Business Name:",-1)),(0,i.Lk)("span",null,(0,s.v_)(tt.request.specific_details.business_name),1)])):(0,i.Q3)("",!0)],64)):(0,i.Q3)("",!0)])]),"Cedula"===tt.request.document_type&&tt.request.specific_details?((0,i.uX)(),(0,i.CE)("div",Le,[t[63]||(t[63]=(0,i.Lk)("h4",null,[(0,i.Lk)("i",{class:"fas fa-home me-2"}),(0,i.eW)(" Property Information ")],-1)),(0,i.Lk)("div",_e,[(0,i.Lk)("div",be,[t[60]||(t[60]=(0,i.Lk)("label",null,"Assessed Property Value:",-1)),(0,i.Lk)("span",null,"‚Ç±"+(0,s.v_)(at.formatCurrency(tt.request.specific_details.property_assessed_value||0)),1)]),tt.request.specific_details.property_location?((0,i.uX)(),(0,i.CE)("div",qe,[t[61]||(t[61]=(0,i.Lk)("label",null,"Property Location:",-1)),(0,i.Lk)("span",null,(0,s.v_)(tt.request.specific_details.property_location),1)])):(0,i.Q3)("",!0),(0,i.Lk)("div",we,[t[62]||(t[62]=(0,i.Lk)("label",null,"Personal Property Value:",-1)),(0,i.Lk)("span",null,"‚Ç±"+(0,s.v_)(at.formatCurrency(tt.request.specific_details.personal_property_value||0)),1)])])])):(0,i.Q3)("",!0),"Cedula"===tt.request.document_type&&tt.request.specific_details&&(tt.request.specific_details.business_name||tt.request.specific_details.business_gross_receipts>0)?((0,i.uX)(),(0,i.CE)("div",Ie,[t[68]||(t[68]=(0,i.Lk)("h4",null,[(0,i.Lk)("i",{class:"fas fa-briefcase me-2"}),(0,i.eW)(" Business/Professional Information ")],-1)),(0,i.Lk)("div",Ce,[tt.request.specific_details.business_name?((0,i.uX)(),(0,i.CE)("div",Ue,[t[64]||(t[64]=(0,i.Lk)("label",null,"Business Name:",-1)),(0,i.Lk)("span",null,(0,s.v_)(tt.request.specific_details.business_name),1)])):(0,i.Q3)("",!0),tt.request.specific_details.business_type?((0,i.uX)(),(0,i.CE)("div",Ee,[t[65]||(t[65]=(0,i.Lk)("label",null,"Business Type:",-1)),(0,i.Lk)("span",null,(0,s.v_)(tt.request.specific_details.business_type),1)])):(0,i.Q3)("",!0),(0,i.Lk)("div",Pe,[t[66]||(t[66]=(0,i.Lk)("label",null,"Annual Gross Receipts/Professional Fees:",-1)),(0,i.Lk)("span",null,"‚Ç±"+(0,s.v_)(at.formatCurrency(tt.request.specific_details.business_gross_receipts||0)),1)]),tt.request.specific_details.business_address?((0,i.uX)(),(0,i.CE)("div",De,[t[67]||(t[67]=(0,i.Lk)("label",null,"Business Address:",-1)),(0,i.Lk)("span",null,(0,s.v_)(tt.request.specific_details.business_address),1)])):(0,i.Q3)("",!0)])])):(0,i.Q3)("",!0)]),tt.request.authorized_pickup?((0,i.uX)(),(0,i.CE)("div",ze,[t[77]||(t[77]=(0,i.Lk)("h4",null,[(0,i.Lk)("i",{class:"fas fa-user-check me-2"}),(0,i.eW)(" Authorized Pickup Person ")],-1)),(0,i.Lk)("div",Re,[(0,i.Lk)("div",Se,[t[70]||(t[70]=(0,i.Lk)("label",null,"Full Name:",-1)),(0,i.Lk)("span",null,(0,s.v_)(at.getAuthorizedPickupFullName()),1)]),(0,i.Lk)("div",$e,[t[71]||(t[71]=(0,i.Lk)("label",null,"Relationship to Beneficiary:",-1)),(0,i.Lk)("span",null,(0,s.v_)(tt.request.authorized_pickup.relationship_to_beneficiary||"Not specified"),1)]),(0,i.Lk)("div",Ne,[t[72]||(t[72]=(0,i.Lk)("label",null,"Phone Number:",-1)),(0,i.Lk)("span",null,(0,s.v_)(tt.request.authorized_pickup.phone_number||"Not provided"),1)]),tt.request.authorized_pickup.id_image_path?((0,i.uX)(),(0,i.CE)("div",xe,[t[74]||(t[74]=(0,i.Lk)("label",null,"ID Document:",-1)),(0,i.Lk)("div",Ae,[tt.imageUrls.pickupId?((0,i.uX)(),(0,i.CE)("img",{key:0,src:tt.imageUrls.pickupId,alt:tt.request.authorized_pickup.id_image_name||"ID Document",class:"verification-image",onClick:t[5]||(t[5]=e=>at.openImageModal(tt.request.authorized_pickup.id_image_path,tt.request.authorized_pickup.id_image_name,"pickup_id")),onError:t[6]||(t[6]=e=>at.handleImageError(e,"pickup ID")),onLoad:t[7]||(t[7]=e=>at.handleImageLoad(e,"pickup ID"))},null,40,Te)):((0,i.uX)(),(0,i.CE)("div",We,t[73]||(t[73]=[(0,i.Lk)("i",{class:"fas fa-spinner fa-spin"},null,-1),(0,i.Lk)("span",null,"Loading image...",-1)])))])])):(0,i.Q3)("",!0),tt.request.authorized_pickup.authorization_letter_path?((0,i.uX)(),(0,i.CE)("div",Ve,[t[76]||(t[76]=(0,i.Lk)("label",null,"Authorization Letter:",-1)),(0,i.Lk)("div",je,[tt.imageUrls.authorizationLetter?((0,i.uX)(),(0,i.CE)("img",{key:0,src:tt.imageUrls.authorizationLetter,alt:"Authorization Letter",class:"verification-image",onClick:t[8]||(t[8]=e=>at.openImageModal(tt.request.authorized_pickup.authorization_letter_path,"Authorization Letter","pickup_authorization")),onError:t[9]||(t[9]=e=>at.handleImageError(e,"authorization letter")),onLoad:t[10]||(t[10]=e=>at.handleImageLoad(e,"authorization letter"))},null,40,Xe)):((0,i.uX)(),(0,i.CE)("div",Fe,t[75]||(t[75]=[(0,i.Lk)("i",{class:"fas fa-spinner fa-spin"},null,-1),(0,i.Lk)("span",null,"Loading image...",-1)])))])])):(0,i.Q3)("",!0)])])):(0,i.Q3)("",!0),(0,i.Lk)("div",Me,[t[81]||(t[81]=(0,i.Lk)("h4",null,"Payment Information",-1)),(0,i.Lk)("div",Be,[(0,i.Lk)("div",Qe,[t[78]||(t[78]=(0,i.Lk)("label",null,"Payment Method:",-1)),(0,i.Lk)("span",null,(0,s.v_)(tt.request.payment_method||"Not selected"),1)]),(0,i.Lk)("div",Oe,[t[79]||(t[79]=(0,i.Lk)("label",null,"Total Fee:",-1)),(0,i.Lk)("span",Ze,"‚Ç±"+(0,s.v_)(at.formatCurrency(tt.request.total_fee)),1)]),tt.request.payment_date?((0,i.uX)(),(0,i.CE)("div",He,[t[80]||(t[80]=(0,i.Lk)("label",null,"Payment Date:",-1)),(0,i.Lk)("span",null,(0,s.v_)(at.formatDate(tt.request.payment_date)),1)])):(0,i.Q3)("",!0)])])])):(0,i.Q3)("",!0),(0,i.Lk)("div",Ye,[at.canCancelRequest(tt.request.status)?((0,i.uX)(),(0,i.CE)("button",{key:0,class:"action-btn cancel-btn",onClick:t[11]||(t[11]=(...e)=>at.cancelRequest&&at.cancelRequest(...e))},t[82]||(t[82]=[(0,i.Lk)("i",{class:"fas fa-times"},null,-1),(0,i.eW)(" Cancel Request ")]))):(0,i.Q3)("",!0),at.needsPayment(tt.request)?((0,i.uX)(),(0,i.CE)("button",{key:1,class:"action-btn pay-btn",onClick:t[12]||(t[12]=(...e)=>at.processPayment&&at.processPayment(...e))},t[83]||(t[83]=[(0,i.Lk)("i",{class:"fas fa-credit-card"},null,-1),(0,i.eW)(" Pay Now ")]))):(0,i.Q3)("",!0),t[84]||(t[84]=(0,i.eW)(" x "))]),tt.request.admin_notes?((0,i.uX)(),(0,i.CE)("div",Ge,[t[85]||(t[85]=(0,i.Lk)("h3",null,"Admin Notes",-1)),(0,i.Lk)("div",Ke,[(0,i.Lk)("p",null,(0,s.v_)(tt.request.admin_notes),1),(0,i.Lk)("span",Je,(0,s.v_)(at.formatDate(tt.request.updated_at)),1)])])):(0,i.Q3)("",!0)]),tt.showImageViewer&&tt.selectedImage?((0,i.uX)(),(0,i.Wv)(it,{key:0,imageUrl:tt.selectedImage.url,title:tt.selectedImage.title,filename:tt.selectedImage.filename,imageType:tt.selectedImage.type,downloadUrl:tt.selectedImage.downloadUrl,onClose:at.closeImageViewer},null,8,["imageUrl","title","filename","imageType","downloadUrl","onClose"])):(0,i.Q3)("",!0)])}a(4114);var tt=a(1939),at=a(6212),it=a(5130);const st={class:"viewer-header"},rt={class:"image-info"},nt={class:"image-title"},ot={key:0,class:"image-meta"},lt={class:"filename"},ct={class:"image-type"},ut={class:"viewer-controls"},dt={class:"main-controls"},mt=["disabled"],gt={class:"zoom-level me-2"},ht=["disabled"],pt={class:"viewer-content",ref:"viewerContent"},ft={key:0,class:"debug-info"},kt={key:1,class:"loading-state"},yt={key:2,class:"error-state"},vt={class:"text-muted"},Lt={class:"image-display"},_t=["src","alt"],bt=["src"];function qt(e,t,a,r,n,o){return(0,i.uX)(),(0,i.CE)("div",{class:"image-viewer-overlay",onClick:t[15]||(t[15]=(...e)=>o.handleOverlayClick&&o.handleOverlayClick(...e))},[(0,i.Lk)("div",{class:"image-viewer-container",onClick:t[14]||(t[14]=(0,it.D$)((()=>{}),["stop"]))},[(0,i.Lk)("div",st,[(0,i.Lk)("div",rt,[(0,i.Lk)("h4",nt,[t[16]||(t[16]=(0,i.Lk)("i",{class:"fas fa-image me-2"},null,-1)),(0,i.eW)(" "+(0,s.v_)(a.title||"Document Image"),1)]),a.showMeta?((0,i.uX)(),(0,i.CE)("div",ot,[(0,i.Lk)("span",lt,(0,s.v_)(a.filename),1),(0,i.Lk)("span",ct,(0,s.v_)(a.imageType),1)])):(0,i.Q3)("",!0)]),(0,i.Lk)("div",ut,[(0,i.Lk)("div",dt,[(0,i.Lk)("button",{class:"btn btn-outline-secondary btn-sm me-2",onClick:t[0]||(t[0]=(...e)=>o.zoomOut&&o.zoomOut(...e)),disabled:n.zoomLevel<=.5},t[17]||(t[17]=[(0,i.Lk)("i",{class:"fas fa-search-minus"},null,-1)]),8,mt),(0,i.Lk)("span",gt,(0,s.v_)(Math.round(100*n.zoomLevel))+"%",1),(0,i.Lk)("button",{class:"btn btn-outline-secondary btn-sm me-2",onClick:t[1]||(t[1]=(...e)=>o.zoomIn&&o.zoomIn(...e)),disabled:n.zoomLevel>=3},t[18]||(t[18]=[(0,i.Lk)("i",{class:"fas fa-search-plus"},null,-1)]),8,ht),(0,i.Lk)("button",{class:"btn btn-outline-secondary btn-sm me-2",onClick:t[2]||(t[2]=(...e)=>o.resetZoom&&o.resetZoom(...e))},t[19]||(t[19]=[(0,i.Lk)("i",{class:"fas fa-expand-arrows-alt"},null,-1)])),a.downloadUrl?((0,i.uX)(),(0,i.CE)("button",{key:0,class:"btn btn-outline-primary btn-sm me-2",onClick:t[3]||(t[3]=(...e)=>o.downloadImage&&o.downloadImage(...e))},t[20]||(t[20]=[(0,i.Lk)("i",{class:"fas fa-download me-1"},null,-1)]))):(0,i.Q3)("",!0)]),(0,i.Lk)("button",{class:"btn btn-outline-secondary btn-sm close-button",onClick:t[4]||(t[4]=t=>e.$emit("close"))},t[21]||(t[21]=[(0,i.Lk)("i",{class:"fas fa-times me-1"},null,-1),(0,i.eW)(" Close ")]))])]),(0,i.Lk)("div",pt,[e.$root.$data&&e.$root.$data.isDevelopment?((0,i.uX)(),(0,i.CE)("div",ft,[(0,i.Lk)("small",null,"Loading: "+(0,s.v_)(n.loading)+", Error: "+(0,s.v_)(n.error)+", URL: "+(0,s.v_)(a.imageUrl?a.imageUrl.substring(0,30)+"...":"none"),1)])):(0,i.Q3)("",!0),n.loading&&!n.error?((0,i.uX)(),(0,i.CE)("div",kt,[t[23]||(t[23]=(0,i.Lk)("div",{class:"spinner-border text-primary",role:"status"},[(0,i.Lk)("span",{class:"sr-only"},"Loading...")],-1)),t[24]||(t[24]=(0,i.Lk)("p",{class:"mt-2"},"Loading image...",-1)),(0,i.Lk)("button",{class:"btn btn-outline-secondary btn-sm mt-2",onClick:t[5]||(t[5]=(...e)=>o.debugImageState&&o.debugImageState(...e))},t[22]||(t[22]=[(0,i.Lk)("i",{class:"fas fa-bug me-1"},null,-1),(0,i.eW)(" Debug Info ")]))])):n.error?((0,i.uX)(),(0,i.CE)("div",yt,[t[26]||(t[26]=(0,i.Lk)("i",{class:"fas fa-exclamation-triangle fa-3x text-danger mb-3"},null,-1)),t[27]||(t[27]=(0,i.Lk)("h5",null,"Unable to Load Image",-1)),(0,i.Lk)("p",vt,(0,s.v_)(n.error),1),(0,i.Lk)("button",{class:"btn btn-primary",onClick:t[6]||(t[6]=(...e)=>o.retryLoad&&o.retryLoad(...e))},t[25]||(t[25]=[(0,i.Lk)("i",{class:"fas fa-redo me-1"},null,-1),(0,i.eW)(" Try Again ")]))])):(0,i.Q3)("",!0),(0,i.bo)((0,i.Lk)("div",Lt,[(0,i.Lk)("img",{src:a.imageUrl,alt:a.title||"Document Image",style:(0,s.Tr)({transform:`scale(${n.zoomLevel})`}),class:"main-image",onLoad:t[7]||(t[7]=(...e)=>o.onImageLoad&&o.onImageLoad(...e)),onError:t[8]||(t[8]=(...e)=>o.onImageError&&o.onImageError(...e)),onWheel:t[9]||(t[9]=(...e)=>o.handleWheel&&o.handleWheel(...e)),onLoadstart:t[10]||(t[10]=(...e)=>o.onImageLoadStart&&o.onImageLoadStart(...e)),onLoadend:t[11]||(t[11]=(...e)=>o.onImageLoadEnd&&o.onImageLoadEnd(...e)),draggable:"false",ref:"mainImage"},null,44,_t)],512),[[it.aG,o.shouldShowImage]]),a.imageUrl&&n.loading?((0,i.uX)(),(0,i.CE)("img",{key:3,src:a.imageUrl,style:{position:"absolute",opacity:"0","pointer-events":"none",width:"1px",height:"1px"},onLoad:t[12]||(t[12]=(...e)=>o.onImageLoad&&o.onImageLoad(...e)),onError:t[13]||(t[13]=(...e)=>o.onImageError&&o.onImageError(...e)),ref:"hiddenImage"},null,40,bt)):(0,i.Q3)("",!0)],512)])])}var wt={name:"ImageViewer",props:{imageUrl:{type:String,required:!0},title:{type:String,default:""},filename:{type:String,default:""},imageType:{type:String,default:""},downloadUrl:{type:String,default:""},showMeta:{type:Boolean,default:!0}},data(){return{loading:!0,error:null,zoomLevel:1,minZoom:.5,maxZoom:3,zoomStep:.25,imageLoadAttempts:0,maxLoadAttempts:3}},computed:{shouldShowImage(){return!this.loading&&!this.error&&this.imageUrl}},watch:{imageUrl:{handler(e,t){console.log("üîÑ ImageViewer: imageUrl changed:",{oldUrl:t?t.substring(0,50)+"...":"none",newUrl:e?e.substring(0,50)+"...":"none",isBlobUrl:e?.startsWith("blob:"),isDataUrl:e?.startsWith("data:")}),e&&(this.loading=!0,this.error=null,this.imageLoadAttempts=0,this.preloadImage(e))},immediate:!0}},mounted(){document.addEventListener("keydown",this.handleKeydown),this.addTouchListeners(),this.$nextTick((()=>{const e=this.$el?.querySelector(".main-image");e&&(console.log("üîç ImageViewer mounted, checking image state:",{src:e.src?e.src.substring(0,50)+"...":"none",complete:e.complete,naturalWidth:e.naturalWidth,naturalHeight:e.naturalHeight}),e.complete&&e.naturalWidth>0?(console.log("‚úÖ Image was already loaded, updating state"),this.loading=!1,this.error=null):this.imageUrl&&(this.validateImageUrl(this.imageUrl),setTimeout((()=>this.checkImageLoadingState()),1e3),setTimeout((()=>this.checkImageLoadingState()),3e3),setTimeout((()=>this.checkImageLoadingState()),5e3)))}))},beforeUnmount(){document.removeEventListener("keydown",this.handleKeydown),this.removeTouchListeners()},methods:{handleOverlayClick(){this.$emit("close")},onImageLoadStart(e){console.log("üîÑ ImageViewer: Image load started:",{src:e.target.src.substring(0,50)+"...",loadingState:this.loading})},onImageLoadEnd(e){console.log("üèÅ ImageViewer: Image load ended:",{src:e.target.src.substring(0,50)+"...",complete:e.target.complete,naturalWidth:e.target.naturalWidth,naturalHeight:e.target.naturalHeight})},onImageLoad(e){console.log("‚úÖ ImageViewer: Image loaded successfully:",{src:e.target.src.substring(0,50)+"...",naturalWidth:e.target.naturalWidth,naturalHeight:e.target.naturalHeight,currentLoadingState:this.loading}),this.$nextTick((()=>{this.loading=!1,this.error=null,console.log("‚úÖ ImageViewer: Loading state updated to false")}))},onImageError(e){console.error("‚ùå ImageViewer: Image failed to load:",{src:e.target.src.substring(0,50)+"...",error:e.target.error,currentLoadingState:this.loading}),this.$nextTick((()=>{this.loading=!1,this.error="Failed to load image. The image file may be missing or corrupted.",console.log("‚ùå ImageViewer: Error state updated")}))},retryLoad(){console.log("üîÑ ImageViewer: Retrying image load"),this.loading=!0,this.error=null;const e=this.$el.querySelector(".main-image");e&&(this.imageUrl.startsWith("blob:")?(console.log("üîÑ Retrying blob URL load"),e.src="",this.$nextTick((()=>{e.src=this.imageUrl}))):(console.log("üîÑ Retrying regular URL load with cache bust"),e.src=this.imageUrl+"?t="+Date.now()))},zoomIn(){this.zoomLevel<this.maxZoom&&(this.zoomLevel=Math.min(this.maxZoom,this.zoomLevel+this.zoomStep))},zoomOut(){this.zoomLevel>this.minZoom&&(this.zoomLevel=Math.max(this.minZoom,this.zoomLevel-this.zoomStep))},resetZoom(){this.zoomLevel=1},handleWheel(e){e.preventDefault(),e.deltaY<0?this.zoomIn():this.zoomOut()},handleKeydown(e){switch(e.key){case"Escape":this.$emit("close");break;case"+":case"=":e.preventDefault(),this.zoomIn();break;case"-":e.preventDefault(),this.zoomOut();break;case"0":e.preventDefault(),this.resetZoom();break}},async downloadImage(){if(this.downloadUrl)try{if(this.downloadUrl.startsWith("blob:")){const e=document.createElement("a");e.href=this.downloadUrl,e.download=this.filename||"image.jpg",document.body.appendChild(e),e.click(),document.body.removeChild(e)}else{const e=(await Promise.resolve().then(a.bind(a,4300))).default,t=await e.get(this.downloadUrl,{responseType:"blob"}),i=t.data,s=URL.createObjectURL(i),r=document.createElement("a");r.href=s,r.download=this.filename||"image.jpg",document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(s)}}catch(e){console.error("Error downloading image:",e),this.$emit("error","Failed to download image")}},validateImageUrl(e){if(console.log("üîç ImageViewer: Validating image URL:",{url:e.substring(0,50)+"...",isBlobUrl:e.startsWith("blob:"),isDataUrl:e.startsWith("data:"),isHttpUrl:e.startsWith("http")}),e.startsWith("blob:"))try{const t=new Image;t.onload=()=>{console.log("‚úÖ Blob URL validation: URL is accessible")},t.onerror=()=>{console.error("‚ùå Blob URL validation: URL is not accessible")},t.src=e}catch(t){console.error("‚ùå Blob URL validation error:",t)}},debugImageState(){const e=this.$refs.mainImage;e?console.log("üîç ImageViewer: Current image state:",{src:e.src?e.src.substring(0,50)+"...":"none",complete:e.complete,naturalWidth:e.naturalWidth,naturalHeight:e.naturalHeight,readyState:e.readyState,loading:this.loading,error:this.error}):console.log("üîç ImageViewer: No image ref found")},forceImageReload(){if(console.log("üîÑ ImageViewer: Force reloading image"),this.imageLoadAttempts++,this.imageLoadAttempts>this.maxLoadAttempts)return console.error("‚ùå ImageViewer: Max load attempts reached, giving up"),this.loading=!1,void(this.error="Image failed to load after multiple attempts");const e=this.$refs.mainImage,t=this.$refs.hiddenImage;[e,t].forEach((e=>{e&&this.imageUrl&&(e.src="",this.$nextTick((()=>{e.src=this.imageUrl,console.log("üîÑ ImageViewer: Image src reset and reloaded")})))}))},checkImageLoadingState(){if(!this.loading)return;const e=this.$refs.mainImage,t=this.$refs.hiddenImage;[e,t].forEach(((e,t)=>{if(e){const a=0===t?"main":"hidden";if(console.log(`üîç Checking ${a} image state:`,{complete:e.complete,naturalWidth:e.naturalWidth,naturalHeight:e.naturalHeight,src:e.src?e.src.substring(0,30)+"...":"none"}),e.complete&&e.naturalWidth>0&&this.loading)return console.log(`‚úÖ ${a} image is loaded but state not updated, fixing...`),this.loading=!1,void(this.error=null)}})),this.loading&&console.log("‚è∞ Image still loading, current state:",{loading:this.loading,error:this.error,imageUrl:this.imageUrl?this.imageUrl.substring(0,50)+"...":"none",attempts:this.imageLoadAttempts})},preloadImage(e){console.log("üîÑ ImageViewer: Preloading image manually:",e.substring(0,50)+"...");const t=new Image;t.onload=()=>{console.log("‚úÖ ImageViewer: Preload successful, updating component state"),this.loading=!1,this.error=null,this.$nextTick((()=>{const t=this.$refs.mainImage,a=this.$refs.hiddenImage;[t,a].forEach((t=>{t&&t.src!==e&&(t.src=e)}))}))},t.onerror=e=>{console.error("‚ùå ImageViewer: Preload failed:",e),this.loading=!1,this.error="Failed to load image. The image may be corrupted or unavailable."},t.src=e,setTimeout((()=>{this.loading&&(console.log("‚è∞ Preload timeout, checking if image actually loaded..."),t.complete&&t.naturalWidth>0&&(console.log("‚úÖ Image was loaded but events may have been missed"),this.loading=!1,this.error=null))}),1e4)},addTouchListeners(){const e=this.$refs.viewerContent;if(e){let t=0,a=1,i=0;e.addEventListener("touchstart",(e=>{if(2===e.touches.length){e.preventDefault();const i=e.touches[0],s=e.touches[1];t=Math.hypot(s.clientX-i.clientX,s.clientY-i.clientY),a=this.zoomLevel}else if(1===e.touches.length){const t=(new Date).getTime(),a=t-i;a<500&&a>0&&(e.preventDefault(),this.resetZoom()),i=t}}),{passive:!1}),e.addEventListener("touchmove",(e=>{if(2===e.touches.length){e.preventDefault();const i=e.touches[0],s=e.touches[1],r=Math.hypot(s.clientX-i.clientX,s.clientY-i.clientY),n=r/t,o=Math.max(this.minZoom,Math.min(this.maxZoom,a*n));this.zoomLevel=o}}),{passive:!1})}},removeTouchListeners(){}}},It=a(1241);const Ct=(0,It.A)(wt,[["render",qt],["__scopeId","data-v-5e71cb7f"]]);var Ut=Ct,Et={name:"RequestDetails",components:{ImageViewer:Ut},data(){return{request:null,loading:!0,error:null,showImageViewer:!1,selectedImage:null,imageObjectUrls:new Map,imageUrls:{beneficiaryVerification:"",pickupId:"",authorizationLetter:""},progressSteps:[{status:"pending",title:"Request Submitted",description:"Your request has been submitted and is waiting for review",icon:"fas fa-paper-plane"},{status:"under_review",title:"Under Review",description:"Your request is being reviewed by our staff",icon:"fas fa-search"},{status:"approved",title:"Approved",description:"Your request has been approved and payment is required",icon:"fas fa-check"},{status:"processing",title:"Processing",description:"Your document is being prepared",icon:"fas fa-cog"},{status:"ready_for_pickup",title:"Ready for Pickup",description:"Your document is ready for pickup",icon:"fas fa-box"},{status:"completed",title:"Completed",description:"Request has been completed successfully",icon:"fas fa-check-circle"}]}},computed:{clientData(){return at["default"].getCurrentUser()}},async mounted(){await this.loadRequestDetails()},beforeUnmount(){this.cleanupImageUrls()},methods:{async loadRequestDetails(){try{this.loading=!0,this.error=null;const e=this.$route.params.id,t=await tt.A.getRequestDetails(e);this.request=t.data,console.log("üîç Frontend received request data:",{id:this.request?.id,requestor:this.request?.requestor,nationality:this.request?.requestor?.nationality,months_of_residency:this.request?.requestor?.months_of_residency,years_of_residency:this.request?.requestor?.years_of_residency,beneficiary:this.request?.beneficiary,beneficiary_verification_image:this.request?.beneficiary?.verification_image_path,authorized_pickup:this.request?.authorized_pickup,pickup_id_image:this.request?.authorized_pickup?.id_image_path}),console.log("üîç Request data loaded:",{hasAuthorizedPickup:!!this.request.authorized_pickup,authorizedPickupData:this.request.authorized_pickup,pickupIdImagePath:this.request.authorized_pickup?.id_image_path,authorizationLetterPath:this.request.authorized_pickup?.authorization_letter_path}),await this.loadImages()}catch(e){console.error("Error loading request details:",e),this.error=e.response?.data?.message||"Failed to load request details"}finally{this.loading=!1}},async loadImages(){const e=localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token");if(!e)return console.warn("‚ö†Ô∏è User not authenticated, skipping image loading"),void this.showToast("Warning","Please log in to view verification images","warning");if(console.log("üñºÔ∏è Starting image loading process..."),this.request?.beneficiary?.verification_image_path)try{console.log("üì∏ Loading beneficiary verification image...");const e=await this.getVerificationImageUrl(this.request.beneficiary.verification_image_path);e&&e!==this.getPlaceholderImageUrl()?(this.imageUrls.beneficiaryVerification=e,console.log("‚úÖ Beneficiary verification image loaded successfully")):this.imageUrls.beneficiaryVerification=this.getPlaceholderImageUrl()}catch(t){console.error("‚ùå Failed to load beneficiary verification image:",t.message),this.imageUrls.beneficiaryVerification=this.getPlaceholderImageUrl(),t.message.includes("log in")&&this.showToast("Warning","Please log in to view images","warning")}if(this.request?.authorized_pickup?.id_image_path)try{console.log("üì∏ Loading pickup ID image...",{path:this.request.authorized_pickup.id_image_path,filename:this.request.authorized_pickup.id_image_path.split(/[/\\]/).pop()});const e=await this.getPickupIdImageUrl(this.request.authorized_pickup.id_image_path);e&&e!==this.getPlaceholderImageUrl()?(this.imageUrls.pickupId=e,console.log("‚úÖ Pickup ID image loaded successfully")):(this.imageUrls.pickupId=this.getPlaceholderImageUrl(),console.log("‚ö†Ô∏è Using placeholder for pickup ID image"))}catch(t){console.error("‚ùå Failed to load pickup ID image:",t.message),this.imageUrls.pickupId=this.getPlaceholderImageUrl(),t.message.includes("log in")&&this.showToast("Warning","Please log in to view images","warning")}else console.log("‚ö†Ô∏è No pickup ID image path found in request data");if(this.request?.authorized_pickup?.authorization_letter_path)try{console.log("üì∏ Loading authorization letter image...");const e=await this.getAuthorizationLetterUrl(this.request.authorized_pickup.authorization_letter_path);e&&e!==this.getPlaceholderImageUrl()?(this.imageUrls.authorizationLetter=e,console.log("‚úÖ Authorization letter image loaded successfully")):this.imageUrls.authorizationLetter=this.getPlaceholderImageUrl()}catch(t){console.error("‚ùå Failed to load authorization letter image:",t.message),this.imageUrls.authorizationLetter=this.getPlaceholderImageUrl(),t.message.includes("log in")&&this.showToast("Warning","Please log in to view images","warning")}console.log("üñºÔ∏è Image loading process completed")},cleanupImageUrls(){for(const[e,t]of this.imageObjectUrls)URL.revokeObjectURL(t),console.log("üßπ Cleaned up object URL:",e);this.imageObjectUrls.clear()},getDocumentIcon(e){const t={"Barangay Clearance":"fas fa-certificate",Cedula:"fas fa-id-card"};return t[e]||"fas fa-file-alt"},getStatusClass(e){const t={pending:"status-pending",under_review:"status-review",approved:"status-approved",processing:"status-processing",ready_for_pickup:"status-ready",completed:"status-completed",rejected:"status-rejected",cancelled:"status-cancelled"};return t[e]||"status-unknown"},formatStatus(e){const t={pending:"Pending",under_review:"Under Review",approved:"Approved",processing:"Processing",ready_for_pickup:"Ready for Pickup",completed:"Completed",rejected:"Rejected",cancelled:"Cancelled"};return t[e]||e},getPaymentStatusClass(e){const t={pending:"payment-pending",paid:"payment-paid",failed:"payment-failed",refunded:"payment-refunded"};return t[e]||"payment-unknown"},formatPaymentStatus(e){const t={pending:"Pending Payment",paid:"Paid",failed:"Payment Failed",refunded:"Refunded"};return t[e]||"Not Required"},getMainTimelineSteps(){const e=[...this.progressSteps],t=this.request&&("Cash Payment"===this.request.payment_method||"Cash"===this.request.payment_method||"CASH"===this.request.payment_method_code||1===this.request.payment_method_id||!1===this.request.is_online_payment||0===this.request.is_online_payment||!1===this.request.is_online||0===this.request.is_online);if(t){const t=e.findIndex((e=>"approved"===e.status));-1!==t&&(e[t]={...e[t],description:"Your request has been approved. Payment will be collected during pickup."})}return e},isStepCompleted(e,t){if("rejected"===t){const t=["pending"];return t.includes(e)}const a=["pending","under_review","approved","processing","ready_for_pickup","completed"],i=a.indexOf(e),s=a.indexOf(t);return i<s},getFullName(){const e=this.request?.client||this.clientData?.profile;return e?`${e.first_name||""} ${e.middle_name||""} ${e.last_name||""}`.trim():"N/A"},getClientEmail(){const e=this.request?.email||this.request?.client?.email||this.clientData?.profile?.email;return e&&e.trim()?e:null},getClientPhone(){const e=this.request?.phone_number||this.request?.client?.phone_number||this.clientData?.profile?.phone_number;return e&&e.trim()?e:"Contact information not available"},getEmergencyContact(){const e=this.request?.emergency_contact_name;return e&&e.trim()?e:null},getEmergencyPhone(){const e=this.request?.emergency_contact_phone;return e&&e.trim()?e:null},getFullAddress(){const e=this.request?.client||this.clientData||this.request;if(!e)return"Address not available";const t=[e.house_number||e.requestor_house_number,e.street||e.requestor_street,e.subdivision,e.barangay||e.requestor_barangay,e.city_municipality||e.requestor_city_municipality||e.city,e.province||e.requestor_province].filter((e=>e&&e.trim()));return t.length>0?t.join(", "):"Address not available"},getClientUsername(){return this.request?.client_username||this.request?.client?.username||this.clientData?.username},getClientEmailVerified(){return this.request?.email_verified||this.request?.client?.email_verified||this.clientData?.email_verified||!1},getClientPhoneVerified(){return this.request?.phone_verified||this.request?.client?.phone_verified||this.clientData?.phone_verified||!1},getClientProfileVerified(){return this.request?.is_verified||this.request?.client?.is_verified||this.clientData?.is_verified||!1},getClientResidencyVerified(){return this.request?.residency_verified||this.request?.client?.residency_verified||this.clientData?.residency_verified||!1},getClientAccountStatus(){return this.request?.status||this.request?.client?.status||this.clientData?.status||"unknown"},getClientLastLogin(){return this.request?.last_login||this.request?.client?.last_login||this.clientData?.last_login},getClientCreatedAt(){return this.request?.created_at||this.request?.client?.created_at||this.clientData?.created_at},getClientBirthDate(){return this.request?.birth_date||this.request?.requestor_birth_date||this.request?.client?.birth_date||this.clientData?.birth_date},getClientGender(){return this.request?.gender||this.request?.requestor_gender||this.request?.client?.gender||this.clientData?.gender},getClientCivilStatus(){return this.request?.civil_status_id||this.request?.requestor_civil_status_id||this.request?.client?.civil_status_id||this.clientData?.civil_status_id},getClientNationality(){return this.request?.requestor?.nationality||this.request?.nationality||this.request?.requestor_nationality||this.request?.client?.nationality||this.clientData?.nationality},getClientAccountStatusClass(){const e=this.getClientAccountStatus(),t={active:"bg-success",inactive:"bg-secondary",suspended:"bg-danger",pending_verification:"bg-warning",pending_residency_verification:"bg-info"};return t[e]||"bg-secondary"},formatAccountStatus(e){const t={active:"Active",inactive:"Inactive",suspended:"Suspended",pending_verification:"Pending Verification",pending_residency_verification:"Pending Residency Verification"};return t[e]||e},formatGender(e){return e?e.charAt(0).toUpperCase()+e.slice(1):"Not provided"},getCivilStatusName(e){const t={1:"Single",2:"Married",3:"Divorced",4:"Widowed",5:"Separated"};return t[e]||"Not provided"},getResidencyDisplay(){if(!this.request||!this.request.requestor)return"Not provided";const e=this.request.requestor.years_of_residency||0,t=this.request.requestor.months_of_residency||0;if(0===e&&0===t)return"Not provided";const a=[];return e>0&&a.push(`${e} year${e>1?"s":""}`),t>0&&a.push(`${t} month${t>1?"s":""}`),a.length>0?a.join(" and "):"Less than a month"},formatDate(e){return e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A"},formatCurrency(e){return parseFloat(e||0).toFixed(2)},canCancelRequest(e){const t=["pending","under_review","additional_info_required","approved","payment_pending","payment_failed"];return t.includes(e)},needsPayment(e){const t=["approved","payment_pending","payment_failed"],a=["pending","failed",null,void 0,""];return t.includes(e.status)&&a.includes(e.payment_status)&&e.payment_method_id&&e.is_online_payment},canDownload(e){return"completed"===e},async cancelRequest(){const e=prompt("Please provide a reason for cancelling this request (optional):","");if(null!==e&&confirm("Are you sure you want to cancel this request?"))try{console.log("üö´ Cancelling request:",this.request.id,"Reason:",e);const t=e.trim()||"Cancelled by user";await tt.A.cancelRequest(this.request.id,t),this.$toast?.success("Request cancelled successfully. Administrators have been notified."),this.request.status="cancelled",await this.loadRequestDetails(),console.log("‚úÖ Request cancelled successfully")}catch(t){console.error("‚ùå Error cancelling request:",t),t.response?.data?.message?this.$toast?.error(t.response.data.message):t.message?.includes("cannot be cancelled")?this.$toast?.error("This request cannot be cancelled at its current stage"):this.$toast?.error("Failed to cancel request. Please try again.")}},async processPayment(){try{if(!this.request.payment_method_id)return void this.showToast("Error","No payment method selected for this request","error");if(!this.request.is_online_payment)return void this.showToast("Info","This request uses in-person payment. Please pay at the barangay office.","info");this.showToast("Info","Initiating payment...","info");const e=this.$clientAuth.getCurrentUser(),t={request_id:this.request.id,payment_method_id:this.request.payment_method_id,customer_email:e?.email||this.request.email},{default:i}=await a.e(599).then(a.bind(a,2599)),s=await i.initiatePayment(t);if(!s.success||!s.data.checkout_url)throw new Error(s.message||"Failed to initiate payment");this.showToast("Success","Redirecting to payment page...","success"),i.redirectToPayMongo(s.data.checkout_url)}catch(e){console.error("Payment initiation error:",e);const t=e.response?.data?.message||e.message||"Failed to initiate payment";this.showToast("Error",t,"error")}},downloadDocument(){console.log("Download document for request:",this.request.id)},printDetails(){window.print()},goBack(){this.$router.push({name:"MyRequests"})},getBeneficiaryFullName(){if(!this.request?.beneficiary)return"Not provided";const e=this.request.beneficiary;return`${e.first_name||""} ${e.middle_name||""} ${e.last_name||""}`.trim()},getBeneficiaryAddress(){if(!this.request?.beneficiary)return"Not provided";const e=this.request.beneficiary,t=[e.house_number,e.street,e.subdivision,e.barangay,e.city_municipality,e.province].filter((e=>e&&e.trim()));return t.length>0?t.join(", "):"Not provided"},async getVerificationImageUrl(e){if(!e)return this.getPlaceholderImageUrl();const t=e.split(/[/\\]/).pop(),a=`beneficiary-${t}`;if(this.imageObjectUrls.has(a))return this.imageObjectUrls.get(a);try{console.log("üîç Debug beneficiary verification image loading:",{originalPath:e,extractedFilename:t,requestId:this.request.id,finalApiUrl:`/client/document-requests/${this.request.id}/verification-image/beneficiary/${t}`});const i=await tt.A.getVerificationImageObjectUrl(this.request.id,"beneficiary",t);return this.imageObjectUrls.set(a,i),console.log("‚úÖ Created object URL for beneficiary verification image:",t),i}catch(i){return console.error("‚ùå Failed to load beneficiary verification image:",{filename:t,imagePath:e,requestId:this.request.id,error:i.message,status:i.response?.status}),i.message.includes("not found")?this.showToast("Warning","Verification image not found on server","warning"):i.message.includes("contact support")?this.showToast("Error","Server error - please contact support","error"):this.showToast("Warning",`Failed to load verification image: ${i.message}`,"warning"),this.getPlaceholderImageUrl()}},getVerificationStatusClass(e){const t={pending:"bg-warning",approved:"bg-success",rejected:"bg-danger"};return t[e]||"bg-secondary"},formatVerificationStatus(e){const t={pending:"Pending Verification",approved:"Verified",rejected:"Rejected"};return t[e]||"Unknown"},getAuthorizedPickupFullName(){if(!this.request?.authorized_pickup)return"Not provided";const e=this.request.authorized_pickup;return`${e.first_name||""} ${e.middle_name||""} ${e.last_name||""}`.trim()},async getPickupIdImageUrl(e){if(!e)return this.getPlaceholderImageUrl();const t=e.split(/[/\\]/).pop(),a=`pickup-id-${t}`;if(this.imageObjectUrls.has(a))return this.imageObjectUrls.get(a);try{console.log("üîç Debug pickup ID image loading:",{originalPath:e,extractedFilename:t,requestId:this.request.id,finalApiUrl:`/client/document-requests/${this.request.id}/verification-image/pickup-id/${t}`});const i=await tt.A.getVerificationImageObjectUrl(this.request.id,"pickup-id",t);return this.imageObjectUrls.set(a,i),console.log("‚úÖ Created object URL for pickup ID image:",t),i}catch(i){return console.error("‚ùå Failed to load pickup ID image:",{filename:t,imagePath:e,requestId:this.request.id,error:i.message,status:i.response?.status}),i.message.includes("not found")?this.showToast("Warning","ID image not found on server","warning"):i.message.includes("contact support")?this.showToast("Error","Server error - please contact support","error"):this.showToast("Warning",`Failed to load ID image: ${i.message}`,"warning"),this.getPlaceholderImageUrl()}},async getAuthorizationLetterUrl(e){if(!e)return this.getPlaceholderImageUrl();const t=e.split(/[/\\]/).pop(),a=`pickup-auth-${t}`;if(this.imageObjectUrls.has(a))return this.imageObjectUrls.get(a);try{console.log("üîç Debug authorization letter loading:",{originalPath:e,extractedFilename:t,requestId:this.request.id,finalApiUrl:`/client/document-requests/${this.request.id}/verification-image/pickup-auth/${t}`});const i=await tt.A.getVerificationImageObjectUrl(this.request.id,"pickup-auth",t);return this.imageObjectUrls.set(a,i),console.log("‚úÖ Created object URL for authorization letter:",t),i}catch(i){return console.error("‚ùå Failed to load authorization letter:",{filename:t,imagePath:e,requestId:this.request.id,error:i.message,status:i.response?.status}),i.message.includes("not found")?this.showToast("Warning","Authorization letter not found on server","warning"):i.message.includes("contact support")?this.showToast("Error","Server error - please contact support","error"):this.showToast("Warning",`Failed to load authorization letter: ${i.message}`,"warning"),this.getPlaceholderImageUrl()}},getPlaceholderImageUrl(){return"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjE1MCIgdmlld0JveD0iMCAwIDIwMCAxNTAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMTUwIiBmaWxsPSIjRjNGNEY2Ii8+CjxwYXRoIGQ9Ik04NSA2MEw5NSA3MEwxMTUgNTBMMTM1IDcwTDE0NSA2MEwxNjUgODBMMTY1IDEyMEg0NVY4MEw2NSA2MEw4NSA2MFoiIGZpbGw9IiNEMUQ1REIiLz4KPGNpcmNsZSBjeD0iNzAiIGN5PSI0NSIgcj0iOCIgZmlsbD0iI0QxRDVEQiIvPgo8dGV4dCB4PSIxMDAiIHk9IjEwNSIgZm9udC1mYW1pbHk9IkFyaWFsLCBzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBmaWxsPSIjNkI3MjgwIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj5JbWFnZSBub3QgYXZhaWxhYmxlPC90ZXh0Pgo8L3N2Zz4K"},async openImageModal(e,t,a="beneficiaries"){try{let i;switch(a){case"pickup_id":case"pickup_ids":i=this.imageUrls.pickupId;break;case"pickup_authorization":i=this.imageUrls.authorizationLetter;break;default:i=this.imageUrls.beneficiaryVerification}if(!i||i===this.getPlaceholderImageUrl())switch(console.log("üîÑ Image not loaded yet, attempting to load for modal..."),a){case"pickup_id":case"pickup_ids":i=await this.getPickupIdImageUrl(e),this.imageUrls.pickupId=i;break;case"pickup_authorization":i=await this.getAuthorizationLetterUrl(e),this.imageUrls.authorizationLetter=i;break;default:i=await this.getVerificationImageUrl(e),this.imageUrls.beneficiaryVerification=i}if(!i||i===this.getPlaceholderImageUrl())return void this.showToast("Error","Failed to load image","error");console.log("üñºÔ∏è Opening ImageViewer modal with:",{imageType:a,imageName:t,imagePath:e,imageUrl:i?i.substring(0,50)+"...":"none",isBlobUrl:i?.startsWith("blob:"),isDataUrl:i?.startsWith("data:"),isPlaceholder:i===this.getPlaceholderImageUrl()}),this.selectedImage={url:i,title:t||"Document",filename:e?e.split(/[/\\]/).pop():"",type:a,downloadUrl:i},this.showImageViewer=!0}catch(i){console.error("Error opening image modal:",i),this.showToast("Error","Failed to load image","error")}},closeImageViewer(){this.showImageViewer=!1,this.selectedImage=null},handleImageError(e,t){console.error(`‚ùå Failed to load ${t} image:`,e.target.src),e.target.style.display="none";const a=e.target.closest(".verification-image-container");if(a&&!a.querySelector(".image-error-message")){const e=document.createElement("div");e.className="image-error-message",e.innerHTML=`\n          <i class="fas fa-exclamation-triangle text-warning"></i>\n          <span>Unable to load ${t} image</span>\n          <small class="d-block mt-1">Authentication or network error</small>\n        `,a.appendChild(e)}},handleImageLoad(e,t){console.log(`‚úÖ Successfully loaded ${t} image:`,e.target.src)},showToast(e,t,a="info"){console.log(`[${a.toUpperCase()}] ${e}: ${t}`);const i=document.createElement("div");if(i.className=`toast-notification toast-${a}`,i.innerHTML=`\n        <div class="toast-header">\n          <strong>${e}</strong>\n          <button type="button" class="toast-close" onclick="this.parentElement.parentElement.remove()">√ó</button>\n        </div>\n        <div class="toast-body">${t}</div>\n      `,!document.getElementById("toast-styles")){const e=document.createElement("style");e.id="toast-styles",e.textContent="\n          .toast-notification {\n            position: fixed;\n            top: 20px;\n            right: 20px;\n            min-width: 300px;\n            background: white;\n            border-radius: 8px;\n            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n            z-index: 9999;\n            animation: slideIn 0.3s ease;\n          }\n          .toast-header {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            padding: 12px 16px 8px;\n            border-bottom: 1px solid #e9ecef;\n          }\n          .toast-body {\n            padding: 8px 16px 12px;\n            color: #6c757d;\n          }\n          .toast-close {\n            background: none;\n            border: none;\n            font-size: 18px;\n            cursor: pointer;\n            color: #6c757d;\n          }\n          .toast-success { border-left: 4px solid #28a745; }\n          .toast-error { border-left: 4px solid #dc3545; }\n          .toast-info { border-left: 4px solid #17a2b8; }\n          .toast-warning { border-left: 4px solid #ffc107; }\n          @keyframes slideIn {\n            from { transform: translateX(100%); opacity: 0; }\n            to { transform: translateX(0); opacity: 1; }\n          }\n        ",document.head.appendChild(e)}document.body.appendChild(i),setTimeout((()=>{i.parentElement&&(i.style.animation="slideIn 0.3s ease reverse",setTimeout((()=>i.remove()),300))}),5e3)}}};const Pt=(0,It.A)(Et,[["render",et]]);var Dt=Pt},1939:function(e,t,a){a(8111),a(7588);var i=a(4300);class s{async getDocumentTypes(){try{const e=await i["default"].get("/client/document-requests/document-types");return e.data}catch(e){throw console.error("Error fetching document types:",e),e}}async getPurposeCategories(){try{const e=await i["default"].get("/client/document-requests/purpose-categories");return e.data}catch(e){throw console.error("Error fetching purpose categories:",e),e}}async getPaymentMethods(){try{const e=await i["default"].get("/client/document-requests/payment-methods");return e.data}catch(e){throw console.error("Error fetching payment methods:",e),e}}async submitRequest(e){try{const t=await i["default"].post("/client/document-requests",e);return t.data}catch(t){throw console.error("Error submitting request:",t),t}}async getMyRequests(e={}){try{const t=new URLSearchParams;Object.keys(e).forEach((a=>{null!==e[a]&&void 0!==e[a]&&""!==e[a]&&t.append(a,e[a])}));const a=await i["default"].get(`/client/document-requests?${t.toString()}`);return a.data}catch(t){throw console.error("Error fetching requests:",t),t}}async getRequestDetails(e){try{const t=await i["default"].get(`/client/document-requests/${e}`);return t.data}catch(t){throw console.error("Error fetching request details:",t),t}}async updateRequest(e,t){try{const a=await i["default"].put(`/client/document-requests/${e}`,t);return a.data}catch(a){throw console.error("Error updating request:",a),a}}async cancelRequest(e,t){try{const a=await i["default"].put(`/client/document-requests/${e}/cancel`,{reason:t});return a.data}catch(a){throw console.error("Error cancelling request:",a),a}}async getRequestHistory(e){try{const t=await i["default"].get(`/client/document-requests/${e}/history`);return t.data}catch(t){throw console.error("Error fetching request history:",t),t}}async processPayment(e,t){try{const a=await i["default"].post(`/client/document-requests/${e}/payment`,t);return a.data}catch(a){throw console.error("Error processing payment:",a),a}}async getPaymentStatus(e){try{const t=await i["default"].get(`/client/document-requests/${e}/payment/status`);return t.data}catch(t){throw console.error("Error fetching payment status:",t),t}}async calculateFees(e){try{const t=await i["default"].post("/client/document-requests/calculate-cedula-tax",e);return t.data}catch(t){throw console.error("Error calculating fees:",t),t}}async getDashboardStats(){return{success:!0,data:{total_requests:0,pending_requests:0,completed_requests:0,recent_activity:[]},message:"Dashboard stats placeholder"}}async getRecentActivity(e=10){try{return{success:!0,data:[],message:"Recent activity placeholder"}}catch(t){throw console.error("Error fetching recent activity:",t),t}}async uploadDocuments(e,t){try{const a=new FormData;t.forEach((({type:e,file:t})=>{a.append(e,t)}));const s=await i["default"].post(`/client/document-requests/${e}/documents`,a,{headers:{"Content-Type":"multipart/form-data"}});return s.data}catch(a){throw console.error("Error uploading documents:",a),a}}async getDocuments(e){try{const t=await i["default"].get(`/client/document-requests/${e}/documents`);return t.data}catch(t){throw console.error("Error fetching documents:",t),t}}async deleteDocument(e,t){try{const a=await i["default"].delete(`/client/document-requests/${e}/documents/${t}`);return a.data}catch(a){throw console.error("Error deleting document:",a),a}}async fetchVerificationImageBlob(e,t,a){try{const s=localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token");if(!s)throw new Error("Please log in to view images");console.log("üîó Fetching verification image:",{requestId:e,imageType:t,filename:a,hasToken:!!s});const r=await i["default"].get(`/client/document-requests/${e}/verification-image/${t}/${a}`,{responseType:"blob"});return console.log("‚úÖ Image fetched successfully:",{filename:a,size:r.data.size,type:r.data.type}),r.data}catch(s){throw console.error(`‚ùå Error fetching ${t} verification image:`,{status:s.response?.status,statusText:s.response?.statusText,data:s.response?.data,filename:a,imageType:t,requestId:e,message:s.message}),404===s.response?.status?new Error(`Image not found: ${a}`):401===s.response?.status?new Error("Please log in to view images"):403===s.response?.status?new Error("Access denied to this image"):500===s.response?.status||s.response?.status>=500?new Error("Server error - please contact support"):"NETWORK_ERROR"===s.code||s.message.includes("Network Error")?new Error("Network error - check your connection"):s.message.includes("log in")?new Error(s.message):new Error(s.response?.data?.message||s.message||"Failed to load image")}}async getVerificationImageObjectUrl(e,t,a){try{const i=await this.fetchVerificationImageBlob(e,t,a);return URL.createObjectURL(i)}catch(i){throw console.error(`Error creating object URL for ${t} image:`,i),i}}}t.A=new s}}]);