"use strict";(self["webpackChunkbosfdr"]=self["webpackChunkbosfdr"]||[]).push([[732],{4732:function(e,t,s){s.r(t),s.d(t,{default:function(){return B}});var a=s(6768),r=s(4232);const o={class:"admin-dashboard"},n={class:"dashboard-container"},i={class:"container-fluid p-4"},d={class:"row mb-4"},l={class:"col-12"},c={class:"card shadow"},u={class:"card-body"},h={class:"row"},g={class:"col-lg-4 mb-3"},p={class:"border rounded p-3 h-100"},m={key:0,class:"text-center text-muted py-3"},y={key:1},f={class:"text-muted"},b={class:"fw-bold"},w={class:"text-info"},v=["onClick"],q={key:0,class:"text-center mt-2"},R={class:"col-lg-4 mb-3"},k={class:"border rounded p-3 h-100"},L={class:"mb-2"},A={class:"d-flex justify-content-between"},S={class:"badge bg-warning"},C={class:"progress mb-2",style:{height:"4px"}},D={class:"mb-2"},_={class:"d-flex justify-content-between"},M={class:"badge bg-info"},U={class:"progress mb-2",style:{height:"4px"}},T={class:"mb-2"},$={class:"d-flex justify-content-between"},E={class:"badge bg-success"},x={class:"progress mb-2",style:{height:"4px"}},P={class:"text-center mt-3"};function N(e,t,s,N,I,F){const O=(0,a.g2)("AdminHeader"),j=(0,a.g2)("AdminSidebar");return(0,a.uX)(),(0,a.CE)("div",o,[(0,a.bF)(O,{userName:I.adminData?.first_name||"Admin",showUserDropdown:I.showUserDropdown,sidebarCollapsed:I.sidebarCollapsed,activeMenu:F.activeMenu,onSidebarToggle:F.handleSidebarToggle,onUserDropdownToggle:F.handleUserDropdownToggle,onMenuAction:F.handleMenuAction,onLogout:F.handleLogout},null,8,["userName","showUserDropdown","sidebarCollapsed","activeMenu","onSidebarToggle","onUserDropdownToggle","onMenuAction","onLogout"]),(0,a.Lk)("div",{class:(0,r.C4)(["mobile-overlay",{active:!I.sidebarCollapsed&&I.isMobile}]),onClick:t[0]||(t[0]=(...e)=>F.closeMobileSidebar&&F.closeMobileSidebar(...e))},null,2),(0,a.Lk)("div",n,[(0,a.bF)(j,{collapsed:I.sidebarCollapsed,activeMenu:F.activeMenu,totalUsers:I.stats.totalUsers,pendingRequests:I.stats.activeRequests,totalReports:I.stats.completedToday,onMenuChange:F.handleMenuChange,onLogout:F.handleLogout,onToggleSidebar:F.handleSidebarToggle},null,8,["collapsed","activeMenu","totalUsers","pendingRequests","totalReports","onMenuChange","onLogout","onToggleSidebar"]),(0,a.Lk)("main",{class:(0,r.C4)(["main-content",{"sidebar-collapsed":I.sidebarCollapsed}])},[(0,a.Lk)("div",i,[(0,a.Lk)("div",d,[(0,a.Lk)("div",l,[(0,a.Lk)("div",c,[t[11]||(t[11]=(0,a.Lk)("div",{class:"card-header py-3 d-flex justify-content-between align-items-center"},[(0,a.Lk)("h6",{class:"m-0 font-weight-bold text-primary"},[(0,a.Lk)("i",{class:"fas fa-tasks me-2"}),(0,a.eW)(" Request Management Center ")])],-1)),(0,a.Lk)("div",u,[(0,a.Lk)("div",h,[(0,a.Lk)("div",g,[(0,a.Lk)("div",p,[t[5]||(t[5]=(0,a.Lk)("h6",{class:"text-info mb-3"},[(0,a.Lk)("i",{class:"fas fa-clock me-2"}),(0,a.eW)(" Recent Submissions ")],-1)),0===I.recentRequests.length?((0,a.uX)(),(0,a.CE)("div",m,t[3]||(t[3]=[(0,a.Lk)("i",{class:"fas fa-inbox fa-2x mb-2 text-gray-300"},null,-1),(0,a.Lk)("p",{class:"mb-0"},"No recent submissions",-1)]))):((0,a.uX)(),(0,a.CE)("div",y,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(I.recentRequests.slice(0,3),(e=>((0,a.uX)(),(0,a.CE)("div",{key:e.id,class:"d-flex justify-content-between align-items-center mb-2 p-2 bg-light rounded"},[(0,a.Lk)("div",null,[(0,a.Lk)("small",f,(0,r.v_)(F.formatTimeAgo(e.requested_at)),1),(0,a.Lk)("div",b,(0,r.v_)(e.document_type),1),(0,a.Lk)("small",w,(0,r.v_)(e.client_name),1)]),(0,a.Lk)("button",{class:"btn btn-sm btn-outline-primary",onClick:t=>F.viewRequestDetails(e.id)},t[4]||(t[4]=[(0,a.Lk)("i",{class:"fas fa-eye"},null,-1)]),8,v)])))),128)),I.recentRequests.length>3?((0,a.uX)(),(0,a.CE)("div",q,[(0,a.Lk)("button",{class:"btn btn-sm btn-outline-info",onClick:t[1]||(t[1]=e=>F.navigateToRequests("recent"))}," View "+(0,r.v_)(I.recentRequests.length-3)+" more recent ",1)])):(0,a.Q3)("",!0)]))])]),(0,a.Lk)("div",R,[(0,a.Lk)("div",k,[t[10]||(t[10]=(0,a.Lk)("h6",{class:"text-success mb-3"},[(0,a.Lk)("i",{class:"fas fa-cogs me-2"}),(0,a.eW)(" Processing Overview ")],-1)),(0,a.Lk)("div",L,[(0,a.Lk)("div",A,[t[6]||(t[6]=(0,a.Lk)("span",{class:"small"},"Pending Review",-1)),(0,a.Lk)("span",S,(0,r.v_)(I.stats.pendingRequests||0),1)]),(0,a.Lk)("div",C,[(0,a.Lk)("div",{class:"progress-bar bg-warning",style:(0,r.Tr)({width:F.getProgressPercentage("pending")+"%"})},null,4)])]),(0,a.Lk)("div",D,[(0,a.Lk)("div",_,[t[7]||(t[7]=(0,a.Lk)("span",{class:"small"},"Processing",-1)),(0,a.Lk)("span",M,(0,r.v_)(I.stats.processingRequests||0),1)]),(0,a.Lk)("div",U,[(0,a.Lk)("div",{class:"progress-bar bg-info",style:(0,r.Tr)({width:F.getProgressPercentage("processing")+"%"})},null,4)])]),(0,a.Lk)("div",T,[(0,a.Lk)("div",$,[t[8]||(t[8]=(0,a.Lk)("span",{class:"small"},"Completed",-1)),(0,a.Lk)("span",E,(0,r.v_)(I.stats.completedRequests||0),1)]),(0,a.Lk)("div",x,[(0,a.Lk)("div",{class:"progress-bar bg-success",style:(0,r.Tr)({width:F.getProgressPercentage("completed")+"%"})},null,4)])]),(0,a.Lk)("div",P,[(0,a.Lk)("button",{class:"btn btn-sm btn-success",onClick:t[2]||(t[2]=e=>F.navigateTo("/admin/requests"))},t[9]||(t[9]=[(0,a.Lk)("i",{class:"fas fa-list me-1"},null,-1),(0,a.eW)(" View All Requests ")]))])])])])])])])])])],2)])])}s(4114);var I=s(9197),F=s(9699),O=s(4710),j=s(3237),z=s(2944),J={name:"AdminDashboard",components:{AdminHeader:j.A,AdminSidebar:z.A},data(){return{loading:!0,sidebarCollapsed:!1,showUserDropdown:!1,isMobile:!1,adminData:null,stats:{totalRequests:0,pendingRequests:0,approvedRequests:0,completedRequests:0,processingRequests:0,urgentRequests:0,totalRevenue:0,todayRequests:0,todayRevenue:0,totalUsers:0,activeRequests:0,completedToday:0,pendingApproval:0},recentActivity:[],priorityRequests:[],recentRequests:[],errorMessage:""}},async mounted(){I["default"].isLoggedIn()&&"admin"===I["default"].getUserType()?(this.initializeUI(),await this.loadDashboardData(),this.initializeRealTimeFeatures()):this.$router.push("/login")},beforeUnmount(){this.handleResize&&window.removeEventListener("resize",this.handleResize),this.refreshInterval&&clearInterval(this.refreshInterval),this.cleanupRealTimeFeatures()},computed:{activeMenu(){const e=this.$route.path;return e.includes("/admin/users")?"users":e.includes("/admin/requests")?"requests":e.includes("/admin/reports")?"reports":e.includes("/admin/settings")?"settings":e.includes("/admin/activity-logs")?"activity":e.includes("/admin/profile")?"profile":"dashboard"}},methods:{initializeUI(){if(this.isMobile=window.innerWidth<=768,this.isMobile)this.sidebarCollapsed=!0;else{const e=localStorage.getItem("adminSidebarCollapsed");this.sidebarCollapsed=!!e&&JSON.parse(e)}this.handleResize=()=>{const e=this.isMobile;if(this.isMobile=window.innerWidth<=768,this.isMobile&&!e)this.sidebarCollapsed=!0;else if(!this.isMobile&&e){const e=localStorage.getItem("adminSidebarCollapsed");this.sidebarCollapsed=!!e&&JSON.parse(e)}},window.addEventListener("resize",this.handleResize)},handleSidebarToggle(){this.sidebarCollapsed=!this.sidebarCollapsed,localStorage.setItem("adminSidebarCollapsed",JSON.stringify(this.sidebarCollapsed))},handleMenuChange(e){const t={dashboard:"/admin/dashboard",users:"/admin/users",requests:"/admin/requests",reports:"/admin/reports",settings:"/admin/settings",activity:"/admin/activity-logs",profile:"/admin/profile"};this.isMobile&&(this.sidebarCollapsed=!0),t[e]&&this.$router.push(t[e])},handleUserDropdownToggle(){this.showUserDropdown=!this.showUserDropdown},handleMenuAction(e){"profile"===e?this.$router.push("/admin/profile"):"settings"===e&&this.$router.push("/admin/settings"),this.showUserDropdown=!1},closeMobileSidebar(){this.isMobile&&(this.sidebarCollapsed=!0)},handleLogout(){I["default"].logout(),this.$router.push("/login")},async loadDashboardData(){this.loading=!0;try{await this.loadAdminProfile(),await this.loadDashboardStats(),await this.loadRecentActivity()}catch(e){console.error("Failed to load dashboard data:",e);const t=I["default"].parseError(e);this.errorMessage=t.message||"Failed to load dashboard data",401===t.status&&(I["default"].logout(),this.$router.push("/login"))}finally{this.loading=!1}},async loadAdminProfile(){try{const e=I["default"].getCurrentUser();e&&e.profile?this.adminData=e.profile:this.adminData={first_name:e?.username||"Admin",role:e?.role||"admin"}}catch(e){console.error("Failed to load admin profile:",e);const t=I["default"].getCurrentUser();this.adminData={first_name:t?.username||"Admin",role:t?.role||"admin"}}},async loadDashboardStats(){try{const e=await F.A.getDashboardStats();e.success&&(this.stats={totalRequests:e.data.totalRequests||0,pendingRequests:e.data.pendingRequests||0,approvedRequests:e.data.approvedRequests||0,completedRequests:e.data.completedRequests||0,processingRequests:e.data.processingRequests||0,urgentRequests:e.data.urgentRequests||0,totalRevenue:e.data.totalRevenue||0,todayRequests:e.data.todayRequests||0,todayRevenue:e.data.todayRevenue||0,totalUsers:e.data.totalUsers||0,activeRequests:e.data.pendingRequests||0,completedToday:e.data.todayRequests||0,pendingApproval:e.data.pendingRequests||0}),await this.loadPriorityRequests(),await this.loadRecentRequests()}catch(e){console.error("Failed to load dashboard stats:",e);const t=F.A.parseError(e);this.errorMessage=t.message||"Failed to load dashboard statistics"}},async loadPriorityRequests(){try{const e=await F.A.getAllRequests({priority:"high",limit:5,status:"pending"});e.success&&(this.priorityRequests=e.data.requests||[])}catch(e){console.error("Failed to load priority requests:",e),this.priorityRequests=[]}},async loadRecentRequests(){try{const e=await F.A.getAllRequests({limit:5,sort:"requested_at",order:"desc"});e.success&&(this.recentRequests=e.data.requests||[])}catch(e){console.error("Failed to load recent requests:",e),this.recentRequests=[]}},async loadRecentActivity(){try{const e=await F.A.getRecentActivity(10);e.success&&(this.recentActivity=e.data||[])}catch(e){console.error("Failed to load recent activity:",e);const t=F.A.parseError(e);console.error("Recent activity error details:",t),this.recentActivity=[]}},navigateTo(e){try{console.log("Navigating to:",e),this.$router.push(e)}catch(t){console.error("Navigation error:",t),this.errorMessage="Navigation failed. Please try again."}},formatDate(e){if(!e)return"";const t=new Date(e),s=new Date,a=Math.floor((s-t)/6e4);if(a<1)return"Just now";if(a<60)return`${a} minute${a>1?"s":""} ago`;if(a<1440){const e=Math.floor(a/60);return`${e} hour${e>1?"s":""} ago`}{const e=Math.floor(a/1440);return`${e} day${e>1?"s":""} ago`}},formatTime(e){if(!e)return"";const t=new Date(e);return t.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0})},async refreshDashboard(){await this.loadDashboardData()},exportActivity(){console.log("Exporting activity logs...")},getActivityIcon(e){const t={user_registration:"fas fa-user-plus",document_request:"fas fa-file-alt",document_approved:"fas fa-check-circle",document_rejected:"fas fa-times-circle",system_update:"fas fa-cog",login:"fas fa-sign-in-alt",logout:"fas fa-sign-out-alt",default:"fas fa-info-circle"};return t[e]||t.default},getActivityIconClass(e){const t={user_registration:"bg-success",document_request:"bg-primary",document_approved:"bg-success",document_rejected:"bg-danger",system_update:"bg-warning",login:"bg-info",logout:"bg-secondary",default:"bg-primary"};return t[e]||t.default},getActivityBadgeClass(e){const t={completed:"badge-success",pending:"badge-warning",failed:"badge-danger",in_progress:"badge-info",default:"badge-secondary"};return t[e?.toLowerCase()]||t.default},formatTimeAgo(e){if(!e)return"";const t=new Date(e),s=new Date,a=Math.floor((s-t)/6e4);if(a<1)return"Just now";if(a<60)return`${a}m ago`;if(a<1440){const e=Math.floor(a/60);return`${e}h ago`}{const e=Math.floor(a/1440);return`${e}d ago`}},filterRequestsByStatus(e){this.$router.push({path:"/admin/requests",query:{status:e}})},filterRequestsByDate(e){const t={},s=new Date;"today"===e&&(t.date_from=s.toISOString().split("T")[0],t.date_to=s.toISOString().split("T")[0]),this.$router.push({path:"/admin/requests",query:t})},navigateToRequests(e){const t={};switch(e){case"pending":t.status="pending";break;case"urgent":t.priority="high",t.status="pending";break;case"processing":t.status="processing";break;case"recent":t.sort="requested_at",t.order="desc";break}this.$router.push({path:"/admin/requests",query:t})},viewRequestDetails(e){this.$router.push({path:"/admin/requests",query:{view:e}})},getProgressPercentage(e){const t=this.stats.totalRequests||1;switch(e){case"pending":return Math.round(this.stats.pendingRequests/t*100);case"processing":return Math.round(this.stats.processingRequests/t*100);case"completed":return Math.round(this.stats.completedRequests/t*100);default:return 0}},formatCurrency(e){return e?parseFloat(e).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):"0.00"},async initializeRealTimeFeatures(){console.log("Initializing real-time features for AdminDashboard");try{await O.Ay.init("admin"),O.Ay.on("notification",this.handleRealTimeNotification),O.Ay.on("new_request",this.handleNewRequest),O.Ay.on("request_status_changed",this.handleStatusChange),O.Ay.on("dashboard_update",this.handleDashboardUpdate)}catch(e){console.error("Failed to initialize real-time features:",e)}},cleanupRealTimeFeatures(){console.log("Cleaning up real-time features for AdminDashboard"),O.Ay.off("notification",this.handleRealTimeNotification),O.Ay.off("new_request",this.handleNewRequest),O.Ay.off("request_status_changed",this.handleStatusChange),O.Ay.off("dashboard_update",this.handleDashboardUpdate),O.Ay.cleanup()},handleRealTimeNotification(e){switch(console.log("Dashboard received real-time notification:",e),e.type){case"new_request":this.handleNewRequest(e.data);break;case"request_status_changed":this.handleStatusChange(e.data);break;case"dashboard_update":this.handleDashboardUpdate(e.data);break;default:console.log("Unhandled notification type:",e.type)}},handleNewRequest(e){console.log("New request received on dashboard:",e),this.stats.totalRequests++,this.stats.pendingRequests++,this.stats.todayRequests++,this.loadDashboardStats(),this.loadRecentActivity(),this.loadRecentRequests()},handleStatusChange(e){console.log("Request status changed on dashboard:",e),this.loadDashboardStats(),this.loadRecentActivity(),this.loadPriorityRequests(),this.loadRecentRequests()},handleDashboardUpdate(e){console.log("Dashboard update received:",e),this.loadDashboardData()}},created(){this.refreshInterval=setInterval((()=>{this.loadDashboardStats(),this.loadRecentActivity(),this.loadPriorityRequests(),this.loadRecentRequests()}),3e5)}},W=s(1241);const X=(0,W.A)(J,[["render",N],["__scopeId","data-v-0abd7478"]]);var B=X},9699:function(e,t,s){var a=s(4300);class r{async getDashboardStats(){try{const e=await a["default"].get("/admin/documents/dashboard/stats");return e.data}catch(e){throw this.handleError(e)}}async getRecentActivity(e=10){try{const t=await a["default"].get(`/admin/documents/dashboard/recent?limit=${e}`);return t.data}catch(t){throw this.handleError(t)}}async getAllRequests(e={}){try{const t=new URLSearchParams(e).toString(),s=await a["default"].get(`/admin/documents/requests?${t}`);return s.data}catch(t){throw this.handleError(t)}}async getRequestDetails(e){try{const t=await a["default"].get(`/admin/documents/requests/${e}`);return t.data}catch(t){throw this.handleError(t)}}async getRequestHistory(e){try{const t=await a["default"].get(`/admin/documents/requests/${e}/history`);return t.data}catch(t){throw this.handleError(t)}}async getStatusOptions(){try{const e=await a["default"].get("/admin/documents/status-options");return e.data}catch(e){throw this.handleError(e)}}async getDocumentTypes(){try{const e=await a["default"].get("/admin/documents/document-types");return e.data}catch(e){throw this.handleError(e)}}async updateRequestStatus(e,t){try{const s=await a["default"].put(`/admin/documents/requests/${e}/status`,t);return s.data}catch(s){throw this.handleError(s)}}async approveRequest(e,t={}){try{const s=await a["default"].post(`/admin/documents/requests/${e}/approve`,t);return s.data}catch(s){throw this.handleError(s)}}async rejectRequest(e,t){try{const s=await a["default"].post(`/admin/documents/requests/${e}/reject`,t);return s.data}catch(s){throw this.handleError(s)}}async markAsProcessing(e,t={}){try{const s=await a["default"].post(`/admin/documents/requests/${e}/process`,t);return s.data}catch(s){throw this.handleError(s)}}async markAsCompleted(e,t={}){try{const s=await a["default"].post(`/admin/documents/requests/${e}/complete`,t);return s.data}catch(s){throw this.handleError(s)}}async bulkUpdateRequests(e){try{const t=await a["default"].post("/admin/documents/requests/bulk-update",e);return t.data}catch(t){throw this.handleError(t)}}async exportRequests(e={}){try{const t=new URLSearchParams(e).toString(),s=await a["default"].get(`/admin/documents/requests/export?${t}`,{responseType:"text"});return s.data}catch(t){throw this.handleError(t)}}downloadCSV(e,t="document_requests.csv"){const s=new Blob([e],{type:"text/csv;charset=utf-8;"}),a=document.createElement("a"),r=URL.createObjectURL(s);a.setAttribute("href",r),a.setAttribute("download",t),a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(r)}async getAnalyticsData(e="month"){try{const t=await a["default"].get(`/admin/documents/analytics?period=${e}`);return t.data}catch(t){throw this.handleError(t)}}async generateReport(e,t={}){try{const s=new URLSearchParams(t).toString(),r=await a["default"].get(`/admin/documents/reports/${e}?${s}`,{responseType:"csv"===t.format?"text":"json"});return r.data}catch(s){throw this.handleError(s)}}async verifyInPersonPayment(e,t){try{const s=await a["default"].post(`/admin/documents/requests/${e}/verify-payment`,t);return s.data}catch(s){throw this.handleError(s)}}async schedulePickup(e,t){try{const s=await a["default"].post(`/admin/documents/requests/${e}/schedule-pickup`,t);return s.data}catch(s){throw this.handleError(s)}}async confirmPickup(e,t){try{const s=await a["default"].post(`/admin/documents/requests/${e}/confirm-pickup`,t);return s.data}catch(s){throw this.handleError(s)}}async downloadReport(e,t={}){try{const s=await this.generateReport(e,{...t,format:"csv"}),a=`${e}_report_${(new Date).toISOString().split("T")[0]}.csv`;this.downloadCSV(s,a)}catch(s){throw this.handleError(s)}}formatStatus(e){return e?e.replace(/_/g," ").replace(/\b\w/g,(e=>e.toUpperCase())):"Unknown"}getStatusColor(e){const t={pending:"warning",under_review:"info",additional_info_required:"secondary",approved:"success",processing:"primary",ready_for_pickup:"info",completed:"success",cancelled:"secondary",rejected:"danger"};return t[e]||"secondary"}handleError(e){if(e.response){const t=e.response.data?.message||"An error occurred",s=e.response.data?.errors||[];return new Error(JSON.stringify({message:t,errors:s,status:e.response.status}))}return e.request?new Error(JSON.stringify({message:"Network error. Please check your connection.",errors:[],status:0})):new Error(JSON.stringify({message:e.message||"An unexpected error occurred",errors:[],status:0}))}parseError(e){try{return JSON.parse(e.message)}catch{return{message:e.message,errors:[],status:0}}}}t.A=new r}}]);