"use strict";(self["webpackChunkbosfdr"]=self["webpackChunkbosfdr"]||[]).push([[599],{2599:function(e,t,a){a(4114),a(8111),a(116),a(7588);var n=a(4300);class r{async getPaymentConfig(){try{const e=await n["default"].get("/payments/config");return e.data}catch(e){throw console.error("Failed to get payment config:",e),e}}async initiatePayment(e){try{const t=await n["default"].post("/payments/initiate",e);return t.data}catch(t){throw console.error("Failed to initiate payment:",t),t}}async getPaymentStatus(e){try{const t=await n["default"].get(`/payments/status/${e}`);return t.data}catch(t){throw console.error("Failed to get payment status:",t),t}}async getPaymentVerificationQueue(){try{const e=await n["default"].get("/admin/documents/payment-verification-queue");return e.data}catch(e){throw console.error("Failed to get payment verification queue:",e),e}}async verifyInPersonPayment(e,t){try{const a=await n["default"].post(`/admin/documents/requests/${e}/verify-payment`,t);return a.data}catch(a){throw console.error("Failed to verify in-person payment:",a),a}}redirectToPayMongo(e){if(!e)throw new Error("Invalid checkout URL");window.location.href=e}formatAmount(e){return new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(e)}getPaymentMethodDisplayName(e){const t={CASH:"Cash Payment",ONLINE_PAYMENT_GROUP:"Online Payment",PAYMONGO_CARD:"Credit/Debit Card",PAYMONGO_GCASH:"GCash",PAYMONGO_GRABPAY:"GrabPay",PAYMONGO_PAYMAYA:"Maya (PayMaya)",PAYMONGO_BANK:"Bank Transfer"};return t[e]||e}groupPaymentMethods(e){if(!Array.isArray(e))return[];const t=[],a=[];e.forEach((e=>{this.isOnlinePaymentMethod(e.method_code)?a.push(e):t.push(e)}));const n=[];return t.forEach((e=>{n.push({id:e.id,method_name:e.method_name,method_code:e.method_code,description:e.description,is_online:e.is_online,is_active:e.is_active,processing_fee_percentage:e.processing_fee_percentage,processing_fee_fixed:e.processing_fee_fixed,group_type:"individual"})})),a.length>0&&n.push({id:"ONLINE_PAYMENT_GROUP",method_name:"Online Payment",method_code:"ONLINE_PAYMENT_GROUP",description:"Pay securely online using credit/debit card, GCash, GrabPay, Maya, or bank transfer",is_online:!0,is_active:!0,processing_fee_percentage:a[0]?.processing_fee_percentage||0,processing_fee_fixed:a[0]?.processing_fee_fixed||0,group_type:"group",grouped_methods:a}),n}getActualPaymentMethodId(e,t){if("ONLINE_PAYMENT_GROUP"===e){const e=["PAYMONGO_CARD","PAYMONGO_GCASH","PAYMONGO_GRABPAY","PAYMONGO_PAYMAYA","PAYMONGO_BANK"];for(const n of e){const e=t.find((e=>e.method_code===n&&e.is_active));if(e)return e.id}const a=t.find((e=>this.isOnlinePaymentMethod(e.method_code)&&e.is_active));return a?a.id:null}return parseInt(e)}isOnlinePaymentMethod(e){return e&&e.startsWith("PAYMONGO_")}getPaymentStatusDisplay(e){const t={pending:{text:"Pending",color:"warning",icon:"clock"},succeeded:{text:"Paid",color:"success",icon:"check-circle"},failed:{text:"Failed",color:"danger",icon:"x-circle"},cancelled:{text:"Cancelled",color:"secondary",icon:"x"}};return t[e]||{text:e,color:"secondary",icon:"help-circle"}}calculateProcessingFee(e,t=0,a=0){const n=e*t/100;return n+a}calculateTotalAmount(e,t=0,a=0){const n=this.calculateProcessingFee(e,t,a),r=e+n;return{baseAmount:e,processingFee:n,totalAmount:r,formattedBase:this.formatAmount(e),formattedFee:this.formatAmount(n),formattedTotal:this.formatAmount(r)}}validatePaymentData(e){const t=[];return e.request_id||t.push("Request ID is required"),e.payment_method_id||t.push("Payment method is required"),e.customer_email&&!this.isValidEmail(e.customer_email)&&t.push("Invalid email format"),{isValid:0===t.length,errors:t}}isValidEmail(e){const t=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;return t.test(e)}getErrorMessage(e){return e.response?.data?.message?e.response.data.message:400===e.response?.status?"Invalid payment information. Please check your details and try again.":401===e.response?.status?"You need to be logged in to make a payment.":404===e.response?.status?"Payment service not found. Please contact support.":e.response?.status>=500?"Payment service is temporarily unavailable. Please try again later.":e.message||"An unexpected error occurred during payment processing."}}t["default"]=new r}}]);