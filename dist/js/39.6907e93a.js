"use strict";(self["webpackChunkbosfdr"]=self["webpackChunkbosfdr"]||[]).push([[39],{4039:function(e,t,a){a.d(t,{A:function(){return J}});var s=a(6768),i=a(4232);const o={class:"modal fade",id:"authorizedPickupDocumentsModal",tabindex:"-1","aria-labelledby":"authorizedPickupDocumentsModalLabel","aria-hidden":"true"},r={class:"modal-dialog modal-xl modal-dialog-scrollable"},l={class:"modal-content"},c={class:"modal-body"},n={key:0},u={class:"row mb-4"},d={class:"col-12"},p={class:"card bg-light"},k={class:"card-body"},h={class:"row"},m={class:"col-md-6"},g={key:0,class:"row mb-4"},L={class:"col-12"},v={class:"card"},b={class:"card-body"},f={class:"row"},_={class:"col-md-6"},y={class:"col-md-6"},z={class:"row"},w={class:"col-12"},D={key:0,class:"text-center py-4"},q={key:1,class:"alert alert-danger"},C={key:2,class:"text-center py-4"},E={key:3,class:"row"},P={key:0,class:"col-md-6 mb-3"},U={class:"card h-100 document-card"},W=["src"],x={key:1,class:"loading-preview"},A={class:"card-body"},X={class:"card-text"},I={class:"d-grid"},R={key:1,class:"col-md-6 mb-3"},$={class:"card h-100 document-card"},B=["src"],j={key:1,class:"loading-preview"},M={class:"card-body"},T={class:"card-text"},V={class:"d-grid"},F={class:"modal-footer"},N={key:0,class:"ms-auto"},S={key:1,class:"ms-auto"};function O(e,t,a,O,Q,G){return(0,s.uX)(),(0,s.CE)("div",o,[(0,s.Lk)("div",r,[(0,s.Lk)("div",l,[t[36]||(t[36]=(0,s.Lk)("div",{class:"modal-header"},[(0,s.Lk)("h5",{class:"modal-title",id:"authorizedPickupDocumentsModalLabel"},[(0,s.Lk)("i",{class:"fas fa-hand-paper me-2"}),(0,s.eW)(" Authorized Pickup Documents Review ")]),(0,s.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),(0,s.Lk)("div",c,[a.request?((0,s.uX)(),(0,s.CE)("div",n,[(0,s.Lk)("div",u,[(0,s.Lk)("div",d,[(0,s.Lk)("div",p,[(0,s.Lk)("div",k,[t[9]||(t[9]=(0,s.Lk)("h6",{class:"card-title mb-3"},[(0,s.Lk)("i",{class:"fas fa-file-alt me-2"}),(0,s.eW)(" Request Information ")],-1)),(0,s.Lk)("div",h,[(0,s.Lk)("div",m,[(0,s.Lk)("p",null,[t[6]||(t[6]=(0,s.Lk)("strong",null,"Request Number:",-1)),(0,s.eW)(" "+(0,i.v_)(a.request.request_number),1)]),(0,s.Lk)("p",null,[t[7]||(t[7]=(0,s.Lk)("strong",null,"Document Type:",-1)),(0,s.eW)(" "+(0,i.v_)(a.request.document_type),1)]),(0,s.Lk)("p",null,[t[8]||(t[8]=(0,s.Lk)("strong",null,"Requestor:",-1)),(0,s.eW)(" "+(0,i.v_)(a.request.client_name),1)])])])])])])]),a.request.authorized_pickup?((0,s.uX)(),(0,s.CE)("div",g,[(0,s.Lk)("div",L,[(0,s.Lk)("div",v,[t[13]||(t[13]=(0,s.Lk)("div",{class:"card-header bg-warning-subtle"},[(0,s.Lk)("h6",{class:"mb-0"},[(0,s.Lk)("i",{class:"fas fa-user me-2"}),(0,s.eW)(" Authorized Pickup Person Details ")])],-1)),(0,s.Lk)("div",b,[(0,s.Lk)("div",f,[(0,s.Lk)("div",_,[(0,s.Lk)("p",null,[t[10]||(t[10]=(0,s.Lk)("strong",null,"Full Name:",-1)),(0,s.eW)(" "+(0,i.v_)(a.request.authorized_pickup.full_name),1)]),(0,s.Lk)("p",null,[t[11]||(t[11]=(0,s.Lk)("strong",null,"Phone:",-1)),(0,s.eW)(" "+(0,i.v_)(a.request.authorized_pickup.phone_number||"Not provided"),1)])]),(0,s.Lk)("div",y,[(0,s.Lk)("p",null,[t[12]||(t[12]=(0,s.Lk)("strong",null,"Relationship:",-1)),(0,s.eW)(" "+(0,i.v_)(a.request.authorized_pickup.relationship_to_beneficiary),1)])])])])])])])):(0,s.Q3)("",!0),(0,s.Lk)("div",z,[(0,s.Lk)("div",w,[t[33]||(t[33]=(0,s.Lk)("h6",{class:"mb-3"},[(0,s.Lk)("i",{class:"fas fa-folder-open me-2"}),(0,s.eW)(" Uploaded Documents ")],-1)),Q.loading?((0,s.uX)(),(0,s.CE)("div",D,t[14]||(t[14]=[(0,s.Lk)("div",{class:"spinner-border text-primary",role:"status"},[(0,s.Lk)("span",{class:"visually-hidden"},"Loading documents...")],-1),(0,s.Lk)("p",{class:"mt-2"},"Loading documents...",-1)]))):Q.error?((0,s.uX)(),(0,s.CE)("div",q,[t[15]||(t[15]=(0,s.Lk)("i",{class:"fas fa-exclamation-triangle me-2"},null,-1)),(0,s.eW)(" "+(0,i.v_)(Q.error),1)])):G.hasDocuments?((0,s.uX)(),(0,s.CE)("div",E,[a.request.authorized_pickup?.id_image_path?((0,s.uX)(),(0,s.CE)("div",P,[(0,s.Lk)("div",U,[(0,s.Lk)("div",{class:"card-img-top document-preview",onClick:t[1]||(t[1]=e=>G.viewDocument("pickup-id"))},[Q.documentBlobUrls["pickup-id"]?((0,s.uX)(),(0,s.CE)("img",{key:0,src:Q.documentBlobUrls["pickup-id"],alt:"Pickup Person ID",class:"preview-image",onError:t[0]||(t[0]=(...e)=>G.handleImageError&&G.handleImageError(...e))},null,40,W)):((0,s.uX)(),(0,s.CE)("div",x,t[17]||(t[17]=[(0,s.Lk)("div",{class:"spinner-border spinner-border-sm",role:"status"},[(0,s.Lk)("span",{class:"sr-only"},"Loading...")],-1)]))),t[18]||(t[18]=(0,s.Lk)("div",{class:"preview-overlay"},[(0,s.Lk)("i",{class:"fas fa-eye fa-2x"})],-1))]),t[24]||(t[24]=(0,s.Lk)("div",{class:"card-header d-flex justify-content-between align-items-center"},[(0,s.Lk)("h6",{class:"mb-0"},[(0,s.Lk)("i",{class:"fas fa-id-card me-2"}),(0,s.eW)(" ID Document ")])],-1)),(0,s.Lk)("div",A,[(0,s.Lk)("p",X,[t[19]||(t[19]=(0,s.Lk)("strong",null,"File:",-1)),(0,s.eW)(" "+(0,i.v_)(G.getFileName(a.request.authorized_pickup?.id_image_path)),1),t[20]||(t[20]=(0,s.Lk)("br",null,null,-1)),t[21]||(t[21]=(0,s.Lk)("strong",null,"Type:",-1)),t[22]||(t[22]=(0,s.eW)(" Government-issued ID "))]),(0,s.Lk)("div",I,[(0,s.Lk)("button",{class:"btn btn-outline-primary btn-sm",onClick:t[2]||(t[2]=e=>G.viewDocument("pickup-id"))},t[23]||(t[23]=[(0,s.Lk)("i",{class:"fas fa-eye me-1"},null,-1),(0,s.eW)(" View Document ")]))])])])])):(0,s.Q3)("",!0),a.request.authorized_pickup?.authorization_letter_path?((0,s.uX)(),(0,s.CE)("div",R,[(0,s.Lk)("div",$,[(0,s.Lk)("div",{class:"card-img-top document-preview",onClick:t[4]||(t[4]=e=>G.viewDocument("pickup-auth"))},[Q.documentBlobUrls["pickup-auth"]?((0,s.uX)(),(0,s.CE)("img",{key:0,src:Q.documentBlobUrls["pickup-auth"],alt:"Authorization Letter",class:"preview-image",onError:t[3]||(t[3]=(...e)=>G.handleImageError&&G.handleImageError(...e))},null,40,B)):((0,s.uX)(),(0,s.CE)("div",j,t[25]||(t[25]=[(0,s.Lk)("div",{class:"spinner-border spinner-border-sm",role:"status"},[(0,s.Lk)("span",{class:"sr-only"},"Loading...")],-1)]))),t[26]||(t[26]=(0,s.Lk)("div",{class:"preview-overlay"},[(0,s.Lk)("i",{class:"fas fa-eye fa-2x"})],-1))]),t[32]||(t[32]=(0,s.Lk)("div",{class:"card-header d-flex justify-content-between align-items-center"},[(0,s.Lk)("h6",{class:"mb-0"},[(0,s.Lk)("i",{class:"fas fa-file-signature me-2"}),(0,s.eW)(" Authorization Letter ")])],-1)),(0,s.Lk)("div",M,[(0,s.Lk)("p",T,[t[27]||(t[27]=(0,s.Lk)("strong",null,"File:",-1)),(0,s.eW)(" "+(0,i.v_)(G.getFileName(a.request.authorized_pickup?.authorization_letter_path)),1),t[28]||(t[28]=(0,s.Lk)("br",null,null,-1)),t[29]||(t[29]=(0,s.Lk)("strong",null,"Type:",-1)),t[30]||(t[30]=(0,s.eW)(" Signed authorization letter "))]),(0,s.Lk)("div",V,[(0,s.Lk)("button",{class:"btn btn-outline-primary btn-sm",onClick:t[5]||(t[5]=e=>G.viewDocument("pickup-auth"))},t[31]||(t[31]=[(0,s.Lk)("i",{class:"fas fa-eye me-1"},null,-1),(0,s.eW)(" View Document ")]))])])])])):(0,s.Q3)("",!0)])):((0,s.uX)(),(0,s.CE)("div",C,t[16]||(t[16]=[(0,s.Lk)("i",{class:"fas fa-file-slash fa-3x text-muted mb-3"},null,-1),(0,s.Lk)("p",{class:"text-muted"},"No pickup authorization documents found for this request.",-1)])))])])])):(0,s.Q3)("",!0)]),(0,s.Lk)("div",F,[t[35]||(t[35]=(0,s.Lk)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close",-1)),G.hasDocuments&&G.canVerify?((0,s.uX)(),(0,s.CE)("div",N)):G.isVerified?((0,s.uX)(),(0,s.CE)("div",S,t[34]||(t[34]=[(0,s.Lk)("span",{class:"badge bg-success fs-6"},[(0,s.Lk)("i",{class:"fas fa-check me-1"}),(0,s.eW)(" Documents Verified ")],-1)]))):(0,s.Q3)("",!0)])])])])}a(8111),a(7588);var Q={name:"AuthorizedPickupDocumentsModal",props:{request:{type:Object,default:null},processing:{type:Boolean,default:!1}},emits:["verify","reject"],data(){return{loading:!1,error:null,documentBlobUrls:{}}},computed:{hasDocuments(){return this.request?.authorized_pickup&&(this.request.authorized_pickup.id_image_path||this.request.authorized_pickup.authorization_letter_path)},canVerify(){return"verified"!==this.request?.authorized_pickup?.verification_status},isVerified(){return"verified"===this.request?.authorized_pickup?.verification_status}},watch:{request:{handler(e){e&&(console.log("AuthorizedPickupDocumentsModal - Request data:",e),console.log("AuthorizedPickupDocumentsModal - Authorized pickup:",e.authorized_pickup),e.authorized_pickup&&(console.log("AuthorizedPickupDocumentsModal - ID image path:",e.authorized_pickup.id_image_path),console.log("AuthorizedPickupDocumentsModal - Auth letter path:",e.authorized_pickup.authorization_letter_path),console.log("AuthorizedPickupDocumentsModal - Pickup person ID:",e.authorized_pickup.id)),this.loadDocuments())},immediate:!0}},methods:{async loadDocuments(){if(this.request&&this.hasDocuments){this.loading=!0,this.error=null,this.documentBlobUrls={};try{this.request.authorized_pickup?.id_image_path&&await this.loadDocument("pickup-id",this.request.authorized_pickup.id_image_path),this.request.authorized_pickup?.authorization_letter_path&&await this.loadDocument("pickup-auth",this.request.authorized_pickup.authorization_letter_path)}catch(e){console.error("Error loading pickup documents:",e),this.error="Failed to load documents. Please try again."}finally{this.loading=!1}}},async loadDocument(e,t){try{console.log(`Loading ${e} document from path: "${t}"`);const a=this.convertPathToUrl(t);if(console.log(`Converted to web URL: ${a}`),!a)return void console.error("Could not convert path to URL");const s=await fetch(`http://localhost:7000${a}`);if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const i=await s.blob(),o=URL.createObjectURL(i);this.documentBlobUrls[e]=o,console.log(`Successfully loaded ${e} document`)}catch(a){console.error(`Error loading ${e} document:`,a),console.error(`Failed URL: http://localhost:7000${this.convertPathToUrl(t)}`)}},convertPathToUrl(e){if(!e)return null;let t=e;return t=t.replace(/\\/g,"/"),t.startsWith("/")||(t="/"+t),console.log(`Path conversion: "${e}" -> "${t}"`),t},viewDocument(e){let t="";switch(e){case"pickup-id":t=this.request.authorized_pickup?.id_image_path;break;case"pickup-auth":t=this.request.authorized_pickup?.authorization_letter_path;break;default:return}if(!t)return;const a=this.convertPathToUrl(t),s=`http://localhost:7000${a}`;console.log(`Opening document: ${s}`),a&&window.open(s,"_blank")},getFileName(e){return e?e.split("/").pop():"Unknown"},getStatusBadgeClass(e){const t={pending:"bg-warning text-dark",processing:"bg-info",approved:"bg-success",rejected:"bg-danger",completed:"bg-success"};return t[e?.toLowerCase()]||"bg-secondary"},getVerificationStatusClass(e){const t={pending:"bg-warning text-dark",verified:"bg-success",rejected:"bg-danger"};return t[e?.toLowerCase()]||"bg-secondary"},formatVerificationStatus(e){return e?e.charAt(0).toUpperCase()+e.slice(1):"Pending"},formatDate(e){return e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A"},handleImageError(e){console.error("Image failed to load:",e.target.src),e.target.style.display="none"}},beforeUnmount(){Object.values(this.documentBlobUrls).forEach((e=>{URL.revokeObjectURL(e)}))}},G=a(1241);const H=(0,G.A)(Q,[["render",O],["__scopeId","data-v-3d789a00"]]);var J=H}}]);