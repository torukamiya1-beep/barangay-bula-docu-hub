"use strict";(self["webpackChunkbosfdr"]=self["webpackChunkbosfdr"]||[]).push([[76],{1268:function(e,t,a){var s=a(4300);class o{async checkRequestExists(e,t="client"){try{console.log(`üîç Checking if request ${e} exists for ${t}`);const a="admin"===t?`/admin/documents/requests/${e}/exists`:`/client/document-requests/${e}/exists`,o=await s["default"].get(a);return o.data&&o.data.success?(console.log(`‚úÖ Request ${e} exists and is accessible`),!0):(console.log(`‚ùå Request ${e} does not exist or is not accessible`),!1)}catch(a){return console.error("‚ùå Error checking request existence:",a),a.response&&404===a.response.status?!1:(console.log("‚ö†Ô∏è Assuming request exists due to error"),!0)}}async checkUserExists(e){try{console.log(`üîç Checking if user ${e} exists`);const t=await s["default"].get(`/admin/users/${e}/exists`);return t.data&&t.data.success?(console.log(`‚úÖ User ${e} exists and is accessible`),!0):(console.log(`‚ùå User ${e} does not exist or is not accessible`),!1)}catch(t){return console.error("‚ùå Error checking user existence:",t),t.response&&404===t.response.status?!1:(console.log("‚ö†Ô∏è Assuming user exists due to error"),!0)}}parseNotificationData(e){try{let t={};return e.data&&("string"===typeof e.data?t=JSON.parse(e.data):"object"===typeof e.data&&(t=e.data)),{requestId:t.request_id||null,userId:t.user_id||t.client_id||null,userType:t.user_type||null,requestNumber:t.request_number||null,documentType:t.document_type||null,priority:t.priority||null,...t}}catch(t){return console.error("‚ùå Error parsing notification data:",t),{}}}showNavigationError(e,t){console.error("üö® Navigation Error:",e),"function"===typeof t&&t("error",e)}getNotificationIcon(e,t="client"){const a={new_request:"fas fa-file-plus text-success",status_change:"fas fa-sync-alt text-info",request_update:"fas fa-edit text-warning",request_cancelled:"fas fa-times-circle text-danger",payment_confirmed:"fas fa-check-circle text-success",payment_update:"fas fa-money-bill text-info",system_alert:"fas fa-exclamation-triangle text-danger",urgent_request:"fas fa-exclamation-circle text-danger",user_registration:"fas fa-user-plus text-info",new_user:"fas fa-user-check text-success",test:"fas fa-vial text-secondary",connection:"fas fa-plug text-success"},s={status_change:"fas fa-sync-alt text-info",payment_confirmed:"fas fa-credit-card text-success",payment_required:"fas fa-money-bill text-warning",payment_update:"fas fa-money-bill text-info",document_ready:"fas fa-file-check text-success",ready_for_pickup:"fas fa-hand-paper text-success",request_approved:"fas fa-check-circle text-success",request_rejected:"fas fa-times-circle text-danger",request_update:"fas fa-edit text-warning",system_alert:"fas fa-exclamation-triangle text-danger",maintenance_notice:"fas fa-tools text-warning",test:"fas fa-vial text-secondary",connection:"fas fa-plug text-success"},o="admin"===t?a:s;return o[e]||"fas fa-bell text-primary"}formatNotificationTime(e){if(!e)return"";try{const t=new Date(e),a=new Date,s=Math.floor((a-t)/6e4);if(s<1)return"Just now";if(s<60)return`${s}m ago`;const o=Math.floor(s/60);if(o<24)return`${o}h ago`;const n=Math.floor(o/24);return n<7?`${n}d ago`:t.toLocaleDateString()}catch(t){return console.error("Error formatting notification time:",t),""}}}t.A=new o},1939:function(e,t,a){a(8111),a(7588);var s=a(4300);class o{async getDocumentTypes(){try{const e=await s["default"].get("/client/document-requests/document-types");return e.data}catch(e){throw console.error("Error fetching document types:",e),e}}async getPurposeCategories(){try{const e=await s["default"].get("/client/document-requests/purpose-categories");return e.data}catch(e){throw console.error("Error fetching purpose categories:",e),e}}async getPaymentMethods(){try{const e=await s["default"].get("/client/document-requests/payment-methods");return e.data}catch(e){throw console.error("Error fetching payment methods:",e),e}}async submitRequest(e){try{const t=await s["default"].post("/client/document-requests",e);return t.data}catch(t){throw console.error("Error submitting request:",t),t}}async getMyRequests(e={}){try{const t=new URLSearchParams;Object.keys(e).forEach((a=>{null!==e[a]&&void 0!==e[a]&&""!==e[a]&&t.append(a,e[a])}));const a=await s["default"].get(`/client/document-requests?${t.toString()}`);return a.data}catch(t){throw console.error("Error fetching requests:",t),t}}async getRequestDetails(e){try{const t=await s["default"].get(`/client/document-requests/${e}`);return t.data}catch(t){throw console.error("Error fetching request details:",t),t}}async updateRequest(e,t){try{const a=await s["default"].put(`/client/document-requests/${e}`,t);return a.data}catch(a){throw console.error("Error updating request:",a),a}}async cancelRequest(e,t){try{const a=await s["default"].put(`/client/document-requests/${e}/cancel`,{reason:t});return a.data}catch(a){throw console.error("Error cancelling request:",a),a}}async getRequestHistory(e){try{const t=await s["default"].get(`/client/document-requests/${e}/history`);return t.data}catch(t){throw console.error("Error fetching request history:",t),t}}async processPayment(e,t){try{const a=await s["default"].post(`/client/document-requests/${e}/payment`,t);return a.data}catch(a){throw console.error("Error processing payment:",a),a}}async getPaymentStatus(e){try{const t=await s["default"].get(`/client/document-requests/${e}/payment/status`);return t.data}catch(t){throw console.error("Error fetching payment status:",t),t}}async calculateFees(e){try{const t=await s["default"].post("/client/document-requests/calculate-cedula-tax",e);return t.data}catch(t){throw console.error("Error calculating fees:",t),t}}async getDashboardStats(){return{success:!0,data:{total_requests:0,pending_requests:0,completed_requests:0,recent_activity:[]},message:"Dashboard stats placeholder"}}async getRecentActivity(e=10){try{return{success:!0,data:[],message:"Recent activity placeholder"}}catch(t){throw console.error("Error fetching recent activity:",t),t}}async uploadDocuments(e,t){try{const a=new FormData;t.forEach((({type:e,file:t})=>{a.append(e,t)}));const o=await s["default"].post(`/client/document-requests/${e}/documents`,a,{headers:{"Content-Type":"multipart/form-data"}});return o.data}catch(a){throw console.error("Error uploading documents:",a),a}}async getDocuments(e){try{const t=await s["default"].get(`/client/document-requests/${e}/documents`);return t.data}catch(t){throw console.error("Error fetching documents:",t),t}}async deleteDocument(e,t){try{const a=await s["default"].delete(`/client/document-requests/${e}/documents/${t}`);return a.data}catch(a){throw console.error("Error deleting document:",a),a}}async fetchVerificationImageBlob(e,t,a){try{const o=localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token");if(!o)throw new Error("Please log in to view images");console.log("üîó Fetching verification image:",{requestId:e,imageType:t,filename:a,hasToken:!!o});const n=await s["default"].get(`/client/document-requests/${e}/verification-image/${t}/${a}`,{responseType:"blob"});return console.log("‚úÖ Image fetched successfully:",{filename:a,size:n.data.size,type:n.data.type}),n.data}catch(o){throw console.error(`‚ùå Error fetching ${t} verification image:`,{status:o.response?.status,statusText:o.response?.statusText,data:o.response?.data,filename:a,imageType:t,requestId:e,message:o.message}),404===o.response?.status?new Error(`Image not found: ${a}`):401===o.response?.status?new Error("Please log in to view images"):403===o.response?.status?new Error("Access denied to this image"):500===o.response?.status||o.response?.status>=500?new Error("Server error - please contact support"):"NETWORK_ERROR"===o.code||o.message.includes("Network Error")?new Error("Network error - check your connection"):o.message.includes("log in")?new Error(o.message):new Error(o.response?.data?.message||o.message||"Failed to load image")}}async getVerificationImageObjectUrl(e,t,a){try{const s=await this.fetchVerificationImageBlob(e,t,a);return URL.createObjectURL(s)}catch(s){throw console.error(`Error creating object URL for ${t} image:`,s),s}}}t.A=new o},4230:function(e,t,a){e.exports=a.p+"img/icon-of-bula.fe10b6ab.jpg"},5248:function(e,t,a){var s=a(4300);class o{async getResidencyVerificationStatus(){try{const e=await s["default"].get("/residency/verification-status");return e.data.success?{success:!0,status:e.data.data.status,canRequestDocuments:e.data.data.canRequestDocuments,message:e.data.data.message,documents:e.data.data.documents||[]}:{success:!1,status:"unknown",canRequestDocuments:!1,message:e.data.message||"Failed to get verification status",documents:[]}}catch(e){return console.error("Error getting residency verification status:",e),{success:!1,status:"no_documents",canRequestDocuments:!1,message:"Please upload residency documents for verification",documents:[]}}}async canRequestDocuments(){const e=await this.getResidencyVerificationStatus();return e.canRequestDocuments}async getStatusMessage(){const e=await this.getResidencyVerificationStatus();switch(e.status){case"approved":return"Your residency has been verified. You can now request documents.";case"pending":return"Your residency documents are under review. You cannot request documents yet.";case"rejected":return"Your residency document is rejected.";case"no_documents":return"Please upload residency documents for verification before requesting documents.";default:return"Unable to determine residency verification status."}}async getStatusClass(){const e=await this.getResidencyVerificationStatus();switch(e.status){case"approved":return"status-approved";case"pending":return"status-pending";case"rejected":return"status-rejected";case"no_documents":return"status-no-documents";default:return"status-unknown"}}}t.A=new o},8076:function(e,t,a){a.r(t),a.d(t,{default:function(){return jt}});var s=a(6768),o=a(4232),n=a(5130);const i={class:"document-request-page"},r={class:"page-content-wrapper"},c={class:"quick-actions-section"},l={class:"container"},u={class:"quick-actions-grid",style:{display:"flex",gap:"1rem"}},d=["disabled"],f={class:"action-content"},m={key:0,class:"action-description"},h={key:1,class:"action-description"},p=["disabled"],g={class:"action-content"},y={key:0,class:"action-description"},v={key:1,class:"action-description"},k={class:"page-footer"},w={class:"container"},b={class:"footer-content"},q={class:"footer-actions"},D={class:"dialog-header"},C={class:"dialog-body"},L={class:"help-sections"},R={class:"help-section"},E={class:"requirements-list"},_={class:"help-section"},N={class:"process-steps"},S={class:"step-number"},A={class:"step-content"};function T(e,t,a,T,x,U){const M=(0,s.g2)("ClientHeader"),I=(0,s.g2)("DocumentServicesSection");return(0,s.uX)(),(0,s.CE)("div",i,[(0,s.Lk)("div",r,[(0,s.bF)(M,{"user-data":T.headerUserData,"ui-state":T.headerUIState,"show-breadcrumbs":!0,"can-request-documents":T.canRequestDocuments,onSidebarToggle:T.handleSidebarToggle,onUserDropdownToggle:T.handleUserDropdownToggle,onMenuAction:T.handleMenuAction,onLogout:T.handleLogout,onError:T.handleError,onSearch:T.handleSearch},null,8,["user-data","ui-state","can-request-documents","onSidebarToggle","onUserDropdownToggle","onMenuAction","onLogout","onError","onSearch"]),(0,s.Lk)("main",{class:(0,o.C4)(["main-content",{"sidebar-collapsed":T.uiState.sidebarCollapsed}])},[(0,s.bF)(I,{ref:"servicesSection","document-types":T.documentTypes,loading:T.loading,error:T.error,"can-request-documents":T.canRequestDocuments,"status-message":T.statusMessage,"refreshing-status":T.refreshingStatus,onSelectDocument:T.selectDocumentType,onRetryLoad:T.loadDocumentTypes,onOpenFaq:T.openHelp,onContactSupport:T.contactSupport,onRefreshStatus:T.refreshResidencyStatus},null,8,["document-types","loading","error","can-request-documents","status-message","refreshing-status","onSelectDocument","onRetryLoad","onOpenFaq","onContactSupport","onRefreshStatus"]),(0,s.Lk)("section",c,[(0,s.Lk)("div",l,[(0,s.Lk)("div",u,[(0,s.Lk)("button",{class:(0,o.C4)(["action-btn my-requests-btn",{disabled:!T.canRequestDocuments}]),onClick:t[0]||(t[0]=(...e)=>T.goToMyRequests&&T.goToMyRequests(...e)),disabled:T.loading||!T.canRequestDocuments},[t[7]||(t[7]=(0,s.Lk)("div",{class:"action-icon"},[(0,s.Lk)("i",{class:"fas fa-clock","aria-hidden":"true"})],-1)),(0,s.Lk)("div",f,[t[6]||(t[6]=(0,s.Lk)("h3",{class:"action-title"},"My Requests",-1)),T.canRequestDocuments?((0,s.uX)(),(0,s.CE)("p",m,"View and track your document requests")):((0,s.uX)(),(0,s.CE)("p",h,(0,o.v_)(T.statusMessage),1))]),t[8]||(t[8]=(0,s.Lk)("div",{class:"action-arrow"},[(0,s.Lk)("i",{class:"fas fa-chevron-right","aria-hidden":"true"})],-1))],10,d),(0,s.Lk)("button",{class:(0,o.C4)(["action-btn transactions-btn",{disabled:!T.canRequestDocuments}]),onClick:t[1]||(t[1]=(...e)=>T.goToTransactions&&T.goToTransactions(...e)),disabled:T.loading||!T.canRequestDocuments},[t[10]||(t[10]=(0,s.Lk)("div",{class:"action-icon"},[(0,s.Lk)("i",{class:"fas fa-receipt","aria-hidden":"true"})],-1)),(0,s.Lk)("div",g,[t[9]||(t[9]=(0,s.Lk)("h3",{class:"action-title"},"Online Transactions",-1)),T.canRequestDocuments?((0,s.uX)(),(0,s.CE)("p",y,"View your payment receipts and transaction history")):((0,s.uX)(),(0,s.CE)("p",v,(0,o.v_)(T.statusMessage),1))]),t[11]||(t[11]=(0,s.Lk)("div",{class:"action-arrow"},[(0,s.Lk)("i",{class:"fas fa-chevron-right","aria-hidden":"true"})],-1))],10,p)])])])],2),(0,s.Lk)("footer",k,[(0,s.Lk)("div",w,[(0,s.Lk)("div",b,[t[13]||(t[13]=(0,s.Lk)("div",{class:"footer-info"},[(0,s.Lk)("h4",{class:"footer-title"},"Need Help Getting Started?"),(0,s.Lk)("p",{class:"footer-description"},"Learn about requirements, process steps, and get support for your document requests.")],-1)),(0,s.Lk)("div",q,[(0,s.Lk)("button",{class:"help-btn",onClick:t[2]||(t[2]=(...e)=>T.openHelp&&T.openHelp(...e))},t[12]||(t[12]=[(0,s.Lk)("i",{class:"fas fa-question-circle","aria-hidden":"true"},null,-1),(0,s.Lk)("span",null,"View Requirements & Process",-1)]))])])])])]),T.showHelpDialog?((0,s.uX)(),(0,s.CE)("div",{key:0,class:"dialog-overlay",onClick:t[5]||(t[5]=(...e)=>T.closeDialog&&T.closeDialog(...e))},[(0,s.Lk)("div",{class:"dialog-content",onClick:t[4]||(t[4]=(0,n.D$)((()=>{}),["stop"]))},[(0,s.Lk)("div",D,[t[15]||(t[15]=(0,s.Lk)("h3",{class:"dialog-title"},"Document Services Information",-1)),(0,s.Lk)("button",{class:"dialog-close",onClick:t[3]||(t[3]=(...e)=>T.closeDialog&&T.closeDialog(...e)),"aria-label":"Close dialog"},t[14]||(t[14]=[(0,s.Lk)("i",{class:"fas fa-times","aria-hidden":"true"},null,-1)]))]),(0,s.Lk)("div",C,[(0,s.Lk)("div",L,[(0,s.Lk)("div",R,[t[17]||(t[17]=(0,s.Lk)("div",{class:"section-header"},[(0,s.Lk)("i",{class:"fas fa-clipboard-list","aria-hidden":"true"}),(0,s.Lk)("h4",null,"Before You Start")],-1)),(0,s.Lk)("ul",E,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(T.helpData.requirements,(e=>((0,s.uX)(),(0,s.CE)("li",{key:e.id,class:"requirement-item"},[t[16]||(t[16]=(0,s.Lk)("i",{class:"fas fa-check-circle","aria-hidden":"true"},null,-1)),(0,s.Lk)("span",null,(0,o.v_)(e.text),1)])))),128))])]),(0,s.Lk)("div",_,[t[18]||(t[18]=(0,s.Lk)("div",{class:"section-header"},[(0,s.Lk)("i",{class:"fas fa-route","aria-hidden":"true"}),(0,s.Lk)("h4",null,"How It Works")],-1)),(0,s.Lk)("ol",N,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(T.helpData.processSteps,(e=>((0,s.uX)(),(0,s.CE)("li",{key:e.number,class:"process-step"},[(0,s.Lk)("div",S,(0,o.v_)(e.number),1),(0,s.Lk)("div",A,[(0,s.Lk)("strong",null,(0,o.v_)(e.title),1),(0,s.Lk)("span",null,(0,o.v_)(e.description),1)])])))),128))])])])])])])):(0,s.Q3)("",!0)])}a(4114);var x=a(144),U=a(1387);const M={class:"client-header",role:"banner"},I={class:"main-header"},P={class:"header-container"},$={class:"header-left"},O={class:"header-actions"};function F(e,t,a,o,n,i){const r=(0,s.g2)("SiteLogo"),c=(0,s.g2)("MainNavigation"),l=(0,s.g2)("ClientNotifications"),u=(0,s.g2)("UserProfileDropdown");return(0,s.uX)(),(0,s.CE)("header",M,[(0,s.Lk)("div",I,[(0,s.Lk)("div",P,[(0,s.Lk)("div",$,[(0,s.bF)(r,{onNavigate:t[0]||(t[0]=e=>o.handleMenuAction("dashboard"))})]),(0,s.bF)(c,{"active-menu":a.uiState.activeMenu,onMenuAction:o.handleMenuAction},null,8,["active-menu","onMenuAction"]),(0,s.Lk)("div",O,[(0,s.bF)(l,{onNewNotification:o.handleNewNotification,onNotificationClick:o.handleNotificationClick,onError:o.handleNotificationError},null,8,["onNewNotification","onNotificationClick","onError"]),(0,s.bF)(u,{"user-data":a.userData,"is-open":a.uiState.showUserDropdown,"can-request-documents":a.canRequestDocuments,onToggle:o.handleUserDropdownToggle,onMenuAction:o.handleMenuAction,onLogout:o.handleLogout},null,8,["user-data","is-open","can-request-documents","onToggle","onMenuAction","onLogout"])])])])])}const X={class:"client-notifications"},W={key:0,class:"notification-badge"},B={class:"notification-header"},H={class:"notification-actions"},V=["disabled"],j={class:"notification-content"},K={key:0,class:"notification-loading"},Q={key:1,class:"notification-error"},z={key:2,class:"no-notifications"},Y={key:3,class:"notification-list"},G=["data-notification-id","onClick"],J={class:"notification-icon"},Z={class:"notification-content"},ee={class:"notification-title"},te={class:"notification-message"},ae={class:"notification-time"},se={key:0,class:"unread-indicator"},oe={key:0,class:"load-more-container"},ne=["disabled"],ie={key:0,class:"fas fa-spinner fa-spin"},re={key:1,class:"fas fa-chevron-down"};function ce(e,t,a,i,r,c){return(0,s.uX)(),(0,s.CE)("div",X,[(0,s.Lk)("div",{class:"notification-bell",onClick:t[0]||(t[0]=(...e)=>c.toggleNotificationPanel&&c.toggleNotificationPanel(...e))},[t[6]||(t[6]=(0,s.Lk)("i",{class:"fas fa-bell"},null,-1)),r.unreadCount>0?((0,s.uX)(),(0,s.CE)("span",W,(0,o.v_)(r.unreadCount>99?"99+":r.unreadCount),1)):(0,s.Q3)("",!0)]),r.showPanel?((0,s.uX)(),(0,s.CE)("div",{key:0,class:"notification-panel",onClick:t[5]||(t[5]=(0,n.D$)((()=>{}),["stop"]))},[(0,s.Lk)("div",B,[t[9]||(t[9]=(0,s.Lk)("h5",null,"Notifications",-1)),(0,s.Lk)("div",H,[r.unreadCount>0?((0,s.uX)(),(0,s.CE)("button",{key:0,onClick:t[1]||(t[1]=(...e)=>c.markAllAsRead&&c.markAllAsRead(...e)),class:"btn btn-sm btn-outline-primary",disabled:r.markingAllRead},[t[7]||(t[7]=(0,s.Lk)("i",{class:"fas fa-check-double"},null,-1)),(0,s.eW)(" "+(0,o.v_)(r.markingAllRead?"Marking...":"Mark All Read"),1)],8,V)):(0,s.Q3)("",!0),(0,s.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>c.toggleNotificationPanel&&c.toggleNotificationPanel(...e)),class:"btn btn-sm btn-outline-secondary"},t[8]||(t[8]=[(0,s.Lk)("i",{class:"fas fa-times"},null,-1)]))])]),(0,s.Lk)("div",j,[r.loading?((0,s.uX)(),(0,s.CE)("div",K,t[10]||(t[10]=[(0,s.Lk)("div",{class:"spinner-border spinner-border-sm",role:"status"},[(0,s.Lk)("span",{class:"visually-hidden"},"Loading...")],-1),(0,s.Lk)("span",{class:"ms-2"},"Loading notifications...",-1)]))):r.error?((0,s.uX)(),(0,s.CE)("div",Q,[t[12]||(t[12]=(0,s.Lk)("i",{class:"fas fa-exclamation-triangle"},null,-1)),(0,s.Lk)("span",null,(0,o.v_)(r.error),1),(0,s.Lk)("button",{onClick:t[3]||(t[3]=e=>c.loadNotifications(1)),class:"btn btn-sm btn-outline-primary ms-2"},t[11]||(t[11]=[(0,s.Lk)("i",{class:"fas fa-redo"},null,-1),(0,s.eW)(" Retry ")]))])):0===r.notifications.length?((0,s.uX)(),(0,s.CE)("div",z,t[13]||(t[13]=[(0,s.Lk)("i",{class:"fas fa-bell-slash"},null,-1),(0,s.Lk)("p",null,"No notifications yet",-1)]))):((0,s.uX)(),(0,s.CE)("div",Y,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.notifications,(e=>((0,s.uX)(),(0,s.CE)("div",{key:e.id,"data-notification-id":e.id,class:(0,o.C4)(["notification-item",{unread:!e.is_read,"priority-high":"high"===e.priority||"urgent"===e.priority,clickable:!0}]),onClick:t=>c.handleNotificationClick(e)},[(0,s.Lk)("div",J,[(0,s.Lk)("i",{class:(0,o.C4)(c.getNotificationIcon(e.type))},null,2)]),(0,s.Lk)("div",Z,[(0,s.Lk)("div",ee,(0,o.v_)(e.title),1),(0,s.Lk)("div",te,(0,o.v_)(e.message),1),(0,s.Lk)("div",ae,(0,o.v_)(c.formatTime(e.created_at)),1)]),e.is_read?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",se))],10,G)))),128)),r.hasMore?((0,s.uX)(),(0,s.CE)("div",oe,[(0,s.Lk)("button",{onClick:t[4]||(t[4]=(...e)=>c.loadMore&&c.loadMore(...e)),class:"btn btn-sm btn-outline-primary",disabled:r.loadingMore},[r.loadingMore?((0,s.uX)(),(0,s.CE)("i",ie)):((0,s.uX)(),(0,s.CE)("i",re)),(0,s.eW)(" "+(0,o.v_)(r.loadingMore?"Loading...":"Load More"),1)],8,ne)])):(0,s.Q3)("",!0)]))])])):(0,s.Q3)("",!0)])}a(8111),a(7588);var le=a(4710),ue=a(1268),de={name:"ClientNotifications",emits:["new-notification","notification-click","notification-read","notifications-read","connected","error"],data(){return{showPanel:!1,notifications:[],unreadCount:0,loading:!1,loadingMore:!1,markingAllRead:!1,error:null,currentPage:1,hasMore:!0,pageSize:20,notificationService:null}},async mounted(){await this.initializeNotifications(),document.addEventListener("click",this.handleOutsideClick)},beforeUnmount(){document.removeEventListener("click",this.handleOutsideClick),this.notificationService&&(this.notificationService.off("notification",this.handleNewNotification),this.notificationService.off("connected",this.onConnected),this.notificationService.off("error",this.onError))},methods:{async initializeNotifications(){try{console.log("üöÄ ClientNotifications: Initializing client notification service"),this.notificationService=(0,le.Gv)(),await this.notificationService.requestNotificationPermission(),await this.notificationService.init(),this.notificationService.on("notification",this.handleNewNotification),this.notificationService.on("connected",this.onConnected),this.notificationService.on("error",this.onError),await this.loadUnreadCount(),console.log("‚úÖ ClientNotifications: Client notification service initialized successfully")}catch(e){console.error("‚ùå ClientNotifications: Failed to initialize client notifications:",e),this.error=e.message||"Failed to connect to notification service"}},toggleNotificationPanel(){this.showPanel=!this.showPanel,this.showPanel&&0===this.notifications.length&&this.loadNotifications(1)},handleOutsideClick(e){e.target.closest(".client-notifications")||(this.showPanel=!1)},async loadNotifications(e=1){try{1===e?(this.loading=!0,this.error=null):this.loadingMore=!0;const t=await this.notificationService.getNotifications(e,this.pageSize);console.log("Notifications response:",t);let a=[],s={};t.data&&t.data.notifications&&Array.isArray(t.data.notifications)&&(a=t.data.notifications,s=t.data.pagination||{}),1===e?this.notifications=a:this.notifications.push(...a),this.currentPage=e,this.hasMore=s.page<s.pages,console.log("Loaded notifications:",this.notifications)}catch(t){console.error("Failed to load notifications:",t),this.error="Failed to load notifications"}finally{this.loading=!1,this.loadingMore=!1}},async loadMore(){this.hasMore&&!this.loadingMore&&await this.loadNotifications(this.currentPage+1)},async loadUnreadCount(){try{this.unreadCount=await this.notificationService.getUnreadCount()}catch(e){console.error("Failed to load unread count:",e)}},async markAllAsRead(){try{this.markingAllRead=!0,await this.notificationService.markAllAsRead(),this.notifications.forEach((e=>{e.is_read=!0})),this.unreadCount=0,this.$emit("notifications-read")}catch(e){console.error("Failed to mark all as read:",e),this.$emit("error","Failed to mark notifications as read")}finally{this.markingAllRead=!1}},async handleNotificationClick(e){if(console.log("üîî Client notification clicked:",e),e&&e.id){this.showLoadingState(e);try{e.is_read||(await this.notificationService.markAsRead(e.id),e.is_read=!0,this.unreadCount=Math.max(0,this.unreadCount-1),this.$emit("notification-read",e)),await this.navigateToRelevantPage(e),this.showPanel=!1}catch(t){console.error("‚ùå Failed to handle notification click:",t),this.showErrorToast("Failed to process notification")}finally{this.hideLoadingState(e)}this.$emit("notification-click",e)}else console.error("Invalid notification object:",e)},async navigateToRelevantPage(e){console.log("üß≠ Determining navigation for notification:",e.type,e.data);try{const t="string"===typeof e.data?JSON.parse(e.data):e.data||{};let a=null;switch(e.type){case"status_change":case"request_update":a=await this.handleRequestUpdateNavigation(t);break;case"payment_confirmed":case"payment_required":case"payment_update":a=await this.handlePaymentNavigation(t);break;case"document_ready":case"ready_for_pickup":a=await this.handleDocumentReadyNavigation(t);break;case"request_approved":case"request_rejected":a=await this.handleRequestStatusNavigation(t);break;case"system_alert":case"maintenance_notice":a=await this.handleSystemAlertNavigation(t);break;default:console.log("ü§∑ Unknown notification type, using default navigation"),a=await this.handleDefaultNavigation(t)}if(a){console.log("üöÄ Navigating to:",a);const e=this.$router.push(a),t=new Promise(((e,t)=>{setTimeout((()=>t(new Error("Navigation timeout"))),5e3)}));await Promise.race([e,t])}else console.log("‚ÑπÔ∏è No navigation target determined for notification")}catch(t){throw console.error("‚ùå Navigation error:",t),new Error("Failed to navigate to notification target")}},async handleRequestUpdateNavigation(e){if(e.request_id){const t=await this.checkRequestExists(e.request_id);return t?{name:"RequestDetails",params:{id:e.request_id}}:(this.showErrorToast("Request no longer exists"),{name:"MyRequests"})}return{name:"MyRequests"}},async handlePaymentNavigation(e){if(e.request_id){const t=await this.checkRequestExists(e.request_id);if(t)return{name:"RequestDetails",params:{id:e.request_id},query:{tab:"payment"}}}return{name:"MyRequests",query:{filter:"payment_required"}}},async handleDocumentReadyNavigation(e){if(e.request_id){const t=await this.checkRequestExists(e.request_id);if(t)return{name:"RequestDetails",params:{id:e.request_id},query:{tab:"status"}}}return{name:"MyRequests",query:{filter:"ready"}}},async handleRequestStatusNavigation(e){if(e.request_id){const t=await this.checkRequestExists(e.request_id);if(t)return{name:"RequestDetails",params:{id:e.request_id}}}return{name:"MyRequests"}},async handleSystemAlertNavigation(e){return e.help_section?{name:"HelpSupport",query:{section:e.help_section}}:{name:"ClientDashboard"}},async handleDefaultNavigation(e){if(e.request_id){const t=await this.checkRequestExists(e.request_id);if(t)return{name:"RequestDetails",params:{id:e.request_id}}}return{name:"ClientDashboard"}},async checkRequestExists(e){return await ue.A.checkRequestExists(e,"client")},showLoadingState(e){const t=document.querySelector(`[data-notification-id="${e.id}"]`);t&&t.classList.add("loading")},hideLoadingState(e){const t=document.querySelector(`[data-notification-id="${e.id}"]`);t&&t.classList.remove("loading")},showErrorToast(e){ue.A.showNavigationError(e,this.$emit.bind(this))},handleNewNotification(e,t=null){if(t&&t.userType&&"client"!==t.userType)console.log("üö´ ClientNotifications: Ignoring non-client notification:",t.userType);else if(e.recipient_type&&"client"!==e.recipient_type)console.log("üö´ ClientNotifications: Ignoring notification for:",e.recipient_type);else if(console.log("üì¢ ClientNotifications: Processing client notification:",e),"unread_count_update"!==e.type)if("notification_read"!==e.type){if("all_notifications_read"===e.type)return this.notifications.forEach((e=>e.is_read=!0)),void(this.unreadCount=0);this.showPanel&&this.notifications.unshift(e),e.is_read||this.unreadCount++,this.$emit("new-notification",e)}else{const t=this.notifications.findIndex((t=>t.id===e.notification_id));-1!==t&&(this.notifications[t].is_read=!0,this.unreadCount=Math.max(0,this.unreadCount-1))}else this.unreadCount=e.count||0},onConnected(){console.log("Connected to client notification stream"),this.$emit("connected")},onError(e){console.error("Client notification stream error:",e),this.$emit("error","Connection to notification stream failed")},getNotificationIcon(e){const t={status_change:"fas fa-sync-alt text-info",payment_confirmed:"fas fa-credit-card text-success",document_ready:"fas fa-file-check text-success",request_update:"fas fa-edit text-warning",system_alert:"fas fa-exclamation-triangle text-danger",test:"fas fa-vial text-secondary",connection:"fas fa-plug text-success"};return t[e]||"fas fa-bell text-primary"},formatTime(e){if(!e)return"";const t=new Date(e),a=new Date,s=Math.floor((a-t)/6e4);if(s<1)return"Just now";if(s<60)return`${s}m ago`;const o=Math.floor(s/60);if(o<24)return`${o}h ago`;const n=Math.floor(o/24);return n<7?`${n}d ago`:t.toLocaleDateString()}}},fe=a(1241);const me=(0,fe.A)(de,[["render",ce],["__scopeId","data-v-22424336"]]);var he=me,pe=a(4230);const ge=["aria-label"];function ye(e,t,a,o,i,r){return(0,s.uX)(),(0,s.CE)("div",{class:"logo-section",onClick:t[0]||(t[0]=(...e)=>r.handleClick&&r.handleClick(...e)),onKeyup:t[1]||(t[1]=(0,n.jR)(((...e)=>r.handleClick&&r.handleClick(...e)),["enter"])),role:"button",tabindex:"0","aria-label":r.ariaLabel},t[2]||(t[2]=[(0,s.Lk)("img",{src:pe,alt:"Barangay Bula Logo",class:"logo",loading:"lazy"},null,-1),(0,s.Lk)("div",{class:"site-identity"},[(0,s.Lk)("h1",{class:"site-title"},"Barangay Bula"),(0,s.Lk)("span",{class:"site-subtitle"},"Digital Services Portal")],-1)]),40,ge)}var ve={name:"SiteLogo",emits:["navigate"],computed:{ariaLabel(){return"Navigate to dashboard - Barangay Bula Digital Services Portal"}},methods:{handleClick(){this.$emit("navigate","dashboard")}}};const ke=(0,fe.A)(ve,[["render",ye],["__scopeId","data-v-32bfd891"]]);var we=ke;const be={key:0,class:"main-navigation",role:"navigation","aria-label":"Main navigation"},qe={class:"nav-list"},De=["onClick","aria-current"];function Ce(e,t,a,i,r,c){return r.navigationItems.length>0?((0,s.uX)(),(0,s.CE)("nav",be,[(0,s.Lk)("ul",qe,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.navigationItems,(e=>((0,s.uX)(),(0,s.CE)("li",{key:e.id,class:"nav-item"},[(0,s.Lk)("a",{href:"#",class:(0,o.C4)(["nav-link",{active:a.activeMenu===e.id}]),onClick:(0,n.D$)((t=>c.handleMenuAction(e.id)),["prevent"]),role:"menuitem","aria-current":a.activeMenu===e.id?"page":null},[(0,s.Lk)("i",{class:(0,o.C4)(e.icon),"aria-hidden":"true"},null,2),(0,s.Lk)("span",null,(0,o.v_)(e.label),1)],10,De)])))),128))])])):(0,s.Q3)("",!0)}var Le={name:"MainNavigation",props:{activeMenu:{type:String,default:"dashboard"}},emits:["menu-action"],data(){return{navigationItems:[]}},methods:{handleMenuAction(e){this.$emit("menu-action",e)}}};const Re=(0,fe.A)(Le,[["render",Ce],["__scopeId","data-v-7c10fabf"]]);var Ee=Re;const _e=["aria-expanded"],Ne={class:"user-avatar"},Se=["src","alt"],Ae={key:1,class:"fas fa-user-circle avatar-icon","aria-hidden":"true"},Te={class:"user-info"},xe={class:"user-name"},Ue={key:0,class:"user-dropdown-menu",role:"menu","aria-label":"User account options"},Me=["aria-disabled","title"],Ie={key:0,class:"fas fa-lock disabled-icon","aria-hidden":"true"};function Pe(e,t,a,i,r,c){return(0,s.uX)(),(0,s.CE)("div",{class:(0,o.C4)(["user-profile",{active:a.isOpen}])},[(0,s.Lk)("button",{class:"user-btn",onClick:t[0]||(t[0]=(...e)=>c.handleToggle&&c.handleToggle(...e)),"aria-label":"User account menu","aria-expanded":a.isOpen},[(0,s.Lk)("div",Ne,[a.userData.userAvatar?((0,s.uX)(),(0,s.CE)("img",{key:0,src:a.userData.userAvatar,alt:c.getFullName(),class:"avatar-image",loading:"lazy"},null,8,Se)):((0,s.uX)(),(0,s.CE)("i",Ae))]),(0,s.Lk)("div",Te,[(0,s.Lk)("span",xe,(0,o.v_)(c.getFullName()),1),t[3]||(t[3]=(0,s.Lk)("span",{class:"user-role"},"Client Portal",-1))]),t[4]||(t[4]=(0,s.Lk)("i",{class:"fas fa-chevron-down dropdown-arrow","aria-hidden":"true"},null,-1))],8,_e),a.isOpen?((0,s.uX)(),(0,s.CE)("div",Ue,[(0,s.Lk)("a",{href:"#",class:(0,o.C4)(["dropdown-item",{disabled:!a.canRequestDocuments}]),onClick:t[1]||(t[1]=(0,n.D$)((e=>a.canRequestDocuments?c.handleMenuAction("requests"):null),["prevent"])),role:"menuitem","aria-disabled":!a.canRequestDocuments,title:a.canRequestDocuments?"View your document requests":"Residency verification required to request documents"},[t[5]||(t[5]=(0,s.Lk)("i",{class:"fas fa-clock","aria-hidden":"true"},null,-1)),t[6]||(t[6]=(0,s.Lk)("span",null,"My Requests",-1)),a.canRequestDocuments?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("i",Ie))],10,Me),t[8]||(t[8]=(0,s.Lk)("div",{class:"dropdown-divider"},null,-1)),(0,s.Lk)("a",{href:"#",class:"dropdown-item logout-item",onClick:t[2]||(t[2]=(0,n.D$)(((...e)=>c.handleLogout&&c.handleLogout(...e)),["prevent"])),role:"menuitem"},t[7]||(t[7]=[(0,s.Lk)("i",{class:"fas fa-sign-out-alt","aria-hidden":"true"},null,-1),(0,s.Lk)("span",null,"Sign Out",-1)]))])):(0,s.Q3)("",!0)],2)}var $e={name:"UserProfileDropdown",props:{userData:{type:Object,default:()=>({userName:"User",userEmail:"user@example.com",userAvatar:null})},isOpen:{type:Boolean,default:!1},canRequestDocuments:{type:Boolean,default:!0}},emits:["toggle","menu-action","logout"],mounted(){console.log("=== UserProfileDropdown MOUNTED ==="),console.log("userData prop received:",this.userData),console.log("userData keys:",Object.keys(this.userData||{})),console.log("userData.profile:",this.userData?.profile),console.log("Initial full name:",this.getFullName())},methods:{handleToggle(){this.$emit("toggle")},handleMenuAction(e){this.$emit("menu-action",e)},handleLogout(){confirm("Are you sure you want to sign out?")&&this.$emit("logout")},getFullName(){if(console.log("UserProfileDropdown - userData:",this.userData),console.log("UserProfileDropdown - userData.profile:",this.userData?.profile),console.log("UserProfileDropdown - userData keys:",Object.keys(this.userData||{})),!this.userData)return"User";const e=[];if(this.userData.profile&&"object"===typeof this.userData.profile){const t=this.userData.profile;console.log("UserProfileDropdown - using profile object:",t),t.first_name&&e.push(t.first_name),t.middle_name&&e.push(t.middle_name),t.last_name&&e.push(t.last_name),t.suffix&&e.push(t.suffix)}if(0===e.length&&(this.userData.firstName||this.userData.lastName)&&(console.log("UserProfileDropdown - using direct userData properties"),this.userData.firstName&&e.push(this.userData.firstName),this.userData.middleName&&e.push(this.userData.middleName),this.userData.lastName&&e.push(this.userData.lastName),this.userData.suffix&&e.push(this.userData.suffix)),0===e.length&&(this.userData.first_name||this.userData.last_name)&&(console.log("UserProfileDropdown - using raw backend properties"),this.userData.first_name&&e.push(this.userData.first_name),this.userData.middle_name&&e.push(this.userData.middle_name),this.userData.last_name&&e.push(this.userData.last_name),this.userData.suffix&&e.push(this.userData.suffix)),0===e.length&&this.userData.user&&"object"===typeof this.userData.user){console.log("UserProfileDropdown - checking nested user object");const t=this.userData.user;t.profile?(t.profile.first_name&&e.push(t.profile.first_name),t.profile.middle_name&&e.push(t.profile.middle_name),t.profile.last_name&&e.push(t.profile.last_name),t.profile.suffix&&e.push(t.profile.suffix)):(t.first_name&&e.push(t.first_name),t.middle_name&&e.push(t.middle_name),t.last_name&&e.push(t.last_name),t.suffix&&e.push(t.suffix))}const t=e.join(" ").trim(),a=t||this.userData.username||this.userData.userName||"User";return console.log("UserProfileDropdown - parts found:",e),console.log("UserProfileDropdown - computed fullName:",a),a}}};const Oe=(0,fe.A)($e,[["render",Pe],["__scopeId","data-v-c2a7704c"]]);var Fe=Oe;a(2489);function Xe(){const e=(0,x.KR)([]),t=(0,x.KR)(null),a=(0,x.KR)(!1),s={NETWORK:"network",VALIDATION:"validation",AUTHENTICATION:"authentication",AUTHORIZATION:"authorization",SERVER:"server",CLIENT:"client",UNKNOWN:"unknown"},o={LOW:"low",MEDIUM:"medium",HIGH:"high",CRITICAL:"critical"},n=(e,t="",a={})=>{const s=i(e,t,a);return l(s),d(s),!1!==a.showToUser&&f(s),s.severity===o.CRITICAL&&p(s),s},i=(e,t,a)=>{const n=(new Date).toISOString(),i=g();let l={id:i,timestamp:n,context:t,severity:a.severity||o.MEDIUM,type:s.UNKNOWN,message:"An unexpected error occurred",originalError:e,stack:null,userAgent:navigator.userAgent,url:window.location.href,userId:y(),sessionId:v()};return e instanceof Error?(l.message=e.message,l.stack=e.stack,l.type=c(e)):"string"===typeof e?(l.message=e,l.type=s.CLIENT):e?.response?l=r(e,l):e?.code&&(l.type=e.code,l.message=e.message||l.message),l},r=(e,t)=>{const a=e.response,n=e.request;return a?(t.type=a.status>=500?s.SERVER:s.CLIENT,t.message=a.data?.message||`HTTP ${a.status}: ${a.statusText}`,t.statusCode=a.status,t.responseData=a.data,a.status>=500?t.severity=o.HIGH:401===a.status?(t.type=s.AUTHENTICATION,t.severity=o.MEDIUM):403===a.status&&(t.type=s.AUTHORIZATION,t.severity=o.MEDIUM)):n&&(t.type=s.NETWORK,t.message="Network error - please check your connection",t.severity=o.HIGH),t},c=e=>{const t=e.message.toLowerCase();return t.includes("network")||t.includes("fetch")?s.NETWORK:t.includes("validation")||t.includes("invalid")?s.VALIDATION:t.includes("unauthorized")||t.includes("authentication")?s.AUTHENTICATION:t.includes("forbidden")||t.includes("permission")?s.AUTHORIZATION:s.CLIENT},l=e=>{const t=u(e.severity),a=`[${e.type.toUpperCase()}] ${e.context}: ${e.message}`;console[t](a,{errorId:e.id,timestamp:e.timestamp,originalError:e.originalError,stack:e.stack})},u=e=>{switch(e){case o.LOW:return"info";case o.MEDIUM:return"warn";case o.HIGH:case o.CRITICAL:return"error";default:return"warn"}},d=a=>{e.value.unshift(a),e.value.length>50&&(e.value=e.value.slice(0,50)),a.severity===o.CRITICAL&&(t.value=a)},f=e=>{const s=m(e);e.severity===o.CRITICAL?(t.value=e,a.value=!0):h(s,e.severity)},m=e=>{switch(e.type){case s.NETWORK:return"Please check your internet connection and try again.";case s.AUTHENTICATION:return"Please log in again to continue.";case s.AUTHORIZATION:return"You do not have permission to perform this action.";case s.VALIDATION:return e.message;case s.SERVER:return"Server error. Please try again later.";default:return"Something went wrong. Please try again."}},h=(e,t)=>{console.log(`Toast [${t}]: ${e}`)},p=e=>{console.error("CRITICAL ERROR REPORTED:",e)},g=()=>`err_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,y=()=>{try{const e=JSON.parse(localStorage.getItem("auth_user")||"{}");return e.id||"anonymous"}catch{return"anonymous"}},v=()=>{let e=sessionStorage.getItem("session_id");return e||(e=`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,sessionStorage.setItem("session_id",e)),e},k=()=>{e.value=[],t.value=null},w=a=>{e.value=e.value.filter((e=>e.id!==a)),t.value?.id===a&&(t.value=null)},b=()=>{a.value=!1,t.value=null},q=()=>{console.log("Retrying last action...")};return{errors:e,globalError:t,isErrorModalOpen:a,ERROR_TYPES:s,SEVERITY_LEVELS:o,handleError:n,clearErrors:k,clearError:w,closeErrorModal:b,retryLastAction:q,getUserFriendlyMessage:m}}var We={name:"ClientHeader",components:{ClientNotifications:he,SiteLogo:we,MainNavigation:Ee,UserProfileDropdown:Fe},props:{userData:{type:Object,default:()=>({userName:"User",userEmail:"user@example.com",userAvatar:null,firstName:"User"})},uiState:{type:Object,default:()=>({showUserDropdown:!1,sidebarCollapsed:!1,activeMenu:"dashboard"})},showBreadcrumbs:{type:Boolean,default:!0},canRequestDocuments:{type:Boolean,default:!0}},emits:["sidebar-toggle","user-dropdown-toggle","menu-action","logout","error","search","notification-click"],setup(e,{emit:t}){const{handleError:a}=Xe(),o=(0,x.Kh)({isActive:!1,query:""}),n=()=>{o.isActive=!o.isActive,o.isActive&&setTimeout((()=>{const e=document.querySelector(".search-input");e&&e.focus()}),100)},i=e=>{o.query=e},r=()=>{o.query.trim()&&(t("search",o.query.trim()),window.innerWidth<=768&&(o.isActive=!1))},c=()=>{t("sidebar-toggle")},l=()=>{t("user-dropdown-toggle")},u=e=>{t("menu-action",e)},d=async()=>{try{t("logout")}catch(e){a(e,"Logout failed")}},f=e=>{console.log("New notification received:",e)},m=async e=>{if(console.log("üîî ClientHeader: Notification clicked:",e),e&&"object"===typeof e){try{const t="string"===typeof e.data?JSON.parse(e.data):e.data||{};console.log("üìä ClientHeader: Notification data:",t)}catch(s){console.error("‚ùå ClientHeader: Error handling notification click:",s),a(s,"Notification click handling failed")}t("notification-click",e)}else console.error("Invalid notification object received:",e)},h=e=>{console.error("Notification error:",e),t("error",e)},p=a=>{a.target.closest(".user-profile")||e.uiState.showUserDropdown&&t("user-dropdown-toggle"),a.target.closest(".search-container")||(o.isActive=!1)};return(0,s.sV)((()=>{document.addEventListener("click",p)})),(0,s.hi)((()=>{document.removeEventListener("click",p)})),{searchState:o,toggleSearch:n,updateSearchQuery:i,performSearch:r,handleSidebarToggle:c,handleUserDropdownToggle:l,handleMenuAction:u,handleLogout:d,handleNewNotification:f,handleNotificationClick:m,handleNotificationError:h}}};const Be=(0,fe.A)(We,[["render",F],["__scopeId","data-v-33919784"]]);var He=Be;const Ve={class:"services-wrapper"},je={class:"services-section"},Ke={class:"container"},Qe={key:0,class:"loading-container",role:"status","aria-live":"polite"},ze={key:1,class:"error-container",role:"alert"},Ye={class:"error-content"},Ge={class:"error-message"},Je={key:2,class:"account-status-warning mb-4"},Ze={class:"alert alert-warning d-flex align-items-center justify-content-between"},et={class:"d-flex align-items-center"},tt={class:"alert-heading mb-1"},at={key:0},st={key:1},ot={class:"mb-0"},nt={key:0},it={key:1},rt={key:2},ct={key:3},lt={key:3,class:"document-types-grid"},ut=["onClick","onKeyup","tabindex","aria-disabled"],dt={class:"card-header"},ft={class:"document-icon"},mt={class:"card-content"},ht={class:"document-title"},pt={class:"document-description"},gt={class:"card-action"},yt={key:0,class:"fas fa-arrow-right","aria-hidden":"true"},vt={key:1,class:"disabled-text"},kt={key:2,class:"disabled-text"},wt={key:3,class:"disabled-text"},bt={class:"dialog-header"},qt={class:"dialog-body"},Dt={class:"help-sections"},Ct={class:"help-section"},Lt={class:"requirements-list"},Rt={class:"help-section"},Et={class:"process-steps"},_t={class:"step-number"},Nt={class:"step-content"},St={class:"help-section"},At={class:"support-actions"};function Tt(e,t,a,i,r,c){return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("section",Ve,[(0,s.Lk)("section",je,[(0,s.Lk)("div",Ke,[t[12]||(t[12]=(0,s.Lk)("div",{class:"section-header"},[(0,s.Lk)("h2",{class:"section-title"},"Available Document Services"),(0,s.Lk)("p",{class:"section-description"},"Select the type of document you need to request")],-1)),a.loading?((0,s.uX)(),(0,s.CE)("div",Qe,t[6]||(t[6]=[(0,s.Lk)("div",{class:"loading-content"},[(0,s.Lk)("div",{class:"loading-spinner"},[(0,s.Lk)("i",{class:"fas fa-spinner fa-spin","aria-hidden":"true"})]),(0,s.Lk)("p",{class:"loading-text"},"Loading available services...")],-1)]))):a.error?((0,s.uX)(),(0,s.CE)("div",ze,[(0,s.Lk)("div",Ye,[t[8]||(t[8]=(0,s.Lk)("div",{class:"error-icon"},[(0,s.Lk)("i",{class:"fas fa-exclamation-triangle","aria-hidden":"true"})],-1)),t[9]||(t[9]=(0,s.Lk)("h3",{class:"error-title"},"Unable to Load Services",-1)),(0,s.Lk)("p",Ge,(0,o.v_)(a.error),1),(0,s.Lk)("button",{class:"retry-btn",onClick:t[0]||(t[0]=(...e)=>c.handleRetry&&c.handleRetry(...e))},t[7]||(t[7]=[(0,s.Lk)("i",{class:"fas fa-redo","aria-hidden":"true"},null,-1),(0,s.Lk)("span",null,"Try Again",-1)]))])])):(0,s.Q3)("",!0),c.isAccountActive&&a.canRequestDocuments?((0,s.uX)(),(0,s.CE)("div",lt,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(a.documentTypes,(e=>((0,s.uX)(),(0,s.CE)("div",{key:e.id,class:(0,o.C4)(["document-card",{disabled:!c.canRequestDocument(e)}]),onClick:t=>c.handleSelectDocument(e),onKeyup:(0,n.jR)((t=>c.handleSelectDocument(e)),["enter"]),role:"button",tabindex:c.canRequestDocument(e)?0:-1,"aria-disabled":!c.canRequestDocument(e)},[(0,s.Lk)("div",dt,[(0,s.Lk)("div",ft,[(0,s.Lk)("i",{class:(0,o.C4)(c.getDocumentIcon(e.type_name)),"aria-hidden":"true"},null,2)]),(0,s.Lk)("div",{class:(0,o.C4)(["status-badge",c.getStatusBadgeClass(e)])},(0,o.v_)(c.getStatusText(e)),3)]),(0,s.Lk)("div",mt,[(0,s.Lk)("h3",ht,(0,o.v_)(e.type_name),1),(0,s.Lk)("p",pt,(0,o.v_)(e.description),1)]),t[11]||(t[11]=(0,s.Lk)("div",{class:"card-details"},null,-1)),(0,s.Lk)("div",gt,[c.canRequestDocument(e)?((0,s.uX)(),(0,s.CE)("i",yt)):c.isAccountActive?a.canRequestDocuments?((0,s.uX)(),(0,s.CE)("span",wt,"Not Available")):((0,s.uX)(),(0,s.CE)("span",kt,"Residency Verification Required")):((0,s.uX)(),(0,s.CE)("span",vt,"Account Verification Required"))])],42,ut)))),128))])):((0,s.uX)(),(0,s.CE)("div",Je,[(0,s.Lk)("div",Ze,[(0,s.Lk)("div",et,[t[10]||(t[10]=(0,s.Lk)("i",{class:"fas fa-exclamation-triangle me-3"},null,-1)),(0,s.Lk)("div",null,[(0,s.Lk)("h5",tt,[c.isAccountActive?a.canRequestDocuments?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("span",st,"Residency Verification Required")):((0,s.uX)(),(0,s.CE)("span",at,"Account Verification Required"))]),(0,s.Lk)("p",ot,[c.isAccountActive||"pending_residency_verification"!==c.clientData?.status?c.isAccountActive||"residency_rejected"!==c.clientData?.status?c.isAccountActive?a.canRequestDocuments?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("span",ct,(0,o.v_)(a.statusMessage),1)):((0,s.uX)(),(0,s.CE)("span",rt," Your account needs to be verified before you can request documents. Please contact the administrator. ")):((0,s.uX)(),(0,s.CE)("span",it," Your residency verification was rejected. Please contact the administrator or upload new documents. ")):((0,s.uX)(),(0,s.CE)("span",nt," Your account is pending residency verification. Please wait for admin approval before requesting documents. "))])])])])]))])])]),r.showHelpDialog?((0,s.uX)(),(0,s.CE)("div",{key:0,class:"dialog-overlay",onClick:t[5]||(t[5]=(...e)=>c.closeDialog&&c.closeDialog(...e))},[(0,s.Lk)("div",{class:"dialog-content",onClick:t[4]||(t[4]=(0,n.D$)((()=>{}),["stop"]))},[(0,s.Lk)("div",bt,[t[14]||(t[14]=(0,s.Lk)("h3",{class:"dialog-title"},"Document Services Information",-1)),(0,s.Lk)("button",{class:"dialog-close",onClick:t[1]||(t[1]=(...e)=>c.closeDialog&&c.closeDialog(...e)),"aria-label":"Close dialog"},t[13]||(t[13]=[(0,s.Lk)("i",{class:"fas fa-times","aria-hidden":"true"},null,-1)]))]),(0,s.Lk)("div",qt,[(0,s.Lk)("div",Dt,[(0,s.Lk)("div",Ct,[t[16]||(t[16]=(0,s.Lk)("div",{class:"section-header"},[(0,s.Lk)("i",{class:"fas fa-clipboard-list","aria-hidden":"true"}),(0,s.Lk)("h4",null,"Before You Start")],-1)),(0,s.Lk)("ul",Lt,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.helpData.requirements,(e=>((0,s.uX)(),(0,s.CE)("li",{key:e.id,class:"requirement-item"},[t[15]||(t[15]=(0,s.Lk)("i",{class:"fas fa-check-circle","aria-hidden":"true"},null,-1)),(0,s.Lk)("span",null,(0,o.v_)(e.text),1)])))),128))])]),(0,s.Lk)("div",Rt,[t[17]||(t[17]=(0,s.Lk)("div",{class:"section-header"},[(0,s.Lk)("i",{class:"fas fa-route","aria-hidden":"true"}),(0,s.Lk)("h4",null,"How It Works")],-1)),(0,s.Lk)("ol",Et,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.helpData.processSteps,(e=>((0,s.uX)(),(0,s.CE)("li",{key:e.number,class:"process-step"},[(0,s.Lk)("div",_t,(0,o.v_)(e.number),1),(0,s.Lk)("div",Nt,[(0,s.Lk)("strong",null,(0,o.v_)(e.title),1),(0,s.Lk)("span",null,(0,o.v_)(e.description),1)])])))),128))])]),(0,s.Lk)("div",St,[t[20]||(t[20]=(0,s.Lk)("div",{class:"section-header"},[(0,s.Lk)("i",{class:"fas fa-headset","aria-hidden":"true"}),(0,s.Lk)("h4",null,"Need Assistance?")],-1)),t[21]||(t[21]=(0,s.Lk)("p",{class:"support-description"},"Our support team is here to help you with any questions about document requirements or the application process.",-1)),(0,s.Lk)("div",At,[(0,s.Lk)("button",{class:"support-action-btn faq-btn",onClick:t[2]||(t[2]=(...e)=>c.handleOpenFAQ&&c.handleOpenFAQ(...e))},t[18]||(t[18]=[(0,s.Lk)("i",{class:"fas fa-question-circle","aria-hidden":"true"},null,-1),(0,s.Lk)("span",null,"View FAQ",-1)])),(0,s.Lk)("button",{class:"support-action-btn contact-btn",onClick:t[3]||(t[3]=(...e)=>c.handleContactSupport&&c.handleContactSupport(...e))},t[19]||(t[19]=[(0,s.Lk)("i",{class:"fas fa-phone","aria-hidden":"true"},null,-1),(0,s.Lk)("span",null,"Contact Support",-1)]))])])])])])])):(0,s.Q3)("",!0)],64)}var xt=a(9197),Ut=a(4373),Mt={name:"DocumentServicesSection",props:{documentTypes:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},error:{type:String,default:null},canRequestDocuments:{type:Boolean,default:!0},statusMessage:{type:String,default:""},refreshingStatus:{type:Boolean,default:!1}},emits:["select-document","retry-load","open-faq","contact-support","refresh-status"],data(){return{showHelpDialog:!1,frequencyChecks:{},helpData:{requirements:[{id:1,text:"Complete and accurate profile information"},{id:2,text:"Valid government-issued ID ready for upload"},{id:3,text:"Supporting documents (if required)"},{id:4,text:"Payment method for processing fees"}],processSteps:[{number:1,title:"Select Document",description:"Choose the document type you need"},{number:2,title:"Fill Application",description:"Complete the required information"},{number:3,title:"Submit & Pay",description:"Review and submit with payment"},{number:4,title:"Track Progress",description:"Monitor your request status"}]}}},computed:{clientData(){return xt["default"].getCurrentUser()},isAccountActive(){return"active"===this.clientData?.status}},methods:{async handleSelectDocument(e){if(this.canRequestDocument(e)){const t=await this.checkRequestFrequency(e.id);if(t&&!t.canRequest)return void alert(t.message);this.$emit("select-document",e)}},canRequestDocument(e){const t=e.is_active&&this.isAccountActive&&this.canRequestDocuments,a=this.frequencyChecks[e.id];return!(a&&!a.canRequest)&&t},async checkRequestFrequency(e){try{const t=xt["default"].getToken(),a=await Ut.A.get(`${{NODE_ENV:"production",VUE_APP_API_URL:"https://brgybulabackend-production.up.railway.app/api",VUE_APP_APP_NAME:"Barangay Bula Management System",VUE_APP_ENV:"production",VUE_APP_VERSION:"1.0.0",BASE_URL:"/"}.VUE_APP_API_BASE_URL}/api/client/document-requests/frequency-check/${e}`,{headers:{Authorization:`Bearer ${t}`}});if(a.data.success)return this.$set(this.frequencyChecks,e,a.data.data),a.data.data}catch(t){if(console.error("Error checking request frequency:",t),429===t.response?.status){const a=t.response.data;return this.$set(this.frequencyChecks,e,a),a}}return null},getStatusText(e){if(!this.isAccountActive)return"Account Verification Required";if(!this.canRequestDocuments)return"Residency Verification Required";const t=this.frequencyChecks[e.id];return t&&!t.canRequest?`Next request allowed: ${new Date(t.nextAllowedDate).toLocaleDateString()}`:e.is_active?"Available":"Unavailable"},getStatusBadgeClass(e){if(!this.isAccountActive)return"account-pending";if(!this.canRequestDocuments)return"residency-pending";const t=this.frequencyChecks[e.id];return t&&!t.canRequest?"frequency-limited":{available:e.is_active,unavailable:!e.is_active}},handleRetry(){this.$emit("retry-load")},getDocumentIcon(e){const t={"Barangay Clearance":"fas fa-certificate",Cedula:"fas fa-id-card","Business Permit":"fas fa-briefcase","Residence Certificate":"fas fa-home","Indigency Certificate":"fas fa-hand-holding-heart"};return t[e]||"fas fa-file-alt"},getProcessingTime(e){const t={"Barangay Clearance":"3-5 business days",Cedula:"1-2 business days","Business Permit":"5-7 business days","Residence Certificate":"2-3 business days","Indigency Certificate":"1-2 business days"};return t[e]||"3-5 business days"},formatCurrency(e){return e.toFixed(2)},closeDialog(){this.showHelpDialog=!1},handleOpenFAQ(){this.$emit("open-faq"),this.closeDialog()},handleContactSupport(){this.$emit("contact-support"),this.closeDialog()},async checkAllDocumentFrequencies(){for(const e of this.documentTypes)await this.checkRequestFrequency(e.id)}},async mounted(){document.addEventListener("keydown",(e=>{"Escape"===e.key&&this.showHelpDialog&&this.closeDialog()})),this.isAccountActive&&this.canRequestDocuments&&this.documentTypes.length>0&&await this.checkAllDocumentFrequencies()},watch:{documentTypes:{handler:async function(e){this.isAccountActive&&this.canRequestDocuments&&e.length>0&&await this.checkAllDocumentFrequencies()},immediate:!1}}};const It=(0,fe.A)(Mt,[["render",Tt],["__scopeId","data-v-73d50bc8"]]);var Pt=It;function $t(){const e=(0,x.Kh)({userName:"User",userEmail:"user@example.com",userAvatar:null,firstName:"User",lastName:"",middleName:"",suffix:"",profile:null,isLoading:!1,error:null}),t=(0,s.EW)((()=>e.firstName&&e.lastName?`${e.firstName} ${e.lastName}`.trim():e.firstName||e.userName)),a=(0,s.EW)((()=>e.firstName&&e.lastName?`${e.firstName[0]}${e.lastName[0]}`.toUpperCase():e.userName?e.userName.substring(0,2).toUpperCase():"U")),o=(0,s.EW)((()=>"User"!==e.userName&&"user@example.com"!==e.userEmail)),n=async()=>{try{e.isLoading=!0,e.error=null;const t=xt["default"].getCurrentUser();console.log("useUserData - currentUser:",t),t?(console.log("useUserData - processing currentUser:",t),e.userName=t.username||"User",e.userEmail=t.email||"user@example.com",e.userAvatar=t.avatar||null,t.profile?(console.log("useUserData - found profile object:",t.profile),e.firstName=t.profile.first_name||"",e.lastName=t.profile.last_name||"",e.middleName=t.profile.middle_name||"",e.suffix=t.profile.suffix||"",e.profile=t.profile):(e.firstName=t.username||"User",e.lastName="",e.middleName="",e.suffix="",e.profile=null),console.log("useUserData - final userData:",{firstName:e.firstName,lastName:e.lastName,middleName:e.middleName,suffix:e.suffix,profile:e.profile})):(console.warn("No current user found"),i())}catch(t){console.error("Error loading user data:",t),e.error="Failed to load user information",i()}finally{e.isLoading=!1}},i=()=>{e.userName="User",e.userEmail="user@example.com",e.userAvatar=null,e.firstName="User",e.lastName="",e.middleName="",e.suffix="",e.profile=null,e.error=null},r=t=>{try{Object.assign(e,{...e,...t,error:null})}catch(a){console.error("Error updating user data:",a),e.error="Failed to update user information"}},c=()=>{const t=[];return(!e.userName||e.userName.trim().length<2)&&t.push("Username must be at least 2 characters long"),e.userEmail&&l(e.userEmail)||t.push("Valid email address is required"),{isValid:0===t.length,errors:t}},l=e=>{const t=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;return t.test(e)};return{userData:e,fullName:t,initials:a,isAuthenticated:o,loadUserData:n,resetUserData:i,updateUserData:r,validateUserData:c}}a(116),a(1701);var Ot=a(1939);function Ft(){const e=(0,x.KR)([]),t=(0,x.KR)(!1),a=(0,x.KR)(null),o=(0,x.KR)(null),n=(0,s.EW)((()=>e.value.filter((e=>e.is_active)))),i=(0,s.EW)((()=>e.value.filter((e=>!e.is_active)))),r=(0,s.EW)((()=>({total:e.value.length,active:n.value.length,inactive:i.value.length}))),c=(0,s.EW)((()=>{const t={};return e.value.forEach((e=>{const a=e.category||"General";t[a]||(t[a]=[]),t[a].push(e)})),t})),l=async(s=!1)=>{const n=Date.now()-3e5;if(!(!s&&o.value&&o.value>n))try{t.value=!0,a.value=null;const s=await Ot.A.getDocumentTypes();if(!s||!s.data)throw new Error("Invalid response format");e.value=s.data.map(u),o.value=Date.now()}catch(i){console.error("Error loading document types:",i),a.value=i.response?.data?.message||"Failed to load available services",e.value=[]}finally{t.value=!1}},u=e=>({...e,id:e.id||`doc-${Date.now()}-${Math.random()}`,type_name:e.type_name||"Unknown Document",description:e.description||"No description available",base_fee:parseFloat(e.base_fee)||0,is_active:Boolean(e.is_active),category:e.category||"General",icon:d(e.type_name),processingTime:f(e.type_name),formattedFee:m(e.base_fee)}),d=e=>{const t={"Barangay Clearance":"fas fa-certificate",Cedula:"fas fa-id-card","Business Permit":"fas fa-briefcase","Residence Certificate":"fas fa-home","Indigency Certificate":"fas fa-hand-holding-heart","Good Moral Certificate":"fas fa-award"};return t[e]||"fas fa-file-alt"},f=e=>{const t={"Barangay Clearance":"3-5 business days",Cedula:"1-2 business days","Business Permit":"5-7 business days","Residence Certificate":"2-3 business days","Indigency Certificate":"1-2 business days","Good Moral Certificate":"3-5 business days"};return t[e]||"3-5 business days"},m=e=>{const t=parseFloat(e)||0;return t.toFixed(2)},h=t=>e.value.find((e=>e.id===t)),p=t=>e.value.find((e=>e.type_name.toLowerCase()===t.toLowerCase())),g=t=>{if(!t||0===t.trim().length)return e.value;const a=t.toLowerCase().trim();return e.value.filter((e=>e.type_name.toLowerCase().includes(a)||e.description.toLowerCase().includes(a)||e.category&&e.category.toLowerCase().includes(a)))},y=()=>l(!0),v=()=>{a.value=null};return{documentTypes:e,loading:t,error:a,lastUpdated:o,activeDocumentTypes:n,inactiveDocumentTypes:i,documentTypesCount:r,documentTypesByCategory:c,loadDocumentTypes:l,refreshDocumentTypes:y,getDocumentTypeById:h,getDocumentTypeByName:p,searchDocumentTypes:g,clearError:v,getDocumentIcon:d,getProcessingTime:f,formatCurrency:m}}function Xt(){const e=(0,x.Kh)({totalRequests:0,pendingRequests:0,completedRequests:0,rejectedRequests:0,totalSpent:0,averageProcessingTime:0,isLoading:!1,error:null,lastUpdated:null}),t=(0,s.EW)((()=>0===e.totalRequests?0:Math.round(e.completedRequests/e.totalRequests*100))),a=(0,s.EW)((()=>0===e.totalRequests?0:Math.round(e.pendingRequests/e.totalRequests*100))),o=(0,s.EW)((()=>0===e.totalRequests?0:Math.round(e.rejectedRequests/e.totalRequests*100))),n=(0,s.EW)((()=>0===e.totalRequests?0:e.totalSpent/e.totalRequests)),i=(0,s.EW)((()=>[{id:"total",title:"Total Requests",value:e.totalRequests,icon:"fas fa-file-alt",color:"blue",trend:null},{id:"pending",title:"Pending",value:e.pendingRequests,icon:"fas fa-clock",color:"yellow",percentage:a.value},{id:"completed",title:"Completed",value:e.completedRequests,icon:"fas fa-check-circle",color:"green",percentage:t.value},{id:"spent",title:"Total Spent",value:`‚Ç±${h(e.totalSpent)}`,icon:"fas fa-peso-sign",color:"purple",average:`‚Ç±${h(n.value)} avg`}])),r=async(t=!1)=>{const a=Date.now()-12e4;if(!(!t&&e.lastUpdated&&e.lastUpdated>a))try{e.isLoading=!0,e.error=null;try{const e=await Ot.A.getDashboardStats();e&&e.data?c(e.data):l()}catch(s){console.warn("API stats not available, using placeholder data:",s),l()}e.lastUpdated=Date.now()}catch(o){console.error("Error loading user stats:",o),e.error="Failed to load statistics",l()}finally{e.isLoading=!1}},c=t=>{e.totalRequests=t.total_requests||0,e.pendingRequests=t.pending_requests||0,e.completedRequests=t.completed_requests||0,e.rejectedRequests=t.rejected_requests||0,e.totalSpent=parseFloat(t.total_spent)||0,e.averageProcessingTime=t.average_processing_time||0},l=()=>{e.totalRequests=5,e.pendingRequests=2,e.completedRequests=3,e.rejectedRequests=0,e.totalSpent=450,e.averageProcessingTime=3.5},u=()=>r(!0),d=()=>{e.totalRequests=0,e.pendingRequests=0,e.completedRequests=0,e.rejectedRequests=0,e.totalSpent=0,e.averageProcessingTime=0,e.error=null,e.lastUpdated=null},f=(t,a=1)=>{Object.prototype.hasOwnProperty.call(e,t)&&(e[t]+=a)},m=(t,a=1)=>{Object.prototype.hasOwnProperty.call(e,t)&&(e[t]=Math.max(0,e[t]-a))},h=e=>{const t=parseFloat(e)||0;return t.toFixed(2)},p=e=>e<1?"Less than 1 day":1===e?"1 day":`${Math.round(e)} days`,g=(t,a)=>(console.log("Getting stats for date range:",t,"to",a),{...e}),y=()=>{e.error=null};return{userStats:e,completionRate:t,pendingRate:a,rejectionRate:o,averageSpentPerRequest:n,statsCards:i,loadUserStats:r,refreshStats:u,resetStats:d,incrementStat:f,decrementStat:m,getStatsByDateRange:g,clearError:y,formatCurrency:h,formatProcessingTime:p}}function Wt(){const e=(0,x.Kh)({sidebarCollapsed:!1,showUserDropdown:!1,showNotifications:!1,showMobileMenu:!1,activeModal:null,isLoading:!1,isMobile:!1,screenWidth:0,screenHeight:0}),t=(0,s.EW)((()=>e.screenWidth<=768)),a=(0,s.EW)((()=>e.screenWidth>768&&e.screenWidth<=1024)),o=(0,s.EW)((()=>e.screenWidth>1024)),n=(0,s.EW)((()=>t.value?"mobile":a.value?"tablet":"desktop")),i=(0,s.EW)((()=>e.showUserDropdown||e.showNotifications||e.showMobileMenu)),r=()=>{e.sidebarCollapsed=!e.sidebarCollapsed;try{localStorage.setItem("sidebar-collapsed",e.sidebarCollapsed.toString())}catch(t){console.warn("Could not save sidebar state to localStorage:",t)}},c=()=>{e.sidebarCollapsed=!0;try{localStorage.setItem("sidebar-collapsed","true")}catch(t){console.warn("Could not save sidebar state to localStorage:",t)}},l=()=>{e.sidebarCollapsed=!1;try{localStorage.setItem("sidebar-collapsed","false")}catch(t){console.warn("Could not save sidebar state to localStorage:",t)}},u=()=>{e.showNotifications&&(e.showNotifications=!1),e.showMobileMenu&&(e.showMobileMenu=!1),e.showUserDropdown=!e.showUserDropdown},d=()=>{e.showUserDropdown&&(e.showUserDropdown=!1),e.showMobileMenu&&(e.showMobileMenu=!1),e.showNotifications=!e.showNotifications},f=()=>{e.showUserDropdown&&(e.showUserDropdown=!1),e.showNotifications&&(e.showNotifications=!1),e.showMobileMenu=!e.showMobileMenu},m=()=>{e.showUserDropdown=!1,e.showNotifications=!1,e.showMobileMenu=!1},h=t=>{e.activeModal=t,document.body.style.overflow="hidden"},p=()=>{e.activeModal=null,document.body.style.overflow=""},g=t=>{e.isLoading=t},y=()=>{e.screenWidth=window.innerWidth,e.screenHeight=window.innerHeight,e.isMobile=window.innerWidth<=768,e.isMobile&&!e.sidebarCollapsed&&(e.sidebarCollapsed=!0)},v=()=>{y(),i.value&&m()},k=e=>{if(i.value){const t=e.target.closest(".dropdown-container, .user-profile, .notifications-container, .mobile-menu");t||m()}},w=t=>{"Escape"===t.key&&(e.activeModal?p():i.value&&m())},b=()=>{try{const t=localStorage.getItem("sidebar-collapsed");null!==t&&(e.sidebarCollapsed="true"===t)}catch(t){console.warn("Could not restore sidebar state from localStorage:",t)}y(),window.addEventListener("resize",v),document.addEventListener("click",k),document.addEventListener("keydown",w)},q=()=>{window.removeEventListener("resize",v),document.removeEventListener("click",k),document.removeEventListener("keydown",w),document.body.style.overflow=""};return(0,s.sV)((()=>{b()})),(0,s.hi)((()=>{q()})),{uiState:e,isMobileDevice:t,isTabletDevice:a,isDesktopDevice:o,deviceType:n,hasAnyDropdownOpen:i,toggleSidebar:r,collapseSidebar:c,expandSidebar:l,toggleUserDropdown:u,toggleNotifications:d,toggleMobileMenu:f,closeAllDropdowns:m,openModal:h,closeModal:p,setLoading:g,updateScreenSize:y,cleanupUIState:q}}function Bt(){const e=(0,U.rd)(),t={dashboard:"ClientDashboard",services:"NewDocumentRequest",requests:"MyRequests",documents:"MyDocuments",profile:"ClientProfile",settings:"ClientSettings",history:"RequestHistory",notifications:"ClientNotifications",help:"HelpSupport",account:"ClientProfile"},a=async(a,s={},o={})=>{try{const n=t[a]||a;return n?(await e.push({name:n,params:s,query:o}),!0):(console.warn(`No route found for action: ${a}`),!1)}catch(n){return console.error("Navigation error:",n),!1}},o=()=>{try{window.history.length>1?e.back():a("dashboard")}catch(t){console.error("Error navigating back:",t),a("dashboard")}},n=()=>{try{e.forward()}catch(t){console.error("Error navigating forward:",t)}},i=(e,t=!0)=>{try{t?window.open(e,"_blank","noopener,noreferrer"):window.location.href=e}catch(a){console.error("Error navigating to external URL:",a)}},r=async()=>{try{const t=e.currentRoute.value;await e.replace({path:"/loading"}),await(0,s.dY)(),await e.replace(t)}catch(t){console.error("Error reloading route:",t)}},c=(e,t={})=>{if(!e)return void console.warn("Element not found for scrolling");const a={behavior:"smooth",block:"start",inline:"nearest"},s={...a,...t};try{e.scrollIntoView?e.scrollIntoView(s):e.scrollTop=0}catch(o){console.error("Error scrolling to element:",o)}},l=(e=!0)=>{try{window.scrollTo({top:0,left:0,behavior:e?"smooth":"auto"})}catch(t){console.error("Error scrolling to top:",t)}},u=(e=!0)=>{try{window.scrollTo({top:document.body.scrollHeight,left:0,behavior:e?"smooth":"auto"})}catch(t){console.error("Error scrolling to bottom:",t)}},d=(e,t=0)=>{try{const a=document.getElementById(e);if(a){const e=a.offsetTop-t;window.scrollTo({top:e,behavior:"smooth"})}else console.warn(`Section with ID '${e}' not found`)}catch(a){console.error("Error scrolling to section:",a)}},f=()=>e.currentRoute.value.path,m=()=>e.currentRoute.value.name,h=()=>e.currentRoute.value.params,p=()=>e.currentRoute.value.query,g=(t,a={},s={})=>{try{return e.resolve({name:t,params:a,query:s}).href}catch(o){return console.error("Error building route URL:",o),"#"}},y=()=>!0,v=(e="Are you sure you want to leave this page?")=>window.confirm(e),k=()=>{const t=e.currentRoute.value,a=[];return a.push({name:"Dashboard",path:"/client/dashboard",active:!1}),t.meta?.title&&"/client/dashboard"!==t.path&&a.push({name:t.meta.title,path:t.path,active:!0}),a};return{navigateToRoute:a,navigateBack:o,navigateForward:n,navigateToExternal:i,reloadCurrentRoute:r,scrollToElement:c,scrollToTop:l,scrollToBottom:u,scrollToSection:d,getCurrentPath:f,getCurrentRouteName:m,getRouteParams:h,getRouteQuery:p,buildRouteUrl:g,canNavigateAway:y,confirmNavigation:v,generateBreadcrumbs:k,routeMap:t}}var Ht={name:"NewDocumentRequest",components:{ClientHeader:He,DocumentServicesSection:Pt},setup(){const e=(0,U.rd)(),t=(0,x.KR)(null),o=(0,x.KR)(!1),n=(0,x.KR)({requirements:[{id:1,text:"Valid government-issued ID (original and photocopy)"},{id:2,text:"Proof of residency (utility bill, lease agreement, etc.)"},{id:3,text:"Completed application form with accurate information"},{id:4,text:"Payment for processing fees"},{id:5,text:"Additional documents as specified for each document type"}],processSteps:[{number:1,title:"Choose Document Type",description:"Select the document you need from the available services"},{number:2,title:"Fill Application Form",description:"Complete all required fields with accurate information"},{number:3,title:"Upload Requirements",description:"Attach all necessary documents and supporting files"},{number:4,title:"Submit & Pay",description:"Review your application and proceed with payment"},{number:5,title:"Track Progress",description:"Monitor your request status and receive notifications"},{number:6,title:"Collect Document",description:"Pick up your processed document at the barangay office"}]}),{userData:i,loadUserData:r,resetUserData:c}=$t(),{documentTypes:l,loading:u,error:d,loadDocumentTypes:f}=Ft(),{userStats:m,loadUserStats:h}=Xt(),{uiState:p,toggleSidebar:g,toggleUserDropdown:y}=Wt(),{navigateToRoute:v,scrollToElement:k}=Bt(),{handleError:w}=Xe(),b=(0,s.EW)((()=>{console.log("=== NewDocumentRequest - userData from composable ==="),console.log("userData:",i),console.log("userData keys:",Object.keys(i));const e={userName:i.userName,userEmail:i.userEmail,userAvatar:i.userAvatar,firstName:i.firstName,lastName:i.lastName,middleName:i.middleName,suffix:i.suffix,profile:i.profile};return console.log("headerUserData result:",e),e})),q=(0,s.EW)((()=>({showUserDropdown:p.showUserDropdown,sidebarCollapsed:p.sidebarCollapsed,activeMenu:"services"}))),D=(0,s.EW)((()=>{const e=a(9197)["default"],t=e.getCurrentUser(),s="active"===t?.status;return s})),C=(0,x.KR)({status:"loading",canRequestDocuments:!1,message:"Checking residency verification status...",documents:[]}),L=async()=>{try{const e=a(5248).A,t=await e.getResidencyVerificationStatus();C.value=t}catch(d){console.error("Error loading residency status:",d),C.value={status:"error",canRequestDocuments:!1,message:"Unable to check residency verification status",documents:[]}}},R=(0,x.KR)(!1),E=async()=>{if(!R.value){console.log("Refreshing residency verification status..."),R.value=!0;try{await L(),C.value.canRequestDocuments&&console.log("‚úÖ Residency verification approved! You can now request documents.")}finally{R.value=!1}}},_=(0,s.EW)((()=>D.value&&C.value.canRequestDocuments)),N=(0,s.EW)((()=>D.value?C.value.message:"Account verification required"));let S=null;(0,s.sV)((async()=>{try{await Promise.all([r(),f(),h(),L()]),S=setInterval((async()=>{"pending"===C.value.status&&(console.log("Checking for residency status updates..."),await L())}),3e4)}catch(d){w(d,"Failed to initialize page data")}})),(0,s.hi)((()=>{S&&clearInterval(S)}));const A=()=>{g()},T=()=>{y()},M=e=>{v(e)},I=async()=>{try{const t=await Promise.resolve().then(a.bind(a,9197));t.default.logout(),c(),localStorage.clear(),sessionStorage.clear(),await e.push({name:"WelcomePage"}),window.location.reload()}catch(d){console.error("Logout error:",d),w(d,"Logout failed"),window.location.href="/login"}},P=e=>{console.log("Search query:",e)},$=async()=>{await(0,s.dY)(),k(t.value)},O=()=>{e.push({name:"MyRequests"})},F=()=>{e.push({name:"ClientTransactions"})},X=()=>{e.push({name:"ClientProfile"})},W=()=>{o.value=!0},B=()=>{o.value=!1},H=()=>{console.log("Opening FAQ...")},V=()=>{console.log("Contacting support...")},j=()=>{V()},K=t=>{if(!t.is_active)return;const a={"Barangay Clearance":"BarangayClearanceRequest",Cedula:"CedulaRequest"},s=a[t.type_name];s&&e.push({name:s,params:{documentTypeId:t.id}})};return{servicesSection:t,userData:i,documentTypes:l,userStats:m,uiState:p,loading:u,error:d,headerUserData:b,headerUIState:q,isAccountActive:D,canRequestDocuments:_,statusMessage:N,residencyStatus:C,refreshingStatus:R,handleSidebarToggle:A,handleUserDropdownToggle:T,handleMenuAction:M,handleLogout:I,handleError:w,handleSearch:P,scrollToServices:$,goToMyRequests:O,goToTransactions:F,goToProfile:X,openHelp:W,closeDialog:B,handleOpenFAQ:H,handleContactSupport:V,contactSupport:j,selectDocumentType:K,loadResidencyStatus:L,refreshResidencyStatus:E,showHelpDialog:o,helpData:n,loadDocumentTypes:f}}};const Vt=(0,fe.A)(Ht,[["render",T],["__scopeId","data-v-38ec8e3c"]]);var jt=Vt}}]);