"use strict";(self["webpackChunkbosfdr"]=self["webpackChunkbosfdr"]||[]).push([[419,599],{1137:function(e,t,a){a(4114),a(8111),a(2489),a(116);class r{constructor(){this.baseUrl="/api/address",this.cache={regions:null,provinces:null,cities:null,barangays:null}}async getRegions(){if(this.cache.regions)return this.cache.regions;try{const e=await fetch(`${this.baseUrl}/regions`);if(!e.ok)throw new Error(`Failed to fetch regions: ${e.status} ${e.statusText}`);const t=await e.json(),a=t.success?t.data:t;if(!Array.isArray(a))throw new Error("Invalid regions data format");return this.cache.regions=a,a}catch(e){throw console.error("Error fetching regions:",e),e}}async getProvincesByRegion(e){try{if(!this.cache.provinces){const e=await fetch(`${this.baseUrl}/provinces`);if(!e.ok)throw new Error("Failed to fetch provinces");const t=await e.json(),a=t.success?t.data:t;if(!Array.isArray(a))throw new Error("Invalid provinces data format");this.cache.provinces=a}return this.cache.provinces.filter((t=>t.region_code===e)).sort(((e,t)=>e.province_name.localeCompare(t.province_name)))}catch(t){throw console.error("Error fetching provinces:",t),t}}async getCitiesByProvince(e){try{if(!this.cache.cities){const e=await fetch(`${this.baseUrl}/cities`);if(!e.ok)throw new Error("Failed to fetch cities");const t=await e.json(),a=t.success?t.data:t;if(!Array.isArray(a))throw new Error("Invalid cities data format");this.cache.cities=a}return this.cache.cities.filter((t=>t.province_code===e)).sort(((e,t)=>e.city_name.localeCompare(t.city_name)))}catch(t){throw console.error("Error fetching cities:",t),t}}async getBarangaysByCity(e){try{if(!this.cache.barangays){const e=await fetch(`${this.baseUrl}/barangays`);if(!e.ok)throw new Error("Failed to fetch barangays");const t=await e.json(),a=t.success?t.data:t;if(!Array.isArray(a))throw new Error("Invalid barangays data format");this.cache.barangays=a}return this.cache.barangays.filter((t=>t.city_code===e)).sort(((e,t)=>e.brgy_name.localeCompare(t.brgy_name)))}catch(t){throw console.error("Error fetching barangays:",t),t}}async findBarangayBula(){try{if(!this.cache.barangays){const e=await fetch(`${this.baseUrl}/barangays`);if(!e.ok)throw new Error("Failed to fetch barangays");this.cache.barangays=await e.json()}const t=this.cache.barangays.filter((e=>e.brgy_name.toLowerCase().includes("bula"))),a=[];for(const r of t)try{const e=this.cache.cities?.find((e=>e.city_code===r.city_code)),t=this.cache.provinces?.find((e=>e.province_code===r.province_code)),s=this.cache.regions?.find((e=>e.region_code===r.region_code));a.push({...r,city_name:e?.city_name||"Unknown City",province_name:t?.province_name||"Unknown Province",region_name:s?.region_name||"Unknown Region"})}catch(e){console.warn("Error getting details for barangay:",r.brgy_name,e),a.push(r)}return a}catch(e){throw console.error("Error finding Barangay Bula:",e),e}}async getCompleteAddress(e){try{this.cache.barangays||await this.getBarangaysByCity("");const t=this.cache.barangays.find((t=>t.brgy_code===e));if(!t)throw new Error("Barangay not found");const a=this.cache.cities?.find((e=>e.city_code===t.city_code)),r=this.cache.provinces?.find((e=>e.province_code===t.province_code)),s=this.cache.regions?.find((e=>e.region_code===t.region_code));return{barangay:t.brgy_name,city:a?.city_name||"Unknown City",province:r?.province_name||"Unknown Province",region:s?.region_name||"Unknown Region",codes:{barangay:e,city:t.city_code,province:t.province_code,region:t.region_code}}}catch(t){throw console.error("Error getting complete address:",t),t}}clearCache(){this.cache={regions:null,provinces:null,cities:null,barangays:null}}async preloadAddressData(){try{await Promise.all([this.getRegions(),this.getProvincesByRegion("01"),this.getCitiesByProvince("0128"),this.getBarangaysByCity("012801")]),console.log("Address data preloaded successfully")}catch(e){console.warn("Failed to preload address data:",e)}}async validateAddress(e,t,a,r){try{const s=await this.getRegions(),o=s.find((t=>t.region_code===e));if(!o)return{valid:!1,error:"Invalid region"};const n=await this.getProvincesByRegion(e),i=n.find((e=>e.province_code===t));if(!i)return{valid:!1,error:"Invalid province for selected region"};const c=await this.getCitiesByProvince(t),l=c.find((e=>e.city_code===a));if(!l)return{valid:!1,error:"Invalid city for selected province"};const d=await this.getBarangaysByCity(a),u=d.find((e=>e.brgy_code===r));return u?{valid:!0}:{valid:!1,error:"Invalid barangay for selected city"}}catch(s){return{valid:!1,error:s.message}}}}const s=new r;t.A=s},1919:function(e,t,a){a.d(t,{A:function(){return I}});var r=a(6768),s=a(4232),o=a(5130);const n={class:"file-upload-component"},i={class:"form-group"},c=["for"],l={key:0,class:"text-danger"},d={class:"file-input-wrapper"},u=["id","accept","required"],h={key:0,class:"file-input-placeholder"},p={class:"text-muted d-block mt-1"},g={key:1,class:"file-selected"},y={class:"file-info"},m={class:"file-name"},f={class:"file-size text-muted"},w={key:2,class:"file-uploaded"},v={class:"file-info"},_={class:"file-name"},P={key:0,class:"upload-progress mt-2"},b={class:"progress"},E={class:"text-muted"},F={key:1,class:"alert alert-danger mt-2"},k={key:2,class:"form-text text-muted"};function A(e,t,a,A,M,q){return(0,r.uX)(),(0,r.CE)("div",n,[(0,r.Lk)("div",i,[(0,r.Lk)("label",{for:M.inputId,class:"form-label"},[(0,r.eW)((0,s.v_)(a.label)+" ",1),a.required?((0,r.uX)(),(0,r.CE)("span",l,"*")):(0,r.Q3)("",!0)],8,c),(0,r.Lk)("div",d,[(0,r.Lk)("input",{id:M.inputId,type:"file",accept:a.acceptedTypes,required:a.required,class:"file-input",onChange:t[0]||(t[0]=(...e)=>q.handleFileSelect&&q.handleFileSelect(...e)),ref:"fileInput"},null,40,u),(0,r.Lk)("div",{class:"file-input-display",onClick:t[3]||(t[3]=(...e)=>q.triggerFileInput&&q.triggerFileInput(...e))},[M.selectedFile||M.uploadedFile?M.selectedFile?((0,r.uX)(),(0,r.CE)("div",g,[(0,r.Lk)("i",{class:(0,s.C4)(q.getFileIcon(M.selectedFile.type))},null,2),(0,r.Lk)("div",y,[(0,r.Lk)("span",m,(0,s.v_)(M.selectedFile.name),1),(0,r.Lk)("small",f,(0,s.v_)(q.formatFileSize(M.selectedFile.size)),1)]),(0,r.Lk)("button",{type:"button",class:"btn btn-sm btn-outline-danger",onClick:t[1]||(t[1]=(0,o.D$)(((...e)=>q.removeFile&&q.removeFile(...e)),["stop"]))},t[5]||(t[5]=[(0,r.Lk)("i",{class:"fas fa-times"},null,-1)]))])):M.uploadedFile?((0,r.uX)(),(0,r.CE)("div",w,[t[8]||(t[8]=(0,r.Lk)("i",{class:"fas fa-check-circle text-success"},null,-1)),(0,r.Lk)("div",v,[(0,r.Lk)("span",_,(0,s.v_)(M.uploadedFile.name),1),t[6]||(t[6]=(0,r.Lk)("small",{class:"text-success"},"Uploaded successfully",-1))]),(0,r.Lk)("button",{type:"button",class:"btn btn-sm btn-outline-secondary",onClick:t[2]||(t[2]=(0,o.D$)(((...e)=>q.replaceFile&&q.replaceFile(...e)),["stop"]))},t[7]||(t[7]=[(0,r.Lk)("i",{class:"fas fa-edit"},null,-1),(0,r.eW)(" Replace ")]))])):(0,r.Q3)("",!0):((0,r.uX)(),(0,r.CE)("div",h,[t[4]||(t[4]=(0,r.Lk)("i",{class:"fas fa-cloud-upload-alt"},null,-1)),(0,r.Lk)("span",null,(0,s.v_)(a.placeholder),1),(0,r.Lk)("small",p,(0,s.v_)(a.acceptedTypesText),1)]))])]),M.uploading?((0,r.uX)(),(0,r.CE)("div",P,[(0,r.Lk)("div",b,[(0,r.Lk)("div",{class:"progress-bar",style:(0,s.Tr)({width:M.uploadProgress+"%"})},null,4)]),(0,r.Lk)("small",E,"Uploading... "+(0,s.v_)(M.uploadProgress)+"%",1)])):(0,r.Q3)("",!0),M.errorMessage?((0,r.uX)(),(0,r.CE)("div",F,[t[9]||(t[9]=(0,r.Lk)("i",{class:"fas fa-exclamation-triangle"},null,-1)),(0,r.eW)(" "+(0,s.v_)(M.errorMessage),1)])):(0,r.Q3)("",!0),a.helpText?((0,r.uX)(),(0,r.CE)("small",k,(0,s.v_)(a.helpText),1)):(0,r.Q3)("",!0)])])}a(8111),a(1701),a(3579);var M={name:"FileUpload",props:{label:{type:String,required:!0},placeholder:{type:String,default:"Click to select file or drag and drop"},required:{type:Boolean,default:!1},acceptedTypes:{type:String,default:"image/*"},acceptedTypesText:{type:String,default:"Accepted: JPEG, PNG, GIF (Max 5MB)"},helpText:{type:String,default:""},maxSize:{type:Number,default:5242880},uploadUrl:{type:String,default:""},autoUpload:{type:Boolean,default:!1}},data(){return{selectedFile:null,uploadedFile:null,uploading:!1,uploadProgress:0,errorMessage:"",inputId:`file-input-${Math.random().toString(36).substr(2,9)}`}},methods:{triggerFileInput(){this.$refs.fileInput.click()},handleFileSelect(e){const t=e.target.files[0];if(!t)return;const a=this.validateFile(t);a.valid?(this.errorMessage="",this.selectedFile=t,this.uploadedFile=null,this.$emit("file-selected",t),this.autoUpload&&this.uploadUrl&&this.uploadFile()):this.errorMessage=a.message},validateFile(e){if(e.size>this.maxSize)return{valid:!1,message:`File size too large. Maximum size is ${this.formatFileSize(this.maxSize)}.`};const t=this.acceptedTypes.split(",").map((e=>e.trim())),a=t.some((t=>"image/*"===t?e.type.startsWith("image/"):"application/*"===t?e.type.startsWith("application/"):e.type===t));return a?{valid:!0}:{valid:!1,message:"Invalid file type. "+this.acceptedTypesText}},async uploadFile(){if(this.selectedFile&&this.uploadUrl){this.uploading=!0,this.uploadProgress=0,this.errorMessage="";try{const e=new FormData;e.append("file",this.selectedFile);const t=await this.$http.post(this.uploadUrl,e,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:e=>{this.uploadProgress=Math.round(100*e.loaded/e.total)}});if(!t.data.success)throw new Error(t.data.message||"Upload failed");this.uploadedFile={name:this.selectedFile.name,...t.data.data},this.selectedFile=null,this.$emit("upload-success",this.uploadedFile)}catch(e){this.errorMessage=e.response?.data?.message||e.message||"Upload failed",this.$emit("upload-error",e)}finally{this.uploading=!1,this.uploadProgress=0}}},removeFile(){this.selectedFile=null,this.uploadedFile=null,this.errorMessage="",this.$refs.fileInput.value="",this.$emit("file-removed")},replaceFile(){this.uploadedFile=null,this.triggerFileInput()},getFileIcon(e){return e.startsWith("image/")?"fas fa-image text-primary":"application/pdf"===e?"fas fa-file-pdf text-danger":e.includes("word")?"fas fa-file-word text-primary":"fas fa-file text-secondary"},formatFileSize(e){if(0===e)return"0 Bytes";const t=1024,a=["Bytes","KB","MB","GB"],r=Math.floor(Math.log(e)/Math.log(t));return parseFloat((e/Math.pow(t,r)).toFixed(2))+" "+a[r]}}},q=a(1241);const C=(0,q.A)(M,[["render",A],["__scopeId","data-v-66ba2e88"]]);var I=C},1939:function(e,t,a){a(8111),a(7588);var r=a(4300);class s{async getDocumentTypes(){try{const e=await r["default"].get("/client/document-requests/document-types");return e.data}catch(e){throw console.error("Error fetching document types:",e),e}}async getPurposeCategories(){try{const e=await r["default"].get("/client/document-requests/purpose-categories");return e.data}catch(e){throw console.error("Error fetching purpose categories:",e),e}}async getPaymentMethods(){try{const e=await r["default"].get("/client/document-requests/payment-methods");return e.data}catch(e){throw console.error("Error fetching payment methods:",e),e}}async submitRequest(e){try{const t=await r["default"].post("/client/document-requests",e);return t.data}catch(t){throw console.error("Error submitting request:",t),t}}async getMyRequests(e={}){try{const t=new URLSearchParams;Object.keys(e).forEach((a=>{null!==e[a]&&void 0!==e[a]&&""!==e[a]&&t.append(a,e[a])}));const a=await r["default"].get(`/client/document-requests?${t.toString()}`);return a.data}catch(t){throw console.error("Error fetching requests:",t),t}}async getRequestDetails(e){try{const t=await r["default"].get(`/client/document-requests/${e}`);return t.data}catch(t){throw console.error("Error fetching request details:",t),t}}async updateRequest(e,t){try{const a=await r["default"].put(`/client/document-requests/${e}`,t);return a.data}catch(a){throw console.error("Error updating request:",a),a}}async cancelRequest(e,t){try{const a=await r["default"].put(`/client/document-requests/${e}/cancel`,{reason:t});return a.data}catch(a){throw console.error("Error cancelling request:",a),a}}async getRequestHistory(e){try{const t=await r["default"].get(`/client/document-requests/${e}/history`);return t.data}catch(t){throw console.error("Error fetching request history:",t),t}}async processPayment(e,t){try{const a=await r["default"].post(`/client/document-requests/${e}/payment`,t);return a.data}catch(a){throw console.error("Error processing payment:",a),a}}async getPaymentStatus(e){try{const t=await r["default"].get(`/client/document-requests/${e}/payment/status`);return t.data}catch(t){throw console.error("Error fetching payment status:",t),t}}async calculateFees(e){try{const t=await r["default"].post("/client/document-requests/calculate-cedula-tax",e);return t.data}catch(t){throw console.error("Error calculating fees:",t),t}}async getDashboardStats(){return{success:!0,data:{total_requests:0,pending_requests:0,completed_requests:0,recent_activity:[]},message:"Dashboard stats placeholder"}}async getRecentActivity(e=10){try{return{success:!0,data:[],message:"Recent activity placeholder"}}catch(t){throw console.error("Error fetching recent activity:",t),t}}async uploadDocuments(e,t){try{const a=new FormData;t.forEach((({type:e,file:t})=>{a.append(e,t)}));const s=await r["default"].post(`/client/document-requests/${e}/documents`,a,{headers:{"Content-Type":"multipart/form-data"}});return s.data}catch(a){throw console.error("Error uploading documents:",a),a}}async getDocuments(e){try{const t=await r["default"].get(`/client/document-requests/${e}/documents`);return t.data}catch(t){throw console.error("Error fetching documents:",t),t}}async deleteDocument(e,t){try{const a=await r["default"].delete(`/client/document-requests/${e}/documents/${t}`);return a.data}catch(a){throw console.error("Error deleting document:",a),a}}async fetchVerificationImageBlob(e,t,a){try{const s=localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token");if(!s)throw new Error("Please log in to view images");console.log("ðŸ”— Fetching verification image:",{requestId:e,imageType:t,filename:a,hasToken:!!s});const o=await r["default"].get(`/client/document-requests/${e}/verification-image/${t}/${a}`,{responseType:"blob"});return console.log("âœ… Image fetched successfully:",{filename:a,size:o.data.size,type:o.data.type}),o.data}catch(s){throw console.error(`âŒ Error fetching ${t} verification image:`,{status:s.response?.status,statusText:s.response?.statusText,data:s.response?.data,filename:a,imageType:t,requestId:e,message:s.message}),404===s.response?.status?new Error(`Image not found: ${a}`):401===s.response?.status?new Error("Please log in to view images"):403===s.response?.status?new Error("Access denied to this image"):500===s.response?.status||s.response?.status>=500?new Error("Server error - please contact support"):"NETWORK_ERROR"===s.code||s.message.includes("Network Error")?new Error("Network error - check your connection"):s.message.includes("log in")?new Error(s.message):new Error(s.response?.data?.message||s.message||"Failed to load image")}}async getVerificationImageObjectUrl(e,t,a){try{const r=await this.fetchVerificationImageBlob(e,t,a);return URL.createObjectURL(r)}catch(r){throw console.error(`Error creating object URL for ${t} image:`,r),r}}}t.A=new s},2599:function(e,t,a){a(4114),a(8111),a(116),a(7588);var r=a(4300);class s{async getPaymentConfig(){try{const e=await r["default"].get("/payments/config");return e.data}catch(e){throw console.error("Failed to get payment config:",e),e}}async initiatePayment(e){try{const t=await r["default"].post("/payments/initiate",e);return t.data}catch(t){throw console.error("Failed to initiate payment:",t),t}}async getPaymentStatus(e){try{const t=await r["default"].get(`/payments/status/${e}`);return t.data}catch(t){throw console.error("Failed to get payment status:",t),t}}async getPaymentVerificationQueue(){try{const e=await r["default"].get("/admin/documents/payment-verification-queue");return e.data}catch(e){throw console.error("Failed to get payment verification queue:",e),e}}async verifyInPersonPayment(e,t){try{const a=await r["default"].post(`/admin/documents/requests/${e}/verify-payment`,t);return a.data}catch(a){throw console.error("Failed to verify in-person payment:",a),a}}redirectToPayMongo(e){if(!e)throw new Error("Invalid checkout URL");window.location.href=e}formatAmount(e){return new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(e)}getPaymentMethodDisplayName(e){const t={CASH:"Cash Payment",ONLINE_PAYMENT_GROUP:"Online Payment",PAYMONGO_CARD:"Credit/Debit Card",PAYMONGO_GCASH:"GCash",PAYMONGO_GRABPAY:"GrabPay",PAYMONGO_PAYMAYA:"Maya (PayMaya)",PAYMONGO_BANK:"Bank Transfer"};return t[e]||e}groupPaymentMethods(e){if(!Array.isArray(e))return[];const t=[],a=[];e.forEach((e=>{this.isOnlinePaymentMethod(e.method_code)?a.push(e):t.push(e)}));const r=[];return t.forEach((e=>{r.push({id:e.id,method_name:e.method_name,method_code:e.method_code,description:e.description,is_online:e.is_online,is_active:e.is_active,processing_fee_percentage:e.processing_fee_percentage,processing_fee_fixed:e.processing_fee_fixed,group_type:"individual"})})),a.length>0&&r.push({id:"ONLINE_PAYMENT_GROUP",method_name:"Online Payment",method_code:"ONLINE_PAYMENT_GROUP",description:"Pay securely online using credit/debit card, GCash, GrabPay, Maya, or bank transfer",is_online:!0,is_active:!0,processing_fee_percentage:a[0]?.processing_fee_percentage||0,processing_fee_fixed:a[0]?.processing_fee_fixed||0,group_type:"group",grouped_methods:a}),r}getActualPaymentMethodId(e,t){if("ONLINE_PAYMENT_GROUP"===e){const e=["PAYMONGO_CARD","PAYMONGO_GCASH","PAYMONGO_GRABPAY","PAYMONGO_PAYMAYA","PAYMONGO_BANK"];for(const r of e){const e=t.find((e=>e.method_code===r&&e.is_active));if(e)return e.id}const a=t.find((e=>this.isOnlinePaymentMethod(e.method_code)&&e.is_active));return a?a.id:null}return parseInt(e)}isOnlinePaymentMethod(e){return e&&e.startsWith("PAYMONGO_")}getPaymentStatusDisplay(e){const t={pending:{text:"Pending",color:"warning",icon:"clock"},succeeded:{text:"Paid",color:"success",icon:"check-circle"},failed:{text:"Failed",color:"danger",icon:"x-circle"},cancelled:{text:"Cancelled",color:"secondary",icon:"x"}};return t[e]||{text:e,color:"secondary",icon:"help-circle"}}calculateProcessingFee(e,t=0,a=0){const r=e*t/100;return r+a}calculateTotalAmount(e,t=0,a=0){const r=this.calculateProcessingFee(e,t,a),s=e+r;return{baseAmount:e,processingFee:r,totalAmount:s,formattedBase:this.formatAmount(e),formattedFee:this.formatAmount(r),formattedTotal:this.formatAmount(s)}}validatePaymentData(e){const t=[];return e.request_id||t.push("Request ID is required"),e.payment_method_id||t.push("Payment method is required"),e.customer_email&&!this.isValidEmail(e.customer_email)&&t.push("Invalid email format"),{isValid:0===t.length,errors:t}}isValidEmail(e){const t=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;return t.test(e)}getErrorMessage(e){return e.response?.data?.message?e.response.data.message:400===e.response?.status?"Invalid payment information. Please check your details and try again.":401===e.response?.status?"You need to be logged in to make a payment.":404===e.response?.status?"Payment service not found. Please contact support.":e.response?.status>=500?"Payment service is temporarily unavailable. Please try again later.":e.message||"An unexpected error occurred during payment processing."}}t["default"]=new s}}]);