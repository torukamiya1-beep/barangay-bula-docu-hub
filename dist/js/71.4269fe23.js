"use strict";(self["webpackChunkbosfdr"]=self["webpackChunkbosfdr"]||[]).push([[71,674],{662:function(e,r,t){t.d(r,{TL:function(){return s},m_:function(){return o},y$:function(){return a}});t(8111),t(7588);const a={required:(e,r="Field")=>!e||"string"===typeof e&&""===e.trim()?`${r} is required`:null,email:e=>{if(!e)return null;const r=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;return r.test(e)?null:"Please enter a valid email address"},username:e=>e?e.length<3||e.length>50?"Username must be between 3 and 50 characters":/^[a-zA-Z0-9_]+$/.test(e)?null:"Username can only contain letters, numbers, and underscores":null,password:e=>e?e.length<8?"Password must be at least 8 characters long":/(?=.*[a-z])(?=.*[A-Z])(?=.*\d)/.test(e)?null:"Password must contain at least one uppercase letter, one lowercase letter, and one number":null,confirmPassword:(e,r)=>e&&e!==r?"Passwords do not match":null,phoneNumber:e=>{if(!e)return null;const r=e.replace(/\s/g,""),t=/^09\d{9}$/;return t.test(r)?null:"Please enter a valid Philippine phone number (09XXXXXXXXX - 11 digits starting with 09)"},name:(e,r="Name")=>e?e.length<1||e.length>100?`${r} must be between 1 and 100 characters`:/^[a-zA-Z\s\-.]+$/.test(e)?null:`${r} can only contain letters, spaces, hyphens, and periods`:null,date:(e,r="Date")=>{if(!e)return null;const t=new Date(e);return isNaN(t.getTime())?`Please enter a valid ${r.toLowerCase()}`:null},birthDate:e=>{if(!e)return null;const r=new Date(e),t=new Date;if(isNaN(r.getTime()))return"Please enter a valid birth date";if(r>=t)return"Birth date must be in the past";const a=t.getFullYear()-r.getFullYear();return a>150?"Please enter a valid birth date":a<13?"You must be at least 13 years old to register":null},otp:e=>e?/^\d{4,10}$/.test(e)?null:"OTP must be a 4-10 digit number":null,address:(e,r="Address")=>e&&(e.length<1||e.length>100)?`${r} must be between 1 and 100 characters`:null,postalCode:e=>e?/^\d{4}$/.test(e)?null:"Postal code must be 4 digits":null,minLength:(e,r,t="Field")=>e&&e.length<r?`${t} must be at least ${r} characters`:null,maxLength:(e,r,t="Field")=>e&&e.length>r?`${t} must be less than ${r} characters`:null,exactLength:(e,r,t="Field")=>e&&e.length!==r?`${t} must be exactly ${r} characters`:null,passwordMatch:(e,r)=>e&&e!==r?"Passwords do not match":null,phone:e=>a.phoneNumber(e)},s=e=>{if(!Array.isArray(e))return{};const r={};return e.forEach((e=>{e.path&&(r[e.path]=e.msg||e.message)})),r},o=(e,r)=>{const t={...e};return delete t[r],t}},2674:function(e,r,t){t.r(r);t(8111),t(3579),t(4979);var a=t(4300);class s{async registerAccount(e){try{const r=await a["default"].post("/admin/auth/register-account",e);return r.data}catch(r){throw this.handleError(r)}}async completeRegistration(e,r){try{const t=await a["default"].post(`/admin/auth/complete-registration/${e}`,r);return t.data}catch(t){throw this.handleError(t)}}async verifyEmail(e,r){try{const t=await a["default"].post("/admin/auth/verify-email",{email:e,otp:r});return t.data}catch(t){throw this.handleError(t)}}async resendVerificationEmail(e){try{const r=await a["default"].post("/admin/auth/resend-verification",{email:e});return r.data}catch(r){throw this.handleError(r)}}async login(e){try{const r=await a["default"].post("/admin/auth/login",e);return r.data.success&&r.data.data.token&&(localStorage.setItem("adminToken",r.data.data.token),localStorage.setItem("adminData",JSON.stringify(r.data.data.admin))),r.data}catch(r){throw this.handleError(r)}}async getProfile(){try{const e=await a["default"].get("/admin/auth/profile");return e.data.success&&e.data.data&&localStorage.setItem("adminData",JSON.stringify(e.data.data)),e.data}catch(e){throw this.handleError(e)}}async updateProfile(e){try{const r=await a["default"].put("/admin/auth/profile",e);return r.data.success&&r.data.data&&localStorage.setItem("adminData",JSON.stringify(r.data.data)),r.data}catch(r){throw this.handleError(r)}}async changePassword(e){try{const r=await a["default"].put("/admin/auth/change-password",e);return r.data}catch(r){throw this.handleError(r)}}async sendPasswordReset(e){try{const r=await a["default"].post("/admin/auth/forgot-password",{email:e});return r.data}catch(r){throw this.handleError(r)}}async resetPassword(e,r){try{const t=await a["default"].post("/admin/auth/reset-password",{token:e,newPassword:r});return t.data}catch(t){throw this.handleError(t)}}async getDashboardStats(){try{const e=await a["default"].get("/admin/dashboard/stats");return e.data}catch(e){throw this.handleError(e)}}async getRecentActivity(e=10){try{const r=await a["default"].get(`/admin/dashboard/activity?limit=${e}`);return r.data}catch(r){throw this.handleError(r)}}async getNotifications(e=20){try{const r=await a["default"].get(`/admin/notifications?limit=${e}`);return r.data}catch(r){throw this.handleError(r)}}async markNotificationAsRead(e){try{const r=await a["default"].put(`/admin/notifications/${e}/read`);return r.data}catch(r){throw this.handleError(r)}}async markAllNotificationsAsRead(){try{const e=await a["default"].put("/admin/notifications/read-all");return e.data}catch(e){throw this.handleError(e)}}async logout(){try{await a["default"].post("/admin/auth/logout")}catch(e){console.error("Logout API error:",e)}finally{this.clearAuthData()}}clearAuthData(){localStorage.removeItem("adminToken"),localStorage.removeItem("adminData")}isLoggedIn(){const e=localStorage.getItem("adminToken");return!!e}isAuthenticated(){const e=localStorage.getItem("adminToken"),r=this.getAdminData();if(!e||!r)return!1;try{const r=e.split(".");if(3!==r.length)return!1;const t=JSON.parse(atob(r[1])),a=Math.floor(Date.now()/1e3);return t.exp&&t.exp<a?(this.clearAuthData(),!1):"admin"===t.type||(this.clearAuthData(),!1)}catch(t){return console.error("Token validation error:",t),this.clearAuthData(),!1}}hasRole(e){const r=this.getAdminData();return!(!r||!this.isAuthenticated())&&("admin"===r.role||r.role===e)}hasAnyRole(e){return Array.isArray(e)?e.some((e=>this.hasRole(e))):this.hasRole(e)}getAdminData(){const e=localStorage.getItem("adminData");return e?JSON.parse(e):null}getToken(){return localStorage.getItem("adminToken")}async sendOTP(e,r="registration",t=""){try{const s=await a["default"].post("/otp/send",{email:e,purpose:r,firstName:t});return s.data}catch(s){throw this.handleError(s)}}async verifyOTP(e,r,t="registration"){try{const s=await a["default"].post("/otp/verify",{email:e,otp:r,purpose:t});return s.data}catch(s){throw this.handleError(s)}}async resendOTP(e,r="registration",t=""){try{const s=await a["default"].post("/otp/resend",{email:e,purpose:r,firstName:t});return s.data}catch(s){throw this.handleError(s)}}initializeAuth(){this.getToken()}handleError(e){if(e.response){const r=e.response.data?.message||"An error occurred",t=e.response.data?.errors||[];return new Error(JSON.stringify({message:r,errors:t,status:e.response.status}))}return e.request?new Error(JSON.stringify({message:"Network error. Please check your connection.",errors:[],status:0})):new Error(JSON.stringify({message:e.message||"An unexpected error occurred",errors:[],status:0}))}parseError(e){try{return JSON.parse(e.message)}catch{return{message:e.message,errors:[],status:0}}}}r["default"]=new s},6071:function(e,r,t){t.r(r),t.d(r,{default:function(){return we}});var a=t(6768),s=t(4232),o=t(5130);const i={class:"admin-registration"},n={class:"container-fluid min-vh-100 d-flex align-items-center justify-content-center bg-light"},l={class:"row w-100 justify-content-center"},c={class:"col-12 col-md-8 col-lg-6 col-xl-5"},d={class:"card shadow-lg border-0"},u={class:"card-body p-4"},m={class:"row mb-4"},p={class:"col-12"},h={class:"d-flex justify-content-between align-items-center"},f={key:0,class:"step-content"},b={class:"mb-3"},g={key:0,class:"invalid-feedback"},y={class:"mb-3"},k={key:0,class:"invalid-feedback"},v={class:"mb-3"},w={key:0,class:"invalid-feedback"},L={class:"mb-3"},F={class:"input-group"},E=["type"],_={key:0,class:"invalid-feedback d-block"},P={class:"mb-4"},C={key:0,class:"invalid-feedback"},S={class:"d-grid gap-2"},x=["disabled"],A={key:0,class:"spinner-border spinner-border-sm me-2"},$={key:1,class:"step-content"},I={class:"row"},N={class:"col-md-6 mb-3"},V={key:0,class:"invalid-feedback"},D={class:"col-md-6 mb-3"},M={key:0,class:"invalid-feedback"},X={class:"row"},T={class:"col-md-6 mb-3"},q={class:"col-md-6 mb-3"},J={class:"row"},O={class:"col-md-6 mb-3"},R={class:"col-md-6 mb-3"},U={key:0,class:"invalid-feedback"},Q={class:"row"},W={class:"col-md-6 mb-3"},B={class:"col-md-6 mb-3"},Y={class:"row"},z={class:"col-md-6 mb-3"},j={class:"d-grid gap-2 d-md-flex justify-content-md-between"},Z=["disabled"],G={key:0,class:"spinner-border spinner-border-sm me-2"},H={key:2,class:"step-content"},K={class:"text-center"},ee={class:"text-muted mb-4"},re={class:"mb-3"},te={key:0,class:"invalid-feedback"},ae={class:"d-grid gap-2 mb-3"},se=["disabled"],oe={key:0,class:"spinner-border spinner-border-sm me-2"},ie={class:"text-center"},ne=["disabled"],le={key:0,class:"spinner-border spinner-border-sm me-2"},ce={key:3,class:"step-content text-center"},de={class:"d-grid gap-2"},ue={key:4,class:"alert alert-danger mt-3",role:"alert"},me={key:5,class:"alert alert-success mt-3",role:"alert"},pe={class:"card-footer text-center py-3"},he={class:"mb-0 text-muted"};function fe(e,r,t,fe,be,ge){const ye=(0,a.g2)("router-link");return(0,a.uX)(),(0,a.CE)("div",i,[(0,a.Lk)("div",n,[(0,a.Lk)("div",l,[(0,a.Lk)("div",c,[(0,a.Lk)("div",d,[r[76]||(r[76]=(0,a.Lk)("div",{class:"card-header bg-success text-white text-center py-4"},[(0,a.Lk)("h3",{class:"mb-0"},[(0,a.Lk)("i",{class:"fas fa-user-plus me-2"}),(0,a.eW)(" Admin Registration ")]),(0,a.Lk)("p",{class:"mb-0 mt-2"},"Barangay Bula Management System")],-1)),(0,a.Lk)("div",u,[(0,a.Lk)("div",m,[(0,a.Lk)("div",p,[(0,a.Lk)("div",h,[(0,a.Lk)("div",{class:(0,s.C4)(["step-indicator",{active:be.currentStep>=1,completed:be.currentStep>1}])},r[38]||(r[38]=[(0,a.Lk)("div",{class:"step-number"},"1",-1),(0,a.Lk)("div",{class:"step-label"},"Account",-1)]),2),(0,a.Lk)("div",{class:(0,s.C4)(["step-line",{active:be.currentStep>1}])},null,2),(0,a.Lk)("div",{class:(0,s.C4)(["step-indicator",{active:be.currentStep>=2,completed:be.currentStep>2}])},r[39]||(r[39]=[(0,a.Lk)("div",{class:"step-number"},"2",-1),(0,a.Lk)("div",{class:"step-label"},"Profile",-1)]),2),(0,a.Lk)("div",{class:(0,s.C4)(["step-line",{active:be.currentStep>2}])},null,2),(0,a.Lk)("div",{class:(0,s.C4)(["step-indicator",{active:be.currentStep>=3,completed:be.currentStep>3}])},r[40]||(r[40]=[(0,a.Lk)("div",{class:"step-number"},"3",-1),(0,a.Lk)("div",{class:"step-label"},"Verify",-1)]),2)])])]),1===be.currentStep?((0,a.uX)(),(0,a.CE)("div",f,[r[49]||(r[49]=(0,a.Lk)("h5",{class:"mb-3"},"Create Admin Account",-1)),(0,a.Lk)("form",{onSubmit:r[15]||(r[15]=(0,o.D$)(((...e)=>ge.submitAccountForm&&ge.submitAccountForm(...e)),["prevent"]))},[(0,a.Lk)("div",b,[r[41]||(r[41]=(0,a.Lk)("label",{for:"username",class:"form-label"},"Username",-1)),(0,a.bo)((0,a.Lk)("input",{type:"text",class:(0,s.C4)(["form-control",{"is-invalid":be.errors.username}]),id:"username","onUpdate:modelValue":r[0]||(r[0]=e=>be.accountForm.username=e),onBlur:r[1]||(r[1]=e=>ge.validateField("username")),onInput:r[2]||(r[2]=e=>ge.clearFieldError("username")),placeholder:"Enter your username",required:""},null,34),[[o.Jo,be.accountForm.username]]),be.errors.username?((0,a.uX)(),(0,a.CE)("div",g,(0,s.v_)(be.errors.username),1)):(0,a.Q3)("",!0)]),(0,a.Lk)("div",y,[r[42]||(r[42]=(0,a.Lk)("label",{for:"email",class:"form-label"},"Email Address",-1)),(0,a.bo)((0,a.Lk)("input",{type:"email",class:(0,s.C4)(["form-control",{"is-invalid":be.errors.email}]),id:"email","onUpdate:modelValue":r[3]||(r[3]=e=>be.accountForm.email=e),onBlur:r[4]||(r[4]=e=>ge.validateField("email")),onInput:r[5]||(r[5]=e=>ge.clearFieldError("email")),placeholder:"Enter your email address",required:""},null,34),[[o.Jo,be.accountForm.email]]),be.errors.email?((0,a.uX)(),(0,a.CE)("div",k,(0,s.v_)(be.errors.email),1)):(0,a.Q3)("",!0)]),(0,a.Lk)("div",v,[r[44]||(r[44]=(0,a.Lk)("label",{for:"role",class:"form-label"},"Role",-1)),(0,a.bo)((0,a.Lk)("select",{class:(0,s.C4)(["form-select",{"is-invalid":be.errors.role}]),id:"role","onUpdate:modelValue":r[6]||(r[6]=e=>be.accountForm.role=e),onChange:r[7]||(r[7]=e=>ge.clearFieldError("role")),required:""},r[43]||(r[43]=[(0,a.Lk)("option",{value:""},"Select Role",-1),(0,a.Lk)("option",{value:"admin"},"System Administrator",-1),(0,a.Lk)("option",{value:"employee"},"Barangay Employee",-1),(0,a.Lk)("option",{value:"staff"},"Support Staff",-1)]),34),[[o.u1,be.accountForm.role]]),be.errors.role?((0,a.uX)(),(0,a.CE)("div",w,(0,s.v_)(be.errors.role),1)):(0,a.Q3)("",!0),r[45]||(r[45]=(0,a.Lk)("div",{class:"form-text"}," Choose the appropriate role for this admin account. ",-1))]),(0,a.Lk)("div",L,[r[46]||(r[46]=(0,a.Lk)("label",{for:"password",class:"form-label"},"Password",-1)),(0,a.Lk)("div",F,[(0,a.bo)((0,a.Lk)("input",{type:be.showPassword?"text":"password",class:(0,s.C4)(["form-control",{"is-invalid":be.errors.password}]),id:"password","onUpdate:modelValue":r[8]||(r[8]=e=>be.accountForm.password=e),onBlur:r[9]||(r[9]=e=>ge.validateField("password")),onInput:r[10]||(r[10]=e=>ge.clearFieldError("password")),placeholder:"Enter your password",required:""},null,42,E),[[o.hp,be.accountForm.password]]),(0,a.Lk)("button",{type:"button",class:"btn btn-outline-secondary",onClick:r[11]||(r[11]=e=>be.showPassword=!be.showPassword)},[(0,a.Lk)("i",{class:(0,s.C4)(be.showPassword?"fas fa-eye-slash":"fas fa-eye")},null,2)])]),be.errors.password?((0,a.uX)(),(0,a.CE)("div",_,(0,s.v_)(be.errors.password),1)):(0,a.Q3)("",!0),r[47]||(r[47]=(0,a.Lk)("div",{class:"form-text"}," Password must be at least 8 characters with uppercase, lowercase, and number. ",-1))]),(0,a.Lk)("div",P,[r[48]||(r[48]=(0,a.Lk)("label",{for:"confirmPassword",class:"form-label"},"Confirm Password",-1)),(0,a.bo)((0,a.Lk)("input",{type:"password",class:(0,s.C4)(["form-control",{"is-invalid":be.errors.confirmPassword}]),id:"confirmPassword","onUpdate:modelValue":r[12]||(r[12]=e=>be.accountForm.confirmPassword=e),onBlur:r[13]||(r[13]=e=>ge.validateField("confirmPassword")),onInput:r[14]||(r[14]=e=>ge.clearFieldError("confirmPassword")),placeholder:"Confirm your password",required:""},null,34),[[o.Jo,be.accountForm.confirmPassword]]),be.errors.confirmPassword?((0,a.uX)(),(0,a.CE)("div",C,(0,s.v_)(be.errors.confirmPassword),1)):(0,a.Q3)("",!0)]),(0,a.Lk)("div",S,[(0,a.Lk)("button",{type:"submit",class:"btn btn-success",disabled:be.loading},[be.loading?((0,a.uX)(),(0,a.CE)("span",A)):(0,a.Q3)("",!0),(0,a.eW)(" "+(0,s.v_)(be.loading?"Creating Account...":"Create Account"),1)],8,x)])],32)])):(0,a.Q3)("",!0),2===be.currentStep?((0,a.uX)(),(0,a.CE)("div",$,[r[61]||(r[61]=(0,a.Lk)("h5",{class:"mb-3"},"Complete Your Profile",-1)),(0,a.Lk)("form",{onSubmit:r[32]||(r[32]=(0,o.D$)(((...e)=>ge.submitProfileForm&&ge.submitProfileForm(...e)),["prevent"]))},[(0,a.Lk)("div",I,[(0,a.Lk)("div",N,[r[50]||(r[50]=(0,a.Lk)("label",{for:"firstName",class:"form-label"},"First Name",-1)),(0,a.bo)((0,a.Lk)("input",{type:"text",class:(0,s.C4)(["form-control",{"is-invalid":be.errors.first_name}]),id:"firstName","onUpdate:modelValue":r[16]||(r[16]=e=>be.profileForm.first_name=e),onBlur:r[17]||(r[17]=e=>ge.validateField("first_name")),onInput:r[18]||(r[18]=e=>ge.clearFieldError("first_name")),required:""},null,34),[[o.Jo,be.profileForm.first_name]]),be.errors.first_name?((0,a.uX)(),(0,a.CE)("div",V,(0,s.v_)(be.errors.first_name),1)):(0,a.Q3)("",!0)]),(0,a.Lk)("div",D,[r[51]||(r[51]=(0,a.Lk)("label",{for:"lastName",class:"form-label"},"Last Name",-1)),(0,a.bo)((0,a.Lk)("input",{type:"text",class:(0,s.C4)(["form-control",{"is-invalid":be.errors.last_name}]),id:"lastName","onUpdate:modelValue":r[19]||(r[19]=e=>be.profileForm.last_name=e),onBlur:r[20]||(r[20]=e=>ge.validateField("last_name")),onInput:r[21]||(r[21]=e=>ge.clearFieldError("last_name")),required:""},null,34),[[o.Jo,be.profileForm.last_name]]),be.errors.last_name?((0,a.uX)(),(0,a.CE)("div",M,(0,s.v_)(be.errors.last_name),1)):(0,a.Q3)("",!0)])]),(0,a.Lk)("div",X,[(0,a.Lk)("div",T,[r[52]||(r[52]=(0,a.Lk)("label",{for:"middleName",class:"form-label"},"Middle Name (Optional)",-1)),(0,a.bo)((0,a.Lk)("input",{type:"text",class:"form-control",id:"middleName","onUpdate:modelValue":r[22]||(r[22]=e=>be.profileForm.middle_name=e)},null,512),[[o.Jo,be.profileForm.middle_name]])]),(0,a.Lk)("div",q,[r[53]||(r[53]=(0,a.Lk)("label",{for:"suffix",class:"form-label"},"Suffix (Optional)",-1)),(0,a.bo)((0,a.Lk)("input",{type:"text",class:"form-control",id:"suffix","onUpdate:modelValue":r[23]||(r[23]=e=>be.profileForm.suffix=e),placeholder:"Jr., Sr., III, etc."},null,512),[[o.Jo,be.profileForm.suffix]])])]),(0,a.Lk)("div",J,[(0,a.Lk)("div",O,[r[54]||(r[54]=(0,a.Lk)("label",{for:"employeeId",class:"form-label"},"Employee ID (Optional)",-1)),(0,a.bo)((0,a.Lk)("input",{type:"text",class:"form-control",id:"employeeId","onUpdate:modelValue":r[24]||(r[24]=e=>be.profileForm.employee_id=e),placeholder:"Enter employee ID"},null,512),[[o.Jo,be.profileForm.employee_id]])]),(0,a.Lk)("div",R,[r[55]||(r[55]=(0,a.Lk)("label",{for:"phoneNumber",class:"form-label"},"Phone Number",-1)),(0,a.bo)((0,a.Lk)("input",{type:"tel",class:(0,s.C4)(["form-control",{"is-invalid":be.errors.phone_number}]),id:"phoneNumber","onUpdate:modelValue":r[25]||(r[25]=e=>be.profileForm.phone_number=e),onBlur:r[26]||(r[26]=e=>ge.validateField("phone_number")),onInput:r[27]||(r[27]=(...e)=>ge.handlePhoneInput&&ge.handlePhoneInput(...e)),placeholder:"09123456789",maxlength:"11",pattern:"[0-9]*",required:""},null,34),[[o.Jo,be.profileForm.phone_number]]),be.errors.phone_number?((0,a.uX)(),(0,a.CE)("div",U,(0,s.v_)(be.errors.phone_number),1)):(0,a.Q3)("",!0)])]),r[60]||(r[60]=(0,a.Lk)("h6",{class:"mt-4 mb-3"},"Work Information",-1)),(0,a.Lk)("div",Q,[(0,a.Lk)("div",W,[r[56]||(r[56]=(0,a.Lk)("label",{for:"position",class:"form-label"},"Position",-1)),(0,a.bo)((0,a.Lk)("input",{type:"text",class:"form-control",id:"position","onUpdate:modelValue":r[28]||(r[28]=e=>be.profileForm.position=e),placeholder:"Enter your position"},null,512),[[o.Jo,be.profileForm.position]])]),(0,a.Lk)("div",B,[r[57]||(r[57]=(0,a.Lk)("label",{for:"department",class:"form-label"},"Department",-1)),(0,a.bo)((0,a.Lk)("input",{type:"text",class:"form-control",id:"department","onUpdate:modelValue":r[29]||(r[29]=e=>be.profileForm.department=e),placeholder:"Enter your department"},null,512),[[o.Jo,be.profileForm.department]])])]),(0,a.Lk)("div",Y,[(0,a.Lk)("div",z,[r[58]||(r[58]=(0,a.Lk)("label",{for:"hireDate",class:"form-label"},"Hire Date (Optional)",-1)),(0,a.bo)((0,a.Lk)("input",{type:"date",class:"form-control",id:"hireDate","onUpdate:modelValue":r[30]||(r[30]=e=>be.profileForm.hire_date=e)},null,512),[[o.Jo,be.profileForm.hire_date]])])]),(0,a.Lk)("div",j,[(0,a.Lk)("button",{type:"button",class:"btn btn-outline-secondary",onClick:r[31]||(r[31]=(...e)=>ge.goToPreviousStep&&ge.goToPreviousStep(...e))},r[59]||(r[59]=[(0,a.Lk)("i",{class:"fas fa-arrow-left me-2"},null,-1),(0,a.eW)(" Back ")])),(0,a.Lk)("button",{type:"submit",class:"btn btn-success",disabled:be.loading},[be.loading?((0,a.uX)(),(0,a.CE)("span",G)):(0,a.Q3)("",!0),(0,a.eW)(" "+(0,s.v_)(be.loading?"Saving Profile...":"Complete Registration"),1)],8,Z)])],32)])):(0,a.Q3)("",!0),3===be.currentStep?((0,a.uX)(),(0,a.CE)("div",H,[(0,a.Lk)("div",K,[r[64]||(r[64]=(0,a.Lk)("div",{class:"mb-4"},[(0,a.Lk)("i",{class:"fas fa-envelope-open-text text-success",style:{"font-size":"3rem"}})],-1)),r[65]||(r[65]=(0,a.Lk)("h5",{class:"mb-3"},"Verify Your Email",-1)),(0,a.Lk)("p",ee,[r[62]||(r[62]=(0,a.eW)(" We've sent a 6-digit verification code to ")),(0,a.Lk)("strong",null,(0,s.v_)(be.accountForm.email),1),r[63]||(r[63]=(0,a.eW)(". Please check your email and enter the code below to complete your registration. "))])]),(0,a.Lk)("form",{onSubmit:r[36]||(r[36]=(0,o.D$)(((...e)=>ge.submitVerificationForm&&ge.submitVerificationForm(...e)),["prevent"]))},[(0,a.Lk)("div",re,[r[66]||(r[66]=(0,a.Lk)("label",{for:"otp",class:"form-label"},"Verification Code",-1)),(0,a.bo)((0,a.Lk)("input",{type:"text",class:(0,s.C4)(["form-control text-center",{"is-invalid":be.errors.otp}]),id:"otp","onUpdate:modelValue":r[33]||(r[33]=e=>be.verificationForm.otp=e),onInput:r[34]||(r[34]=e=>ge.clearFieldError("otp")),placeholder:"Enter 6-digit code",maxlength:"6",required:""},null,34),[[o.Jo,be.verificationForm.otp]]),be.errors.otp?((0,a.uX)(),(0,a.CE)("div",te,(0,s.v_)(be.errors.otp),1)):(0,a.Q3)("",!0)]),(0,a.Lk)("div",ae,[(0,a.Lk)("button",{type:"submit",class:"btn btn-success",disabled:be.loading},[be.loading?((0,a.uX)(),(0,a.CE)("span",oe)):(0,a.Q3)("",!0),(0,a.eW)(" "+(0,s.v_)(be.loading?"Verifying...":"Verify Email"),1)],8,se)]),(0,a.Lk)("div",ie,[r[67]||(r[67]=(0,a.Lk)("p",{class:"text-muted mb-2"},"Didn't receive the code?",-1)),(0,a.Lk)("button",{type:"button",class:"btn btn-link p-0",onClick:r[35]||(r[35]=(...e)=>ge.resendVerificationCode&&ge.resendVerificationCode(...e)),disabled:be.resendLoading||be.resendCooldown>0},[be.resendLoading?((0,a.uX)(),(0,a.CE)("span",le)):(0,a.Q3)("",!0),(0,a.eW)(" "+(0,s.v_)(be.resendCooldown>0?`Resend in ${be.resendCooldown}s`:"Resend Code"),1)],8,ne)])],32)])):(0,a.Q3)("",!0),4===be.currentStep?((0,a.uX)(),(0,a.CE)("div",ce,[r[69]||(r[69]=(0,a.Lk)("div",{class:"mb-4"},[(0,a.Lk)("i",{class:"fas fa-check-circle text-success",style:{"font-size":"4rem"}})],-1)),r[70]||(r[70]=(0,a.Lk)("h4",{class:"text-success mb-3"},"Registration Successful!",-1)),r[71]||(r[71]=(0,a.Lk)("p",{class:"text-muted mb-4"}," Your admin account has been created and verified successfully. You can now log in to access the admin panel. ",-1)),(0,a.Lk)("div",de,[(0,a.Lk)("button",{type:"button",class:"btn btn-success",onClick:r[37]||(r[37]=(...e)=>ge.goToLogin&&ge.goToLogin(...e))},r[68]||(r[68]=[(0,a.Lk)("i",{class:"fas fa-sign-in-alt me-2"},null,-1),(0,a.eW)(" Go to Login ")]))])])):(0,a.Q3)("",!0),be.errorMessage?((0,a.uX)(),(0,a.CE)("div",ue,[r[72]||(r[72]=(0,a.Lk)("i",{class:"fas fa-exclamation-triangle me-2"},null,-1)),(0,a.eW)(" "+(0,s.v_)(be.errorMessage),1)])):(0,a.Q3)("",!0),be.successMessage?((0,a.uX)(),(0,a.CE)("div",me,[r[73]||(r[73]=(0,a.Lk)("i",{class:"fas fa-check-circle me-2"},null,-1)),(0,a.eW)(" "+(0,s.v_)(be.successMessage),1)])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",pe,[(0,a.Lk)("p",he,[r[75]||(r[75]=(0,a.eW)(" Already have an account? ")),(0,a.bF)(ye,{to:"/admin/login",class:"text-decoration-none"},{default:(0,a.k6)((()=>r[74]||(r[74]=[(0,a.eW)(" Sign in here ")]))),_:1,__:[74]})])])])])])])])}t(4114),t(8111),t(7588);var be=t(2674),ge=t(662),ye={name:"AdminRegistration",data(){return{currentStep:1,loading:!1,resendLoading:!1,resendCooldown:0,showPassword:!1,errorMessage:"",successMessage:"",accountForm:{username:"",email:"",role:"",password:"",confirmPassword:""},profileForm:{first_name:"",middle_name:"",last_name:"",suffix:"",employee_id:"",phone_number:"",position:"",department:"",hire_date:""},verificationForm:{otp:""},errors:{},accountId:null}},mounted(){console.log("AdminRegistration component mounted");try{be["default"]&&"function"===typeof be["default"].isLoggedIn&&be["default"].isLoggedIn()&&this.$router.push("/admin/dashboard")}catch(e){console.warn("Admin auth check failed:",e)}},methods:{validateField(e){let r,t=null;switch(e in this.accountForm?r=this.accountForm[e]:e in this.profileForm?r=this.profileForm[e]:e in this.verificationForm&&(r=this.verificationForm[e]),e){case"username":t=ge.y$.required(r,"Username")||ge.y$.minLength(r,3,"Username")||ge.y$.maxLength(r,50,"Username");break;case"email":t=ge.y$.required(r,"Email")||ge.y$.email(r);break;case"role":t=ge.y$.required(r,"Role");break;case"password":t=ge.y$.required(r,"Password")||ge.y$.password(r);break;case"confirmPassword":t=ge.y$.required(r,"Confirm Password")||ge.y$.passwordMatch(r,this.accountForm.password);break;case"first_name":t=ge.y$.required(r,"First Name")||ge.y$.maxLength(r,100,"First Name");break;case"last_name":t=ge.y$.required(r,"Last Name")||ge.y$.maxLength(r,100,"Last Name");break;case"phone_number":t=ge.y$.required(r,"Phone Number")||ge.y$.phone(r);break;case"otp":t=ge.y$.required(r,"Verification Code")||ge.y$.exactLength(r,6,"Verification Code");break}return t?this.errors={...this.errors,[e]:t}:this.clearFieldError(e),!t},clearFieldError(e){this.errors=(0,ge.m_)(this.errors,e)},clearMessages(){this.errorMessage="",this.successMessage=""},handlePhoneInput(e){const r=e.target.value,t=r.replace(/\D/g,""),a=t.substring(0,11);this.profileForm.phone_number=a,this.clearFieldError("phone_number")},async submitAccountForm(){this.clearMessages();const e=["username","email","role","password","confirmPassword"];let r=!0;if(e.forEach((e=>{this.validateField(e)||(r=!1)})),r){this.loading=!0;try{const e=await be["default"].registerAccount({username:this.accountForm.username,email:this.accountForm.email,role:this.accountForm.role,password:this.accountForm.password,confirmPassword:this.accountForm.confirmPassword});e.success&&(this.accountId=e.data.accountId,this.currentStep=2,this.successMessage="Account created successfully! Please complete your profile.")}catch(t){const e=be["default"].parseError(t);this.errorMessage=e.message,e.errors&&e.errors.length>0&&e.errors.forEach((e=>{e.field&&(this.errors={...this.errors,[e.field]:e.message})}))}finally{this.loading=!1}}else this.errorMessage="Please fill in all required fields correctly"},async submitProfileForm(){this.clearMessages();const e=["first_name","last_name","phone_number"];let r=!0;if(e.forEach((e=>{this.validateField(e)||(r=!1)})),r){this.loading=!0;try{const e=await be["default"].completeRegistration(this.accountId,{email:this.accountForm.email,first_name:this.profileForm.first_name,middle_name:this.profileForm.middle_name,last_name:this.profileForm.last_name,suffix:this.profileForm.suffix,employee_id:this.profileForm.employee_id,phone_number:this.profileForm.phone_number,position:this.profileForm.position,department:this.profileForm.department,hire_date:this.profileForm.hire_date});e.success&&(await this.sendVerificationOTP(),this.currentStep=3,this.successMessage="Profile completed! Please verify your email address.")}catch(t){const e=be["default"].parseError(t);this.errorMessage=e.message,e.errors&&e.errors.length>0&&e.errors.forEach((e=>{e.field&&(this.errors={...this.errors,[e.field]:e.message})}))}finally{this.loading=!1}}else this.errorMessage="Please fill in all required fields correctly"},async sendVerificationOTP(){try{await be["default"].sendOTP(this.accountForm.email,"registration",this.profileForm.first_name)}catch(e){console.error("Failed to send OTP:",e)}},async submitVerificationForm(){if(this.clearMessages(),this.validateField("otp")){this.loading=!0;try{const e=await be["default"].verifyEmail(this.accountForm.email,this.verificationForm.otp);e.success&&(this.currentStep=4,this.successMessage="Email verified successfully!")}catch(e){const r=be["default"].parseError(e);this.errorMessage=r.message}finally{this.loading=!1}}else this.errorMessage="Please enter a valid verification code"},async resendVerificationCode(){if(!(this.resendCooldown>0)){this.resendLoading=!0;try{await this.sendVerificationOTP(),this.successMessage="Verification code sent successfully!",this.startResendCooldown()}catch(e){const r=be["default"].parseError(e);this.errorMessage=r.message||"Failed to resend verification code"}finally{this.resendLoading=!1}}},startResendCooldown(){this.resendCooldown=60;const e=setInterval((()=>{this.resendCooldown--,this.resendCooldown<=0&&clearInterval(e)}),1e3)},goToPreviousStep(){this.currentStep>1&&(this.currentStep--,this.clearMessages())},goToLogin(){this.$router.push("/admin/login?registered=true")}}},ke=t(1241);const ve=(0,ke.A)(ye,[["render",fe],["__scopeId","data-v-6cd712e7"]]);var we=ve}}]);